<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.tgy.rtls.data.mapper.park.floorLock.UserCompanyMapMapper">
    <resultMap id="BaseResultMap" type="com.tgy.rtls.data.entity.park.floorLock.UserCompanyMap">
        <!--@mbg.generated-->
        <!--@Table user_company_map-->
        <id column="id" jdbcType="BIGINT" property="id"/>
        <result column="user_id" jdbcType="BIGINT" property="userId"/>
        <result column="user_name" jdbcType="VARCHAR" property="userName"/>
        <result column="phone" jdbcType="VARCHAR" property="phone"/>
        <result column="license_plate_id" jdbcType="BIGINT" property="licensePlateId"/>
        <result column="license_plate" jdbcType="VARCHAR" property="licensePlate"/>
        <result column="map_id" jdbcType="BIGINT" property="mapId"/>
        <result column="map_name" jdbcType="VARCHAR" property="mapName"/>
        <result column="company_id" jdbcType="BIGINT" property="companyId"/>
        <result column="company_name" jdbcType="VARCHAR" property="companyName"/>
        <result column="create_time" jdbcType="INTEGER" property="createTime"/>
        <result column="update_time" jdbcType="INTEGER" property="updateTime"/>
    </resultMap>
    <sql id="Base_Column_List">
        <!--@mbg.generated-->
        <!--@sql select -->
        u.id,
        u.user_id,
        u.user_name,
        u.phone,
        u.license_plate_id,
        u.license_plate,
        u.map_id,
        u.map_name,
        u.company_id,
        u.company_name,
        u.create_time,
        u.update_time
        <!--@sql from user_company_map u left join map_2d m on u.map_id=m.id left join parking_company c on c.id = u.company_id-->
    </sql>

    <!--$var desc=1-->
    <select id="getUserCompanyMap" resultMap="BaseResultMap">
        select
        <include refid="Base_Column_List"/>
        from user_company_map u
        <!--    left join map_2d m on u.map_id=m.id left join parking_company c on c.id = u.company_id-->
        where 1 = 1
        <if test="map != null">
            and map_id = #{map}
        </if>
        <if test="companyId != null">
            and company_id = #{companyId}
        </if>
        <if test="userName != null and userName != ''">
            and user_name like concat('%',#{phone},'%')
        </if>
        <if test="phone != null and phone != ''">
            and phone like concat('%',#{phone},'%')
        </if>
        <if test="licensePlate != null and licensePlate != ''">
            and license_plate like concat('%',#{licensePlate},'%')
        </if>
        <if test="mapids != null and mapids.length != 0">
            and map_id in
            <foreach collection="mapids" item="map" close=")" open="(" separator=",">
                #{map}
            </foreach>
        </if>
        <if test="desc != null and desc != ''">
            order by ${desc}
        </if>
    </select>
</mapper>