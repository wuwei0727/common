!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.navigation=e():t.navigation=e()}(this,function(){return n=[function(t,e,n){t.exports=n(151)},function(t){function e(t){return t&&t.__esModule?t:{default:t}}t.exports=e},function(t){function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}t.exports=e},function(t,e,n){var r=n(0);function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),r(t,i.key,i)}}function o(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}t.exports=o},function(t){var e=t.exports={version:"2.6.11"};"number"==typeof __e&&(__e=e)},function(t,e,n){var i=n(81)("wks"),r=n(45),o=n(7).Symbol,a="function"==typeof o,s=t.exports=function(t){return i[t]||(i[t]=a&&o[t]||(a?o:r)("Symbol."+t))};s.store=i},function(t,e,n){var _=n(9),v=n(4),y=n(68),g=n(34),I=n(28),T="prototype",N=function(t,e,n){var i,r,o,a=t&N.F,s=t&N.G,u=t&N.S,l=t&N.P,d=t&N.B,h=t&N.W,f=s?v:v[e]||(v[e]={}),c=f[T],p=s?_:u?_[e]:(_[e]||{})[T];for(i in s&&(n=e),n)r=!a&&p&&void 0!==p[i],r&&I(f,i)||(o=r?p[i]:n[i],f[i]=s&&"function"!=typeof p[i]?n[i]:d&&r?y(o,_):h&&p[i]==o?function(i){var t=function(t,e,n){if(this instanceof i){switch(arguments.length){case 0:return new i;case 1:return new i(t);case 2:return new i(t,e)}return new i(t,e,n)}return i.apply(this,arguments)};return t[T]=i[T],t}(o):l&&"function"==typeof o?y(Function.call,o):o,l&&((f.virtual||(f.virtual={}))[i]=o,t&N.R&&c&&!c[i]&&g(c,i,o)))};N.F=1,N.G=2,N.S=4,N.P=8,N.B=16,N.W=32,N.U=64,N.R=128,t.exports=N},function(t){var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)},function(t){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t){var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)},function(t,e,n){var i=n(74)("wks"),r=n(54),o=n(9).Symbol,a="function"==typeof o,s=t.exports=function(t){return i[t]||(i[t]=a&&o[t]||(a?o:r)("Symbol."+t))};s.store=i},function(t,e,n){t.exports=!n(8)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,e,n){"use strict";var i=n(1),r=n(0);r(e,"__esModule",{value:!0}),e.default=void 0,n(21),n(16);var o=i(n(2)),a=i(n(3)),A=1e-5,I=1e-5,U=.001,s=.01,u=function(){function G(){(0,o.default)(this,G)}return(0,a.default)(G,null,[{key:"epsilon",value:function(){return U}},{key:"isZero",value:function(t){return t<A&&-A<t}},{key:"gtZero",value:function(t){return A<t}},{key:"ltZero",value:function(t){return t<-A}},{key:"pointDistanceToLine",value:function(t,e,n,i){var r,o=e.x,a=e.y,s=n.x,u=n.y,l=t.x,d=t.y,h=s-o,f=u-a,c=Math.sqrt(h*h+f*f),p=l-o,_=d-a,v=Math.sqrt(p*p+_*_);if(G.isZero(c))return i.x=e.x,i.y=e.y,r=G.isZero(v)?0:v,r;var y=h/c,g=f/c,I=y*p+g*_;if(!G.gtZero(I))return i.x=e.x,i.y=e.y,r=v,r;if(!G.ltZero(I-c)){var T=l-s,N=d-u,x=Math.sqrt(T*T+N*N);return i.x=n.x,i.y=n.y,r=x,r}var m=o+I*y,R=a+I*g,E=l-m,M=d-R,k=Math.sqrt(E*E+M*M);return i.x=m,i.y=R,r=k,r}},{key:"distanceOfTwoPoints",value:function(t,e){return t&&e?Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y)):Number.NaN}},{key:"isSamePoint",value:function(t,e){return Math.abs(t.x-e.x)<=I&&Math.abs(t.y-e.y)<=I}},{key:"isNearlySamePoint",value:function(t,e){return Math.abs(t.x-e.x)<=s&&Math.abs(t.y-e.y)<=s}},{key:"getPolygonInnerPoint",value:function(t){if(t&&0==t.length)return{x:0,y:0};var e=t.length;if(e<3)return t[0];var n=t[0],i=t[1],r={x:(n.x+i.x)/2,y:(n.y+i.y)/2},o=Math.atan2(i.y-n.y,i.x-n.x);o-=Math.PI/2;for(var a=3;.5<a;){var s={x:r.x+a*Math.cos(o),y:r.y+a*Math.sin(o)};if(G.isInPolygon(s,t))return s;a/=2}for(o+=Math.PI,a=3;.5<a;){var u={x:r.x+a*Math.cos(o),y:r.y+a*Math.sin(o)};if(G.isInPolygon(u,t))return u;a/=2}return{x:0,y:0}}},{key:"isInPolygon",value:function(t,e){for(var n=!1,i=e.length,r=0,o=i-1;r<i;o=r,++r){var a=e[r].x,s=e[r].y,u=e[o].x,l=e[o].y;if(a==t.x&&s==t.y||u==t.x&&l==t.y)return!0;if(s<t.y&&l>=t.y||s>=t.y&&l<t.y){var d=a+(t.y-s)*(u-a)/(l-s);if(d==t.x)return!0;d>t.x&&(n=!n)}}return n}},{key:"isInCircle",value:function(t,e,n,i){if(t.x<i[0]&&t.x>i[1])return!1;if(t.y<i[2]&&t.y>i[3])return!1;var r=n*n,o=t.x,a=t.y,s=e.x,u=e.y,l=s-o,d=u-a,h=l*l+d*d;return h<r}},{key:"isRectCross",value:function(t,e,n,i){return!(Math.max(t.x,e.x)<Math.min(n.x,i.x)||Math.max(t.y,e.y)<Math.min(n.y,i.y)||Math.max(n.x,i.x)<Math.min(t.x,e.x)||Math.max(n.y,i.y)<Math.min(t.y,e.y))}},{key:"pointIsInRect",value:function(t,e,n,i){return Math.abs(t.x-e.x)<n&&Math.abs(t.y-e.y)<i}},{key:"pointIsInRect1",value:function(t,e,n){var i=Math.min(e.x,n.x),r=Math.max(e.x,n.x),o=Math.min(e.y,n.y),a=Math.max(e.y,n.y);return!(t.x<i||t.x>r||t.y<o||t.y>a)}},{key:"cross",value:function(t,e,n){return(t.x-n.x)*(e.y-n.y)-(e.x-n.x)*(t.y-n.y)}},{key:"isLineSegmentCross",value:function(t,e,n,i){return!(Math.max(t.x,e.x)<Math.min(n.x,i.x)||Math.max(t.y,e.y)<Math.min(n.y,i.y)||Math.max(n.x,i.x)<Math.min(t.x,e.x)||Math.max(n.y,i.y)<Math.min(t.y,e.y)||G.cross(n,e,t)*G.cross(e,i,t)<0||G.cross(t,i,n)*G.cross(i,e,n)<0)}},{key:"rayCrossSegment",value:function(t,e,n,i,r){var o=Math.min(t.x,n.x,i.x),a=Math.max(t.x,n.x,i.x),s=Math.min(t.y,n.y,i.y),u=Math.max(t.y,n.y,i.y),l=Math.sqrt((a-o)*(a-o)+(u-s)*(u-s)),d=e/180*Math.PI,h=l*Math.cos(d)+t.x,f=l*Math.sin(d)+t.y;return 1==this.calcCrossPoint(t,{x:h,y:f},n,i,r)}},{key:"calcCrossPoint",value:function(t,e,n,i,r){if(1!=G.isLineSegmentCross(t,e,n,i))return 0;var o=(i.x-n.x)*(t.y-e.y)-(e.x-t.x)*(n.y-i.y),a=(t.y-n.y)*(e.x-t.x)*(i.x-n.x)+n.x*(i.y-n.y)*(e.x-t.x)-t.x*(e.y-t.y)*(i.x-n.x);return r.x=a/o,o=(t.x-e.x)*(i.y-n.y)-(e.y-t.y)*(n.x-i.x),a=e.y*(t.x-e.x)*(i.y-n.y)+(i.x-e.x)*(i.y-n.y)*(t.y-e.y)-i.y*(n.x-i.x)*(e.y-t.y),r.y=a/o,1}},{key:"pointInPolygon2d",value:function(t,e,n){for(var i=!1,r=null,o=null,a=0;a<n;a++)r=t[a],o=t[(a+1)%n],(r.y<e.y&&o.y>=e.y||o.y<e.y&&r.y>=e.y)&&(r.x<=e.x||o.x<=e.x)&&r.x+(e.y-r.y)/(o.y-r.y)*(o.x-r.x)<e.x&&(i=!i);return i}},{key:"pointInPolygon2d1",value:function(t,e,n){for(var i=0,r=null,o=null,a=null,s=0;s<n;s++)if(r=t[s],o=t[(s+1)%n],(r.y<e.y&&o.y>=e.y||o.y<e.y&&r.y>=e.y)&&(r.x<=e.x||o.x<=e.x)){if(a=r.x+(e.y-r.y)/(o.y-r.y)*(o.x-r.x),Math.abs(a-e.x)<=U)return 2;a<e.x&&(i=!i)}return i}},{key:"pointInPolygonVector2d",value:function(t,e,n){for(var i=!1,r=null,o=null,a=0,s=n/2,u=0;u<s;u++)a=2*u,r={x:t[a],y:t[a+1]},o={x:t[(a+2)%n],y:t[(a+3)%n]},(r.y<e.y&&o.y>=e.y||o.y<e.y&&r.y>=e.y)&&(r.x<=e.x||o.x<=e.x)&&r.x+(e.y-r.y)/(o.y-r.y)*(o.x-r.x)<e.x&&(i=!i);return i}},{key:"pointToSegmentDistance",value:function(t,e,n){var i=t.x,r=t.y,o=e.x,a=e.y,s=n.x,u=n.y,l=(s-o)*(i-o)+(u-a)*(r-a);if(l<=0)return Math.sqrt((i-o)*(i-o)+(r-a)*(r-a));var d=(s-o)*(s-o)+(u-a)*(u-a);if(d<=l)return Math.sqrt((i-s)*(i-s)+(r-u)*(r-u));var h=l/d,f=o+(s-o)*h,c=a+(u-a)*h;return Math.sqrt((i-f)*(i-f)+(c-r)*(c-r))}},{key:"pointToPolygon2d",value:function(t,e,n){for(var i=null,r=null,o=Number.MAX_VALUE,a=0;a<n;a++){i=t[a],r=t[(a+1)%n];var s=G.pointToSegmentDistance(e,i,r);s<o&&(o=s)}return o}},{key:"lineInCircle2d",value:function(t,e,n,i,r){if(t.x<r[0]&&e.x<r[0])return!1;if(t.x>r[1]&&e.x>r[1])return!1;if(t.y<r[2]&&e.y<r[2])return!1;if(t.y>r[3]&&e.y>r[3])return!1;var o=i*i,a=t.x,s=t.y,u=e.x,l=e.y,d=n.x,h=n.y,f=u-a,c=l-s,p=f*f+c*c,_=d-a,v=h-s,y=_*_+v*v;if(G.isZero(p))return!!G.isZero(y)||y<o;p=Math.sqrt(p);var g=f/p,I=c/p,T=g*_+I*v;if(!G.gtZero(T))return y<o;if(!G.ltZero(T-p)){var N=d-u,x=h-l,m=N*N+x*x;return m<o}var R=a+T*g,E=s+T*I,M=d-R,k=h-E,P=M*M+k*k;return P<o}},{key:"lineInPolygon2d",value:function(t,e,n,i){if(t.x<i[0]&&e.x<i[0])return!1;if(t.x>i[1]&&e.x>i[1])return!1;if(t.y<i[2]&&e.y<i[2])return!1;if(t.y>i[3]&&e.y>i[3])return!1;var r=n.length;if(G.pointInPolygon2d(n,t,r))return!0;if(G.pointInPolygon2d(n,e,r))return!0;for(var o=0;o<r;o++){var a=(o+1)%r;if(G.isLineSegmentCross(t,e,n[o],n[a]))return!0}return!1}},{key:"calcLineCircleCrossPoints2d",value:function(t,e,n,i,r){if(t.x<r[0]&&e.x<r[0])return null;if(t.x>r[1]&&e.x>r[1])return null;if(t.y<r[2]&&e.y<r[2])return null;if(t.y>r[3]&&e.y>r[3])return null;var o={isContain:!1,crossPoints:[]},a=i*i,s=t.x,u=t.y,l=e.x,d=e.y,h=n.x,f=n.y,c=l-s,p=d-u,_=c*c+p*p,v=h-s,y=f-u,g=v*v+y*y,I=h-l,T=f-d,N=I*I+T*T;if(G.isZero(_))return(G.isZero(g)||g<a)&&(o.isContain=!0,o.crossPoints=[t,e]),o;if(g<a&&N<a)return o.isContain=!0,o.crossPoints=[t,e],o;var x=Math.sqrt(_),m=c/x,R=p/x,E=v*m+y*R,M=E*E,k=v*v+y*y;if(a-k+M<0)return null;var P=Math.sqrt(a-k+M),L=E-P;return-A<+L&&L-x<A&&o.crossPoints.push({x:s+L*m,y:u+L*R}),L=E+P,-A<+L&&L-x<A&&o.crossPoints.push({x:s+L*m,y:u+L*R}),o}},{key:"calcLinePolygonCrossPoints2d",value:function(t,e,n,i){if(t.x<i[0]&&e.x<i[0])return null;if(t.x>i[1]&&e.x>i[1])return null;if(t.y<i[2]&&e.y<i[2])return null;if(t.y>i[3]&&e.y>i[3])return null;var r={containType:0,crossPoints:[]},o=n.length;G.pointInPolygon2d(n,t,o)&&(r.containType|=1),G.pointInPolygon2d(n,e,o)&&(r.containType|=2);for(var a=[],s=0;s<o;s++){var u,l,d=(s+1)%o,h={};G.calcCrossPoint(t,e,n[s],n[d],h)&&(u=h.x-t.x,l=h.y-t.y,a.push({dis2:u*u+l*l,point:h}))}if(0==a.length)return null;a.sort(function(t,e){return e.dis2-t.dis2});for(var f=0;f<a.length;f++)r.crossPoints.push(a[f].point);return r}},{key:"calcCenterOfGravityPoint",value:function(t,e){for(var n=0,i=0,r=0,o=0;o<e;o++){var a=t[o],s=t[(o+1)%e],u=(a.x*s.y-a.y*s.x)/2;n+=u,i+=u*(a.x+s.x)/3,r+=u*(a.y+s.y)/3}return i/=n,r/=n,{x:i,y:r}}},{key:"calcPolygonArea2d",value:function(t){var e=t.length;if(e<3)return 0;for(var n=0,i=0;i<e;++i){var r=t[i],o=t[(i+1)%e];n+=r.x*o.y-r.y*o.x}return Math.abs(n/2)}},{key:"quickRayIntersect",value:function(t,e,n,i,r){var o=Math.min(n.x,i.x),a=Math.max(n.x,i.x),s=Math.min(n.y,i.y),u=Math.max(n.y,i.y),l=t.x,d=t.y,h=n.x,f=n.y,c=i.x,p=i.y;if(90==e){if(t.x<o||t.x>a)return!1;var _=(p-f)/(c-h),v=_*(l-h)+f;return r.y=v,r.x=l,!(v<d||!G.pointIsInRect1(r,n,i))}if(270==e){if(t.x<o||t.x>a)return!1;var y=(p-f)/(c-h),g=y*(l-h)+f;return r.y=g,r.x=l,!(d<g||!G.pointIsInRect1(r,n,i))}if(270!=e&&90!=e&&a-o<U){var I=o,T=Math.tan(e/180*Math.PI),N=T*(I-l)+d;if(r.y=N,r.x=I,G.pointIsInRect1(r,n,i)){var x=I-l,m=N-d,R=x/Math.sqrt(x*x+m*m),E=Math.cos(e/180*Math.PI);return 0<R*E}}if(u-s<=1e-6){var M=s,k=Math.tan(e/180*Math.PI),P=1/k*(M-d)+l;if(r.x=P,r.y=M,G.pointIsInRect1(r,n,i)){var L=P-l,A=M-d,O=L/Math.sqrt(L*L+A*A),S=Math.cos(e/180*Math.PI);return 0<O*S}return!1}var b=Math.tan(e/180*Math.PI),w=(p-f)/(c-h),C=(f-d-(w*h-b*l))/(b-w),D=d+b*(C-l);if(r.x=C,r.y=D,G.pointIsInRect1(r,n,i)){var F=C-l,z=D-d,V=F/Math.sqrt(F*F+z*z),j=Math.cos(e/180*Math.PI);return 0<V*j}return!1}},{key:"calcFootOfUpright",value:function(t,e,n,i){var r=Math.min(e.x,n.x),o=Math.max(e.x,n.x),a=Math.min(e.y,n.y),s=Math.max(e.y,n.y),u=t.x,l=t.y,d=e.x,h=e.y,f=n.x,c=n.y;if(Math.abs(d-f)<I)return i.x=d,i.y=l,a<=l&&l<=s;if(Math.abs(h-c)<I)return i.x=u,i.y=h,r<=u&&u<=o;var p=(c-h)/(f-d),_=-1/p,v=(c-h)/(f-d),y=(h-l-(v*d-_*u))/(_-v),g=l+_*(y-u);return i.x=y,i.y=g,!!G.pointIsInRect1(i,e,n)}},{key:"vectorCross",value:function(t,e){return{x:t.y*e.z-t.z*e.y,y:t.z*e.x-t.x*e.z,z:t.x*e.y-t.y*e.x}}},{key:"vectorDot",value:function(t,e){return t.x*e.x+t.y*e.y+t.z*e.z}},{key:"vectorLength",value:function(t){return Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z)}},{key:"vector2DDot",value:function(t,e){return t.x*e.x+t.y*e.y}},{key:"vector2DLength",value:function(t){return Math.sqrt(t.x*t.x+t.y*t.y)}},{key:"calcRotateAngle",value:function(t,e){var n={x:t.x,y:t.y,z:0},i={x:e.x,y:e.y,z:0},r=G.vectorCross(n,i),o=G.vector2DDot(t,e),a=Math.acos(o/(G.vector2DLength(t)*G.vector2DLength(e)));return 0<r.z?a/Math.PI*180:360-a/Math.PI*180}},{key:"isPointOnSegment",value:function(t,e,n){return(t.x-e.x)*(n.y-e.y)==(n.x-e.x)*(t.y-e.y)&&Math.min(e.x,n.x)<=t.x&&t.x<=Math.max(e.x,n.x)&&Math.min(e.y,n.y)<=t.y&&t.y<=Math.max(e.y,n.y)}},{key:"segCrossPolygon",value:function(t,e,n,i){for(var r=0;r<n.length;r++){var o=n[r],a=n[(r+1)%n.length];if(1==this.calcCrossPoint(t,e,o,a,i))return!0}return!1}}]),G}(),l=u;e.default=l},function(t,e,n){var i=n(22),r=n(59);t.exports=n(11)?function(t,e,n){return i.f(t,e,r(1,n))}:function(t,e,n){return t[e]=n,t}},function(t,e,n){t.exports=!n(20)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,e,n){t.exports=n(157)},function(t,e,n){"use strict";var i=n(7),r=n(31),o=n(46),a=n(192),d=n(58),s=n(8),u=n(84).f,l=n(83).f,h=n(22).f,f=n(195).trim,c="Number",p=i[c],_=p,v=p.prototype,y=o(n(87)(v))==c,g="trim"in String.prototype,I=function(t){var e=d(t,!1);if("string"==typeof e&&2<e.length){e=g?e.trim():f(e,3);var n,i,r,o=e.charCodeAt(0);if(43===o||45===o){if(n=e.charCodeAt(2),88===n||120===n)return NaN}else if(48===o){switch(e.charCodeAt(1)){case 66:case 98:i=2,r=49;break;case 79:case 111:i=8,r=55;break;default:return+e}for(var a,s=e.slice(2),u=0,l=s.length;u<l;u++)if(a=s.charCodeAt(u),a<48||r<a)return NaN;return parseInt(s,i)}}return+e};if(!p(" 0o1")||!p("0b1")||p("+0x1")){p=function(t){var e=arguments.length<1?0:t,n=this;return n instanceof p&&(y?s(function(){v.valueOf.call(n)}):o(n)!=c)?a(new _(I(e)),n,p):I(e)};for(var T,N=n(11)?u(_):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),x=0;N.length>x;x++)r(_,T=N[x])&&!r(p,T)&&h(p,T,l(_,T));p.prototype=v,v.constructor=p,n(25)(i,c,p)}},function(t,e,n){"use strict";var i=n(64),r={};r[n(5)("toStringTag")]="z",r+""!="[object z]"&&n(25)(Object.prototype,"toString",function(){return"[object "+i(this)+"]"},!0)},function(t,e,n){var i=n(27),r=n(100),o=n(70),a=Object.defineProperty;e.f=n(14)?Object.defineProperty:function(t,e,n){if(i(t),e=o(e,!0),i(n),r)try{return a(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},function(t){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e,n){"use strict";var i=n(30),r=n(82),o=n(37),a=n(8),s=[].sort,u=[1,2,3];i(i.P+i.F*(a(function(){u.sort(void 0)})||!a(function(){u.sort(null)})||!n(191)(s)),"Array",{sort:function(t){return void 0===t?s.call(o(this)):s.call(o(this),r(t))}})},function(t,e,n){var i=n(23),r=n(118),o=n(58),a=Object.defineProperty;e.f=n(11)?Object.defineProperty:function(t,e,n){if(i(t),e=o(e,!0),i(n),r)try{return a(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},function(t,e,n){var i=n(24);t.exports=function(t){if(!i(t))throw TypeError(t+" is not an object!");return t}},function(t){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e,n){var o=n(7),a=n(13),s=n(31),u=n(45)("src"),i=n(190),r="toString",l=(""+i).split(r);n(57).inspectSource=function(t){return i.call(t)},(t.exports=function(t,e,n,i){var r="function"==typeof n;r&&(s(n,"name")||a(n,"name",e)),t[e]!==n&&(r&&(s(n,u)||a(n,u,t[e]?""+t[e]:l.join(String(e)))),t===o?t[e]=n:i?t[e]?t[e]=n:a(t,e,n):(delete t[e],a(t,e,n)))})(Function.prototype,r,function(){return"function"==typeof this&&this[u]||i.call(this)})},function(t,e,n){var i=n(39),r=Math.min;t.exports=function(t){return 0<t?r(i(t),9007199254740991):0}},function(t,e,n){var i=n(19);t.exports=function(t){if(!i(t))throw TypeError(t+" is not an object!");return t}},function(t){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},function(t,e,n){var i=n(162),r=n(163),o=n(188),a=n(189);function s(t){return i(t)||r(t)||o(t)||a()}t.exports=s},function(t,e,n){var _=n(7),v=n(57),y=n(13),g=n(25),I=n(61),T="prototype",N=function(t,e,n){var i,r,o,a,s=t&N.F,u=t&N.G,l=t&N.S,d=t&N.P,h=t&N.B,f=u?_:l?_[e]||(_[e]={}):(_[e]||{})[T],c=u?v:v[e]||(v[e]={}),p=c[T]||(c[T]={});for(i in u&&(n=e),n)r=!s&&f&&void 0!==f[i],o=(r?f:n)[i],a=h&&r?I(o,_):d&&"function"==typeof o?I(Function.call,o):o,f&&g(f,i,o,t&N.U),c[i]!=o&&y(c,i,a),d&&p[i]!=o&&(p[i]=o)};_.core=v,N.F=1,N.G=2,N.S=4,N.P=8,N.B=16,N.W=32,N.U=64,N.R=128,t.exports=N},function(t){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},function(t,e,n){"use strict";var i=n(132),r=n(210),o=n(40),a=n(62);t.exports=n(211)(Array,"Array",function(t,e){this._t=a(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,r(1)):r(0,"keys"==e?n:"values"==e?t[n]:[n,t[n]])},"values"),o.Arguments=o.Array,i("keys"),i("values"),i("entries")},function(t,e,n){"use strict";var i=n(0);i(e,"__esModule",{value:!0}),e.default=void 0;var r={NaviNodeType_NULL:-1,NaviNodeType_COMMON:0,NaviNodeType_SIDE:1,NaviNodeType_FLOOR:2,NaviNodeType_EXTENT:3,NaviLiftType_NULL:0,NaviLiftType_Lift:1,NaviLiftType_Stair:2,NaviLiftType_Escalator:3,NaviLiftType_Accessible:4,NaviLiftEntry_BOTH:0,NaviLiftEntry_UP:1,NaviLiftEntry_DOWN:2,NaviLiftEntry_FORBID:3,NaviEntranceType_NULL:0,NaviEntranceType_EXIT:1,NaviEntranceType_ENTRANCE:2,NaviEntranceType_ACCESS:3,NaviRoadRank_MAIN:1,NaviRoadRank_MINOR:2,NaviRoadRank_NARROW:3,NaviRoadEntry_BOTH:0,NaviRoadEntry_FORWARD:1,NaviRoadEntry_BACK:2,NaviRoadEntry_FORBID:3,NaviRoadPass_NULL:-1,NaviRoadPass_NOT_THROUGH:0,NaviRoadPass_THROUGH:1,NaviZoneType_NULL:-1,NaviZoneType_PASS_UNRESTRAINT:0,NaviZoneType_PASS_THROUGH:1,NaviZoneType_PASS_NOT_THROUGH:2,NaviZoneType_NO_ENTRY:3,NaviZoneType_CORRIDOR:4,NaviModelPassType_PASS_THROUGH:0,NaviModelPassType_PASS_NOT_THROUGH:1,NaviModelPassType_NOT_PASS:2,NaviModelPassType_DECORATE:3,NaviRoadHinderType_HINDER_GENERAL:0,NaviRoadHinderType_HINDER_HIGH:1,NaviObstructType_MODEL:0,NaviObstructType_EXTENT:1};e.default=r},function(t,e,n){var i=n(18),r=n(43);t.exports=n(14)?function(t,e,n){return i.f(t,e,r(1,n))}:function(t,e,n){return t[e]=n,t}},function(t,e,n){var i=n(105),r=n(52);t.exports=function(t){return i(r(t))}},function(t){t.exports={}},function(t,e,n){var i=n(38);t.exports=function(t){return Object(i(t))}},function(t){t.exports=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t}},function(t){var e=Math.ceil,n=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(0<t?n:e)(t)}},function(t){t.exports={}},function(t,e,n){"use strict";var i=n(0);i(e,"__esModule",{value:!0}),e.default=void 0;var r={MODULE_SHORTEST:1,MODULE_BEST:2},o=r;e.default=o},function(t,e,n){"use strict";var i=n(1),r=n(0);r(e,"__esModule",{value:!0}),e.default=void 0;var o=i(n(15)),a=i(n(2)),s=i(n(3)),u=(i(n(135)),i(n(33))),l=function(){function t(){(0,a.default)(this,t),this.Id=0,this.point={},this._type=0,this.liftFloors=[],this.segLinks=[],this.liftFlag=0,this.relatedLiftNodes=[],this.treatHead=!1,this.treatTail=!1,this._dist=0,this._visited=!1,this._vPre=[]}return(0,s.default)(t,[{key:"init",value:function(t){this.Id=t,this.point={x:0,y:0},this._type=0,this.liftFlag=0,this.treatHead=!1,this.treatTail=!1}},{key:"equals",value:function(t){return this.Id==t.Id}},{key:"setNode",value:function(t){this.Id=t.Id,this.point=(0,o.default)({},t.point),this._type=t._type,this.liftFloors=[];for(var e=0;e<t.liftFloors.length;e++)this.liftFloors[e]=t.liftFloors[e];this.segLinks=[];for(var n=0;n<t.segLinks.length;n++)this.segLinks[n]=t.segLinks[n];this.liftFlag=t.liftFlag,this.relatedLiftNodes=[];for(var i=0;i<t.relatedLiftNodes.length;i++)this.relatedLiftNodes[i]=t.relatedLiftNodes[i];this.treatHead=t.treatHead,this.treatTail=t.treatTail}},{key:"getLiftFloorsLength",value:function(){return this.liftFloors.length}},{key:"getSegLinksLength",value:function(){return this.segLinks.length}},{key:"contansFloor",value:function(t){if(this.liftType==u.default.NaviLiftType_Stair)return!0;for(var e=this.liftFloors.length-1;0<=e;e--)if(this.liftFloors[e]==t)return!0;return!1}},{key:"nodeType",set:function(t){-1!=t&&(this._type|=t)},get:function(){return 3&this._type}},{key:"liftType",set:function(t){this._type|=t<<2},get:function(){return this._type>>2&7}},{key:"liftEntry",set:function(t){this._type|=t<<5},get:function(){return this._type>>5&3}},{key:"entranceType",set:function(t){this._type|=t<<7},get:function(){return this._type>>7&3}},{key:"tempType",set:function(t){this._type|=t<<9},get:function(){return _type>>9&3}}]),t}(),d=l;e.default=d},function(t){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e,n){var i=n(52);t.exports=function(t){return Object(i(t))}},function(t){var e=0,n=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++e+n).toString(36))}},function(t){var e={}.toString;t.exports=function(t){return e.call(t).slice(8,-1)}},function(t,e,n){t.exports=n(219)},function(t,e,n){"use strict";var i=n(0);i(e,"__esModule",{value:!0}),e.default=void 0;var r={ROUTE_SUCCESS:1,ROUTE_FAILED_NO_FMDBDATA:2,ROUTE_FAILED_TOO_CLOSE:3,ROUTE_FAILED_NO_DATA_START:4,ROUTE_FAILED_NO_DATA_END:5,ROUTE_FAILED_NO_STAIR:6,ROUTE_FAILED_NOTSUPPORT:7,ROUTE_FAILED_CANNOT_CALCULATE:8,ROUTE_FAILED_CANNOT_ARRIVE:9,ROUTE_FAILED_WAYPOINT_CALCULATE_ERROR:10,ROUTE_FAILED_NO_START_ARRIVAL:11,ROUTE_FAILED_NO_END_ARRIVAL:12,ROUTE_FAILED_OUTLINE:13,ROUTE_FAILED_NO_DOOR_START:14,ROUTE_FAILED_NO_DOOR_END:15},o=r;e.default=o},function(t,e,n){"use strict";var i=n(1),r=n(0);r(e,"__esModule",{value:!0}),e.default=void 0,n(21),n(50),n(32),n(17);var o=i(n(2)),a=i(n(3)),s=function(){function t(){(0,o.default)(this,t),this.keys=[],this.data={}}return(0,a.default)(t,[{key:"clear",value:function(){this.keys=[],this.data={}}},{key:"put",value:function(t,e){null==this.data[t]&&this.keys.push(t),this.data[t]=e}},{key:"get",value:function(t){return this.data[t]}},{key:"has",value:function(t){for(var e=this.keys.length,n=0;n<e;n++){var i=this.keys[n];if(i==t)return!0}return!1}},{key:"remove",value:function(t){var e=this.keys.indexOf(t);-1!=e&&(this.keys.splice(e,1),this.data[t]=null)}},{key:"each",value:function(t){if("function"==typeof t)for(var e=this.keys.length,n=0;n<e;n++){var i=this.keys[n];t(i,this.data[i],n)}}},{key:"entrys",value:function(){for(var t=this.keys.length,e=new Array(t),n=0;n<t;n++)e[n]={key:this.keys[n],value:this.data[n]};return e}},{key:"isEmpty",value:function(){return 0==this.keys.length}},{key:"size",value:function(){return this.keys.length}},{key:"toString",value:function(){for(var t="{",e=0;e<this.keys.length;e++,t+=","){var n=this.keys[e];t+=n+"="+this.data[n]}return t+="}",t}},{key:"sort",value:function(){this.keys.sort(function(t,e){return t-e})}}]),t}(),u=s;e.default=u},function(t,e,n){for(var i=n(32),r=n(123),o=n(25),a=n(7),s=n(13),u=n(40),l=n(5),d=l("iterator"),h=l("toStringTag"),f=u.Array,c={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},p=r(c),_=0;_<p.length;_++){var v,y=p[_],g=c[y],I=a[y],T=I&&I.prototype;if(T&&(T[d]||s(T,d,f),T[h]||s(T,h,y),u[y]=f,g))for(v in i)T[v]||o(T,v,i[v],!0)}},function(t,e,n){var i=n(104),r=n(75);t.exports=Object.keys||function(t){return i(t,r)}},function(t){t.exports=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t}},function(t){t.exports=!0},function(t){var e=0,n=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++e+n).toString(36))}},function(t,e){e.f={}.propertyIsEnumerable},function(t,e,o){var i=o(27),r=o(111),a=o(75),s=o(73)("IE_PROTO"),u=function(){},l="prototype",d=function(){var t,e=o(101)("iframe"),n=a.length,i="<",r=">";for(e.style.display="none",o(167).appendChild(e),e.src="javascript:",t=e.contentWindow.document,t.open(),t.write(i+"script"+r+"document.F=Object"+i+"/script"+r),t.close(),d=t.F;n--;)delete d[l][a[n]];return d()};t.exports=Object.create||function(t,e){var n;return null!==t?(u[l]=i(t),n=new u,u[l]=null,n[s]=t):n=d(),void 0===e?n:r(n,e)}},function(t){var e=t.exports={version:"2.6.11"};"number"==typeof __e&&(__e=e)},function(t,e,n){var r=n(24);t.exports=function(t,e){if(!r(t))return t;var n,i;if(e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;if("function"==typeof(n=t.valueOf)&&!r(i=n.call(t)))return i;if(!e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},function(t){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t){t.exports=!1},function(t,e,n){var o=n(82);t.exports=function(i,r,t){if(o(i),void 0===r)return i;switch(t){case 1:return function(t){return i.call(r,t)};case 2:return function(t,e){return i.call(r,t,e)};case 3:return function(t,e,n){return i.call(r,t,e,n)}}return function(){return i.apply(r,arguments)}}},function(t,e,n){var i=n(120),r=n(38);t.exports=function(t){return i(r(t))}},function(t,e,n){var i=n(39),r=Math.max,o=Math.min;t.exports=function(t,e){return t=i(t),t<0?r(t+e,0):o(t,e)}},function(t,e,n){var r=n(46),o=n(5)("toStringTag"),a="Arguments"==r(function(){return arguments}()),s=function(t,e){try{return t[e]}catch(t){}};t.exports=function(t){var e,n,i;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=s(e=Object(t),o))?n:a?r(e):"Object"==(i=r(e))&&"function"==typeof e.callee?"Arguments":i}},function(t,e,n){"use strict";n(218);var i=n(23),r=n(91),o=n(11),a="toString",s=/./[a],u=function(t){n(25)(RegExp.prototype,a,t,!0)};n(8)(function(){return"/a/b"!=s.call({source:"a",flags:"b"})})?u(function(){var t=i(this);return"/".concat(t.source,"/","flags"in t?t.flags:!o&&t instanceof RegExp?r.call(t):void 0)}):s.name!=a&&u(function(){return s.call(this)})},function(t,e,n){"use strict";var i=n(0);i(e,"__esModule",{value:!0}),e.default=void 0;var r={PRIORITY_DEFAULT:1,PRIORITY_LIFTFIRST:2,PRIORITY_ESCALATORFIRST:3,PRIORITY_STAIRFIRST:4,PRIORITY_LIFTONLY:5,PRIORITY_ESCALATORONLY:6,PRIORITY_STAIRONLY:7,PRIORITY_ACCESSIBLEONLY:8,PRIORITY_LIFTFIRST1:9,PRIORITY_ESCALATORFIRST1:10,PRIORITY_STAIRFIRST1:11},o=r;e.default=o},function(t,e,n){"use strict";var i=n(30),r=n(130)(5),o="find",a=!0;o in[]&&Array(1)[o](function(){a=!1}),i(i.P+i.F*a,"Array",{find:function(t,e){return r(this,t,1<arguments.length?e:void 0)}}),n(132)(o)},function(t,e,n){var o=n(69);t.exports=function(i,r,t){if(o(i),void 0===r)return i;switch(t){case 1:return function(t){return i.call(r,t)};case 2:return function(t,e){return i.call(r,t,e)};case 3:return function(t,e,n){return i.call(r,t,e,n)}}return function(){return i.apply(r,arguments)}}},function(t){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e,n){var r=n(19);t.exports=function(t,e){if(!r(t))return t;var n,i;if(e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;if("function"==typeof(n=t.valueOf)&&!r(i=n.call(t)))return i;if(!e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},function(t){var e={}.toString;t.exports=function(t){return e.call(t).slice(8,-1)}},function(t){var e=Math.ceil,n=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(0<t?n:e)(t)}},function(t,e,n){var i=n(74)("keys"),r=n(54);t.exports=function(t){return i[t]||(i[t]=r(t))}},function(t,e,n){var i=n(4),r=n(9),o="__core-js_shared__",a=r[o]||(r[o]={});(t.exports=function(t,e){return a[t]||(a[t]=void 0!==e?e:{})})("versions",[]).push({version:i.version,mode:n(53)?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},function(t){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e,n){"use strict";var i=n(165)(!0);n(109)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=i(e,n),this._i+=t.length,{value:t,done:!1})})},function(t,e,n){var i=n(18).f,r=n(28),o=n(10)("toStringTag");t.exports=function(t,e,n){t&&!r(t=n?t:t.prototype,o)&&i(t,o,{configurable:!0,value:e})}},function(t,e,n){e.f=n(10)},function(t,e,n){var i=n(9),r=n(4),o=n(53),a=n(79),s=n(18).f;t.exports=function(t){var e=r.Symbol||(r.Symbol=!o&&i.Symbol||{});"_"==t.charAt(0)||t in e||s(e,t,{value:a.f(t)})}},function(t,e,n){var i=n(57),r=n(7),o="__core-js_shared__",a=r[o]||(r[o]={});(t.exports=function(t,e){return a[t]||(a[t]=void 0!==e?e:{})})("versions",[]).push({version:i.version,mode:n(60)?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},function(t){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e,n){var i=n(194),r=n(59),o=n(62),a=n(58),s=n(31),u=n(118),l=Object.getOwnPropertyDescriptor;e.f=n(11)?l:function(t,e){if(t=o(t),e=a(e,!0),u)try{return l(t,e)}catch(t){}if(s(t,e))return r(!i.f.call(t,e),t[e])}},function(t,e,n){var i=n(121),r=n(86).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return i(t,r)}},function(t,e,n){var i=n(81)("keys"),r=n(45);t.exports=function(t){return i[t]||(i[t]=r(t))}},function(t){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,e,o){var i=o(23),r=o(197),a=o(86),s=o(85)("IE_PROTO"),u=function(){},l="prototype",d=function(){var t,e=o(119)("iframe"),n=a.length,i="<",r=">";for(e.style.display="none",o(198).appendChild(e),e.src="javascript:",t=e.contentWindow.document,t.open(),t.write(i+"script"+r+"document.F=Object"+i+"/script"+r),t.close(),d=t.F;n--;)delete d[l][a[n]];return d()};t.exports=Object.create||function(t,e){var n;return null!==t?(u[l]=i(t),n=new u,u[l]=null,n[s]=t):n=d(),void 0===e?n:r(n,e)}},function(t,e,n){"use strict";n(202)("sub",function(t){return function(){return t(this,"sub","","")}})},function(t,e,n){"use strict";var I,T,N,x,m,i,p,R,r,E,o,a,M,k,s,u,l,P,L,_,v,A,O,S,y,d,h,f,c,g,b,w,C,D,F,z,V,j,G,U,B,Z,H,Y,q,X,W,K,Q,J,$,tt,et,nt,it,rt,ot,at,st,ut,lt,dt,ht,ft,ct,pt,_t,vt,yt,gt,It,Tt,Nt,xt,mt,Rt,Et,Mt,kt,Pt,Lt,At,Ot,St,bt,wt,Ct,Dt,Ft,zt,Vt,jt,Gt,Ut,Bt,Zt,Ht,Yt;n(11)?(I=n(60),T=n(7),N=n(8),x=n(30),m=n(124),i=n(204),p=n(61),R=n(126),r=n(59),E=n(13),o=n(125),a=n(39),M=n(26),k=n(127),s=n(63),u=n(58),l=n(31),P=n(64),L=n(24),_=n(37),v=n(205),A=n(87),O=n(129),S=n(84).f,y=n(206),d=n(45),h=n(5),f=n(130),c=n(122),g=n(131),b=n(32),w=n(40),C=n(213),D=n(214),F=n(128),z=n(215),V=n(22),j=n(83),G=V.f,U=j.f,B=T.RangeError,Z=T.TypeError,H=T.Uint8Array,Y="ArrayBuffer",q="Shared"+Y,X="BYTES_PER_ELEMENT",W="prototype",K=Array[W],Q=i.ArrayBuffer,J=i.DataView,$=f(0),tt=f(2),et=f(3),nt=f(4),it=f(5),rt=f(6),ot=c(!0),at=c(!1),st=b.values,ut=b.keys,lt=b.entries,dt=K.lastIndexOf,ht=K.reduce,ft=K.reduceRight,ct=K.join,pt=K.sort,_t=K.slice,vt=K.toString,yt=K.toLocaleString,gt=h("iterator"),It=h("toStringTag"),Tt=d("typed_constructor"),Nt=d("def_constructor"),xt=m.CONSTR,mt=m.TYPED,Rt=m.VIEW,Et="Wrong length!",Mt=f(1,function(t,e){return Ot(g(t,t[Nt]),e)}),kt=N(function(){return 1===new H(new Uint16Array([1]).buffer)[0]}),Pt=!!H&&!!H[W].set&&N(function(){new H(1).set({})}),Lt=function(t,e){var n=a(t);if(n<0||n%e)throw B("Wrong offset!");return n},At=function(t){if(L(t)&&mt in t)return t;throw Z(t+" is not a typed array!")},Ot=function(t,e){if(!(L(t)&&Tt in t))throw Z("It is not a typed array constructor!");return new t(e)},St=function(t,e){return bt(g(t,t[Nt]),e)},bt=function(t,e){for(var n=0,i=e.length,r=Ot(t,i);n<i;)r[n]=e[n++];return r},wt=function(t,e,n){G(t,e,{get:function(){return this._d[n]}})},Ct=function(t,e,n){var i,r,o,a,s,u,l=_(t),d=arguments.length,h=1<d?e:void 0,f=void 0!==h,c=y(l);if(null!=c&&!v(c)){for(u=c.call(l),o=[],i=0;!(s=u.next()).done;i++)o.push(s.value);l=o}for(f&&2<d&&(h=p(h,n,2)),i=0,r=M(l.length),a=Ot(this,r);i<r;i++)a[i]=f?h(l[i],i):l[i];return a},Dt=function(){for(var t=0,e=arguments.length,n=Ot(this,e);t<e;)n[t]=arguments[t++];return n},Ft=!!H&&N(function(){yt.call(new H(1))}),zt=function(){return yt.apply(Ft?_t.call(At(this)):At(this),arguments)},Vt={copyWithin:function(t,e,n){return z.call(At(this),t,e,2<arguments.length?n:void 0)},every:function(t,e){return nt(At(this),t,1<arguments.length?e:void 0)},fill:function(){return F.apply(At(this),arguments)},filter:function(t,e){return St(this,tt(At(this),t,1<arguments.length?e:void 0))},find:function(t,e){return it(At(this),t,1<arguments.length?e:void 0)},findIndex:function(t,e){return rt(At(this),t,1<arguments.length?e:void 0)},forEach:function(t,e){$(At(this),t,1<arguments.length?e:void 0)},indexOf:function(t,e){return at(At(this),t,1<arguments.length?e:void 0)},includes:function(t,e){return ot(At(this),t,1<arguments.length?e:void 0)},join:function(){return ct.apply(At(this),arguments)},lastIndexOf:function(){return dt.apply(At(this),arguments)},map:function(t,e){return Mt(At(this),t,1<arguments.length?e:void 0)},reduce:function(){return ht.apply(At(this),arguments)},reduceRight:function(){return ft.apply(At(this),arguments)},reverse:function(){for(var t,e=this,n=At(e).length,i=Math.floor(n/2),r=0;r<i;)t=e[r],e[r++]=e[--n],e[n]=t;return e},some:function(t,e){return et(At(this),t,1<arguments.length?e:void 0)},sort:function(t){return pt.call(At(this),t)},subarray:function(t,e){var n=At(this),i=n.length,r=s(t,i);return new(g(n,n[Nt]))(n.buffer,n.byteOffset+r*n.BYTES_PER_ELEMENT,M((void 0===e?i:s(e,i))-r))}},jt=function(t,e){return St(this,_t.call(At(this),t,e))},Gt=function(t,e){At(this);var n=Lt(e,1),i=this.length,r=_(t),o=M(r.length),a=0;if(i<o+n)throw B(Et);for(;a<o;)this[n+a]=r[a++]},Ut={entries:function(){return lt.call(At(this))},keys:function(){return ut.call(At(this))},values:function(){return st.call(At(this))}},Bt=function(t,e){return L(t)&&t[mt]&&"symbol"!=typeof e&&e in t&&String(+e)==String(e)},Zt=function(t,e){return Bt(t,e=u(e,!0))?r(2,t[e]):U(t,e)},Ht=function(t,e,n){return!(Bt(t,e=u(e,!0))&&L(n)&&l(n,"value"))||l(n,"get")||l(n,"set")||n.configurable||l(n,"writable")&&!n.writable||l(n,"enumerable")&&!n.enumerable?G(t,e,n):(t[e]=n.value,t)},xt||(j.f=Zt,V.f=Ht),x(x.S+x.F*!xt,"Object",{getOwnPropertyDescriptor:Zt,defineProperty:Ht}),N(function(){vt.call({})})&&(vt=yt=function(){return ct.call(this)}),Yt=o({},Vt),o(Yt,Ut),E(Yt,gt,Ut.values),o(Yt,{slice:jt,set:Gt,constructor:function(){},toString:vt,toLocaleString:zt}),wt(Yt,"buffer","b"),wt(Yt,"byteOffset","o"),wt(Yt,"byteLength","l"),wt(Yt,"length","e"),G(Yt,It,{get:function(){return this[mt]}}),t.exports=function(t,h,e,r){r=!!r;var f=t+(r?"Clamped":"")+"Array",i="get"+t,o="set"+t,c=T[f],a=c||{},n=c&&O(c),s=!c||!m.ABV,u={},l=c&&c[W],d=function(t,e){var n=t._d;return n.v[i](e*h+n.o,kt)},p=function(t,e,n){var i=t._d;r&&(n=(n=Math.round(n))<0?0:255<n?255:255&n),i.v[o](e*h+i.o,n,kt)},_=function(t,e){G(t,e,{get:function(){return d(this,e)},set:function(t){return p(this,e,t)},enumerable:!0})};s?(c=e(function(t,e,n,i){R(t,c,f,"_d");var r,o,a,s,u=0,l=0;if(L(e)){if(!(e instanceof Q||(s=P(e))==Y||s==q))return mt in e?bt(c,e):Ct.call(c,e);r=e,l=Lt(n,h);var d=e.byteLength;if(void 0===i){if(d%h)throw B(Et);if(o=d-l,o<0)throw B(Et)}else if(o=M(i)*h,d<o+l)throw B(Et);a=o/h}else a=k(e),o=a*h,r=new Q(o);for(E(t,"_d",{b:r,o:l,l:o,e:a,v:new J(r)});u<a;)_(t,u++)}),l=c[W]=A(Yt),E(l,"constructor",c)):N(function(){c(1)})&&N(function(){new c(-1)})&&C(function(t){new c,new c(null),new c(1.5),new c(t)},!0)||(c=e(function(t,e,n,i){var r;return R(t,c,f),L(e)?e instanceof Q||(r=P(e))==Y||r==q?void 0!==i?new a(e,Lt(n,h),i):void 0!==n?new a(e,Lt(n,h)):new a(e):mt in e?bt(c,e):Ct.call(c,e):new a(k(e))}),$(n!==Function.prototype?S(a).concat(S(n)):S(a),function(t){t in c||E(c,t,a[t])}),c[W]=l,I||(l.constructor=c));var v=l[gt],y=!!v&&("values"==v.name||null==v.name),g=Ut.values;E(c,Tt,!0),E(l,mt,f),E(l,Rt,!0),E(l,Nt,c),(r?new c(1)[It]==f:It in l)||G(l,It,{get:function(){return f}}),u[f]=c,x(x.G+x.W+x.F*(c!=a),u),x(x.S,f,{BYTES_PER_ELEMENT:h}),x(x.S+x.F*N(function(){a.of.call(c,1)}),f,{from:Ct,of:Dt}),X in l||E(l,X,h),x(x.P,f,Vt),D(f),x(x.P+x.F*Pt,f,{set:Gt}),x(x.P+x.F*!y,f,Ut),I||l.toString==vt||(l.toString=vt),x(x.P+x.F*N(function(){new c(1).slice()}),f,{slice:jt}),x(x.P+x.F*(N(function(){return[1,2].toLocaleString()!=new c([1,2]).toLocaleString()})||!N(function(){l.toLocaleString.call([1,2])})),f,{toLocaleString:zt}),w[f]=y?v:g,I||y||E(l,gt,g)}):t.exports=function(){}},function(t,e,n){var i=n(22).f,r=n(31),o=n(5)("toStringTag");t.exports=function(t,e,n){t&&!r(t=n?t:t.prototype,o)&&i(t,o,{configurable:!0,value:e})}},function(t,e,n){"use strict";var i=n(23);t.exports=function(){var t=i(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},function(t){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},function(t,e,n){"use strict";var i=n(1),r=n(0);r(e,"__esModule",{value:!0}),e.default=void 0;var o=i(n(2)),a=i(n(3)),s=function(){function r(t,e,n,i){(0,o.default)(this,r),this._groupId=t,this._length=e,this._pointList=n||[],this._nodeList=i||[]}return(0,a.default)(r,[{key:"dispose",value:function(){this._pointList=[],this._nodeList=[]}},{key:"getPointList",value:function(){for(var t=[],e=0,n=this._pointList.length;e<n;e++)t.push({x:this._pointList[e].x,y:this._pointList[e].y,groupId:this._groupId});return t}},{key:"groupId",get:function(){return this._groupId}},{key:"GroupId",get:function(){return this._groupId}},{key:"length",get:function(){return this._length}},{key:"Length",get:function(){return this._length}},{key:"pointList",get:function(){return this.getPointList()}},{key:"PointList",get:function(){return this.getPointList()}}]),r}(),u=s;e.default=u},function(t,e,n){"use strict";var h=n(225),I=n(23),T=n(131),N=n(226),x=n(26),m=n(228),f=n(95),i=n(8),R=Math.min,c=[].push,a="split",p="length",_="lastIndex",E=4294967295,M=!i(function(){RegExp(E,"y")});n(229)("split",2,function(r,o,v,y){var g="c"=="abbc"[a](/(b)*/)[1]||4!="test"[a](/(?:)/,-1)[p]||2!="ab"[a](/(?:ab)*/)[p]||4!="."[a](/(.?)(.?)/)[p]||1<"."[a](/()()/)[p]||""[a](/.?/)[p]?function(t,e){var n=String(this);if(void 0===t&&0===e)return[];if(!h(t))return v.call(n,t,e);for(var i,r,o,a=[],s=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),u=0,l=void 0===e?E:e>>>0,d=new RegExp(t.source,s+"g");(i=f.call(d,n))&&(r=d[_],!(u<r&&(a.push(n.slice(u,i.index)),1<i[p]&&i.index<n[p]&&c.apply(a,i.slice(1)),o=i[0][p],u=r,a[p]>=l)));)d[_]===i.index&&d[_]++;return u===n[p]?!o&&d.test("")||a.push(""):a.push(n.slice(u)),a[p]>l?a.slice(0,l):a}:"0"[a](void 0,0)[p]?function(t,e){return void 0===t&&0===e?[]:v.call(this,t,e)}:v;return[function(t,e){var n=r(this),i=null==t?void 0:t[o];return void 0!==i?i.call(t,n,e):g.call(String(n),t,e)},function(t,e){var n=y(g,t,this,e,g!==v);if(n.done)return n.value;var i=I(t),r=String(this),o=T(i,RegExp),a=i.unicode,s=(i.ignoreCase?"i":"")+(i.multiline?"m":"")+(i.unicode?"u":"")+(M?"y":"g"),u=new o(M?i:"^(?:"+i.source+")",s),l=void 0===e?E:e>>>0;if(0===l)return[];if(0===r.length)return null===m(u,r)?[r]:[];for(var d=0,h=0,f=[];h<r.length;){u.lastIndex=M?h:0;var c,p=m(u,M?r:r.slice(h));if(null===p||(c=R(x(u.lastIndex+(M?0:h)),r.length))===d)h=N(r,h,a);else{if(f.push(r.slice(d,h)),f.length===l)return f;for(var _=1;_<=p.length-1;_++)if(f.push(p[_]),f.length===l)return f;h=d=c}}return f.push(r.slice(d)),f}]})},function(t,e,n){"use strict";var i,r,a=n(91),s=RegExp.prototype.exec,u=String.prototype.replace,o=s,l="lastIndex",d=(i=/a/,r=/b*/g,s.call(i,"a"),s.call(r,"a"),0!==i[l]||0!==r[l]),h=void 0!==/()??/.exec("")[1],f=d||h;f&&(o=function(t){var e,n,i,r,o=this;return h&&(n=new RegExp("^"+o.source+"$(?!\\s)",a.call(o))),d&&(e=o[l]),i=s.call(o,t),d&&i&&(o[l]=o.global?i.index+i[0].length:e),h&&i&&1<i.length&&u.call(i[0],n,function(){for(r=1;r<arguments.length-2;r++)void 0===arguments[r]&&(i[r]=void 0)}),i}),t.exports=o},function(t,e,n){"use strict";var i=n(1),r=n(0);r(e,"__esModule",{value:!0}),e.default=void 0;var o=i(n(15)),a=i(n(2)),s=i(n(3)),u=i(n(12)),l=(i(n(135)),function(){function t(){(0,a.default)(this,t),this.Id=0,this.startId=-1,this.startPoint={},this.endId=-1,this.endPoint={},this.length=0,this._type=0,this.pointVector=[],this.extentId=-1,this._isInAdj=!1,this._info=0}return(0,s.default)(t,[{key:"setRoad",value:function(t){this.Id=t.Id,this.startId=t.startId,this.startPoint=(0,o.default)({},t.startPoint),this.endId=t.endId,this.endPoint=(0,o.default)({},t.endPoint),this.length=t.length,this._type=t._type,this.pointVector=[],this.extentId=t.extentId;for(var e=0;e<t.pointVector.length;e++)this.pointVector[e]=t.pointVector[e]}},{key:"calcLength",value:function(){this.length=u.default.distanceOfTwoPoints(this.startPoint,this.endPoint)}},{key:"calcManhattanDistance",value:function(){var t=this.startPoint.x-this.endPoint.x,e=this.startPoint.y-this.endPoint.y;this.length=Math.abs(t)+Math.abs(e)}},{key:"calcMiddlePoint",value:function(){var t={};return t.x=(this.startPoint.x+this.endPoint.x)/2,t.y=(this.startPoint.y+this.endPoint.y)/2,t}},{key:"roadRank",set:function(t){this._type|=t},get:function(){return 3&this._type}},{key:"roadEntry",set:function(t){this._type|=t<<2},get:function(){return this._type>>2&3}},{key:"tempType",set:function(t){this._type|=t<<4},get:function(){return this._type>>4&3}},{key:"through",set:function(t){t?this._type|=16:this._type&=-17},get:function(){return 16&this._type?1:0}}]),t}()),d=l;e.default=d},function(t,e,n){"use strict";var i=n(1),r=n(0);r(e,"__esModule",{value:!0}),e.NodeDistance=e.default=void 0;var o=i(n(47));n(67);var a=i(n(29));n(50),n(32),n(17);var h=i(n(134));n(21);var s=i(n(3));n(16);var u=i(n(2)),p=i(n(12)),_=i(n(42)),v=i(n(33)),l=i(n(49)),c=function t(){(0,u.default)(this,t),this.distance=Number.MAX_VALUE,this.node=null};e.NodeDistance=c;var d=function(){function f(t,e,n,i){(0,u.default)(this,f),this.groupId=0,this._type=i,this.nodeVector=t,this.roadVector=e,this.obstructModels=[],this.obstructExtents=[],this.obstructLines=[],this.zones=[],this.zoneIDMap=new l.default,this.vertexLen=[],this.adjList=new l.default,this.nextFloorMap=new l.default,this._needVertex=n,this._roadDiffusion=[],this._nodeMap=new l.default,this._roadMap=new l.default,this._maxNodeId=0,this._maxRoadId=0,this.simplify(),this._init()}return(0,s.default)(f,[{key:"dispose",value:function(){this.nodeVector=null,this.roadVector=null,this.obstructModels=null,this.obstructExtents=null,this.obstructLines=null,this.zones=null,null!=this.zoneIDMap&&(this.zoneIDMap.clear(),this.zoneIDMap=null),null!=this.adjList&&(this.adjList.clear(),this.adjList=null),this.vertexLen=null,null!=this.nextFloorMap&&(this.nextFloorMap.clear(),this.nextFloorMap=null),this._roadDiffusion=null,null!=this._nodeMap&&(this._nodeMap.clear(),this._nodeMap=null),null!=this._roadMap&&(this._roadMap.clear(),this._roadMap=null)}},{key:"initVertexLen",value:function(t){for(var e,n,i=Number.MAX_VALUE,r=0;r<this.roadVector.length;r++)0!=this.needVertex&&(e=this.roadVector[r],1==t?i=e.length:2==t&&(i=e.length*e.roadRank),n=e.roadEntry,n!=v.default.NaviRoadEntry_BOTH&&n!=v.default.NaviRoadEntry_FORWARD||(this.vertexLen[e.startId][e.endId]=i),n!=v.default.NaviRoadEntry_BOTH&&n!=v.default.NaviRoadEntry_BACK||(this.vertexLen[e.endId][e.startId]=i))}},{key:"invalide",value:function(){return 0==this.nodeVector.length||0==this.roadVector.length}},{key:"reset",value:function(){for(var t=0;t<this.nodeVector.length;t++)this.nodeVector[t]._treatHead=!1;if(1==this._needVertex)for(var e=this.nodeVector.length+1,n=0;n<e;n++)for(var i=0;i<e;i++)void 0!==this.vertexLen[n]&&void 0!==this.vertexLen[n][i]&&(this.vertexLen[n][i]=Number.MAX_VALUE)}},{key:"obstructsToZones",value:function(){this.zones=[];for(var t=0;t<this.obstructExtents.length;t++){var e=this.obstructExtents[t],n=e.toZone();this.zones.push(n)}for(var i=0;i<this.obstructModels.length;i++){var r=this.obstructExtents[i],o=r.toZone();this.zones.push(o)}}},{key:"getZone",value:function(t){for(var e=0;e<this.zones.length;e++){var n=this.zones[e];if(n&&n.Id==t)return n}return null}},{key:"queryZoneByPoint",value:function(t){for(var e=0;e<this.zones.length;e++){var n=this.zones[e];if(n&&1==n.contain(t))return n}return null}},{key:"transpose",value:function(){}},{key:"queryEntranceCoordByPoint",value:function(t,e){var n=null;if(this.nodeVector.length<=0||this.roadVector.length<=0)return n;for(var i=[],r=0,o=this.nodeVector.length;r<o;r++){var a,s=this.nodeVector[r],u=s.entranceType;u!=e&&u!=v.default.NaviEntranceType_ACCESS||(a=new c,a.node=s,a.distance=p.default.distanceOfTwoPoints(t,s.point),i.push(a))}return 0==i.length||(i=i.sort(this._nodeDistanceFunc),n=i[0].node.point),n}},{key:"queryEntranceCoords",value:function(t){var e=[];if(this.nodeVector.length<=0||this.roadVector.length<=0)return e;for(var n=0,i=this.nodeVector.length;n<i;n++){var r=this.nodeVector[n],o=r.entranceType;o!=t&&o!=v.default.NaviEntranceType_ACCESS||e.push(r.point)}return e}},{key:"nodesAccess",value:function(t,e){if(this.nodeVector.length<=0||this.roadVector.length<=0)return!1;if(t.Id==e.Id)return!0;this._resetRoadDiffusion();var n=[];n.push(t.Id);for(var i=null,r=null,o=0,a=o;o!=n.length;){a=o,o=n.length;for(var s=a;s<n.length;s++)for(var u=0;u<this.roadVector.length;u++)if(1!=this._roadDiffusion[u]){if(i=this.roadVector[u],r=i.roadEntry,i.startId==n[s]&&(r==v.default.NaviRoadEntry_BOTH||r==v.default.NaviRoadEntry_FORWARD)){if(i.endId==e.Id)return!0;n.push(i.endId),this._roadDiffusion[u]=!0}if(i.endId==n[s]&&(r==v.default.NaviRoadEntry_BOTH||r==v.default.NaviRoadEntry_BACK)){if(i.startId==e.Id)return!0;n.push(i.startId),this._roadDiffusion[u]=!0}}}return!1}},{key:"querySameExtentLiftNodesByGeoPoint",value:function(t,e,n,i){if(this.nodeVector.length<=0||this.roadVector.length<=0)return[];var r=this.queryContainExtentId(t);if(0==r)return!1;for(var o=[],a=0;a<this.nodeVector.length;a++){var s,u=this.nodeVector[a],l=this.queryContainExtentId(u.point);!u.contansFloor(e)||l!=r&&0!=r||(s=new c,s.node=u,s.distance=p.default.distanceOfTwoPoints(t,u.point),s.distance=(0,h.default)(s.distance).toFixed(4),o.push(s))}if(!o||0==o.length)return[];o=o.sort(this._nodeDistanceFunc);for(var d=0;d<o.length;d++)n[d]=new _.default,n[d].setNode(o[d].node),i[d]=(0,h.default)(o[d].distance);return n}},{key:"queryLiftNodeByFLAGID",value:function(t,e){if(!this.nodeVector||this.nodeVector.length<=0||!this.roadVector||this.roadVector.length<=0)return!1;for(var n=0;n<this.nodeVector.length;n++){var i=this.nodeVector[n];if(i.nodeType==v.default.NaviNodeType_FLOOR){var r=i.liftFlag;if(r==t)return e.setNode(i),!0}}return!1}},{key:"queryLiftNodesByType",value:function(t,e){if(!this.nodeVector||this.nodeVector.length<=0||!this.roadVector||this.roadVector.length<=0)return!1;for(var n=0;n<this.nodeVector.length;n++){var i=this.nodeVector[n];i.liftType==t&&(e[n]=i)}return 0!=e.length}},{key:"queryContainExtentId",value:function(t){if(0==this.obstructExtents.length||!t)return 0;for(var e=0,n=this.obstructExtents.length;e<n;e++){var i=this.obstructExtents[e];if(i.contain(t))return i.Id}return 0}},{key:"isLineObstruct",value:function(t,e){if(0==this.obstructLines.length||!t||!e)return!1;for(var n=0;n<this.obstructLines.length;n++)if(this.obstructLines[n].isCross(t,e))return!0;return!1}},{key:"queryNearestSameExtentElementByGeoPoint",value:function(t,e,n,i){var r=Number.MAX_VALUE,o={};if(new _.default,this.nodeVector.length<=0||this.roadVector.length<=0)return!1;var a=this.queryContainExtentId(t);if(0==a)return!1;for(var s,u=0,l=this.roadVector.length;u<l;u++){var d,h=this.roadVector[u];h&&a==this.queryContainExtentId(h.startPoint)&&(d=p.default.pointDistanceToLine(t,h.startPoint,h.endPoint,o),this.isLineObstruct(o,t)||d<r&&(r=d,e.setRoad(h),i.x=o.x,i.y=o.y))}if(!e||e.roadEntry==v.default.NaviRoadEntry_FORBID)return!1;s=e.roadEntry==v.default.NaviRoadEntry_BACK||e.roadEntry!=v.default.NaviRoadEntry_FORWARD&&p.default.distanceOfTwoPoints(e.startPoint,i)<=p.default.distanceOfTwoPoints(e.endPoint,i)?e.startId:e.endId;for(var f=0;f<this.nodeVector.length;f++){var c=this.nodeVector[f];if(c.Id==s){n.setNode(c);break}}return!0}},{key:"queryNearestSameExtentElementByGeoPointProcessForbid",value:function(t,e,n,i){var r=Number.MAX_VALUE,o={};if(new _.default,this.nodeVector.length<=0||this.roadVector.length<=0)return!1;var a=this.queryContainExtentId(t);if(0==a)return!1;for(var s,u=0;u<this.roadVector.length;u++){var l,d=this.roadVector[u];v.default.NaviRoadEntry_BOTH==d.roadEntry&&(a!=this.queryContainExtentId(d.startPoint)&&0!=a||(l=p.default.pointDistanceToLine(t,d.startPoint,d.endPoint,o),this.isLineObstruct(o,t)||l<r&&(r=l,e.setRoad(d),i.x=o.x,i.y=o.y)))}if(-1==e.Id)return!1;s=p.default.distanceOfTwoPoints(e.startPoint,i)<=p.default.distanceOfTwoPoints(e.endPoint,i)?e.startId:e.endId;for(var h=0;h<this.nodeVector.length;h++){var f=this.nodeVector[h];if(f.Id==s){n.setNode(f);break}}return-1!=n.Id}},{key:"simplify",value:function(){this._maxNodeId=0,this._maxRoadId=0;for(var t=0;t<this.roadVector.length;)null==this.roadVector[t]?this.roadVector.splice(t,1):(this.roadVector[t].Id>this._maxRoadId&&(this._maxRoadId=this.roadVector[t].Id),t++);for(var e=0;e<this.nodeVector.length;)null==this.nodeVector[e]?this.nodeVector.splice(e,1):(this.nodeVector[e].Id>this._maxNodeId&&(this._maxNodeId=this.nodeVector[e].Id),e++)}},{key:"consoleAdjList",value:function(t){if(t){var e,n=this.adjList,i=(this.nodeVector,this),r=(naviMap.size(),"*********  ADJLIST   ************\n");for(e in n.keys)for(var o=n.keys[e],a=o,s=n.get(o),u=0;u<s.length;u++){var l=s[u],d=l.nodeId,h=this._naviGraph.getIndexByNodeID(a),f=(this._naviGraph.getIndexByNodeID(d),i.nodeVector[h]),c=i.nodeVector[endidx],r=r+f.Id+","+f.point.x+","+f.point.y;r+=",",r=r+c.Id+","+c.point.x+","+c.point.y,r+="\n"}r+="*********** END **************"}}},{key:"consoleNodeInfos",value:function(t){if(t){var e=[];e.push.apply(e,(0,a.default)(this.nodeVector)),e.sort(function(t,e){return t.Id-e.Id});for(var n=0;n<e.length;n++)for(var i=e[n],r=(i.Id,0);r<i.segLinks.length;r++)i.segLinks[r]}}},{key:"consoleNodePres",value:function(t){if(t)for(var e=0;e<this.nodeVector.length;e++)for(var n=this.nodeVector[e],i=(n.Id,0);i<n._vPre.length;i++)n._vPre[i]}},{key:"consoleRoadInfos",value:function(t){if(t){var e=[];e.push.apply(e,(0,a.default)(this.roadVector)),e.sort(function(t,e){return t.Id-e.Id});for(var n=0;n<e.length;n++){var i=e[n];i.Id,i.startId,i.endId}}}},{key:"consoleAdjInfos",value:function(t){t&&(this.adjList.sort(),this.adjList.each(function(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.nodeId,i.length.toFixed(6)}}))}},{key:"getIndexByNodeID",value:function(t){var e=this._nodeMap.get(t);return void 0===e?null:e}},{key:"getIndexByRoadID",value:function(t){var e=this._roadMap.get(t);return void 0===e?null:e}},{key:"findObstruct",value:function(t){for(var e=Number.MAX_VALUE,n=null,i=0;i<this.obstructExtents.length;++i){var r=this.obstructExtents[i],o=r.contain(t);o&&r.area<e&&(e=cur_area,n=r)}for(var a=0;a<this.obstructModels.size();++a){var s=this.obstructModels[a],u=s.contain(t);u&&s.area<e&&(e=cur_area,n=s)}return n||null}},{key:"findModel",value:function(t){for(var e=Number.MAX_VALUE,n=null,i=0;i<this.obstructModels.length;++i){var r=this.obstructModels[i],o=r.contain(t);o&&r.area<e&&(e=r.area,n=r)}return n||null}},{key:"generateNodeId",value:function(){return++this._maxNodeId}},{key:"generateRoadId",value:function(){return++this._maxRoadId}},{key:"setBaseNodeId",value:function(t){this._maxNodeId=t}},{key:"setBaseRoadId",value:function(t){this._maxRoadId=t}},{key:"createNodeMap",value:function(){for(var t=0;t<this.nodeVector.length;t++){var e=this.nodeVector[t];e&&this._nodeMap.put(e.Id,t)}}},{key:"createRoadMap",value:function(){for(var t=0;t<this.roadVector.length;t++){var e=this.roadVector[t];e&&this._roadMap.put(e.Id,t)}}},{key:"clearNodeCache",value:function(){var i=this;this._nodeMap.each(function(t,e){var n=i.nodeVector[e];n._vPre=[]})}},{key:"makeUpAdjList",value:function(){var s=this;this.adjList.clear();for(var u,t=function(t){var e=s.roadVector[t];if(null==e)return"continue";var n,i,r,o,a=e.roadEntry;v.default.NaviRoadEntry_BOTH!=a&&v.default.NaviRoadEntry_FORWARD!=a||(n=e.startId,i=s.adjList.get(n),i||(i=[],s.adjList.put(n,i)),u=i.find(function(t){return t.nodeId==e.endId}),null==u&&i.push({nodeId:e.endId,length:e.length})),v.default.NaviRoadEntry_BOTH!=a&&v.default.NaviRoadEntry_BACK!=a||(r=e.endId,o=s.adjList.get(r),o||(o=[],s.adjList.put(r,o)),u=o.find(function(t){return t.nodeId==e.startId}),null==u&&o.push({nodeId:e.startId,length:e.length}))},e=0;e<this.roadVector.length;e++)t(e)}},{key:"getIdxByNodeId",value:function(t){for(var e=9;e<this.nodeVector.length;e++)if(this.nodeVector[e].Id==t)return e;return-1}},{key:"getIdxByRoadId",value:function(t){for(var e=9;e<this.roadVector.length;e++)if(this.roadVector[e].Id==t)return e;return-1}},{key:"queryRoadsByPolygon",value:function(t){for(var e=[],n=this.roadVector,i=0;i<n.length;i++){var r=n[i].startPoint,o=n[i].endPoint,a=[];p.default.segCrossPolygon(r,o,t,a)?(a.sort(function(t,e){var n=p.default.distanceOfTwoPoints(r,t),i=p.default.distanceOfTwoPoints(r,e);return n-i}),e.push({road:n[i],crss:a})):p.default.pointInPolygon2d(t,r,t.length)&&e.push({road:n[i],crss:[]})}return e}},{key:"getModelByPoint",value:function(t){for(var e=null,n=1/0,i=0;i<this.obstructModels.length;i++){var r=this.obstructModels[i];r.Id,r.fid,p.default.pointInPolygon2d(r.points,t,r.points.length)&&n>p.default.calcPolygonArea2d(r.points)&&(e=r,n=p.default.calcPolygonArea2d(r.points))}return e}},{key:"getZoneIdByPoint",value:function(t){for(var e=-1,n=0;n<this.zones.length;n++){var i=this.zones[n];if(p.default.pointInPolygon2d(i.points,t,i.points.length)){e=i.Id;break}}return e}},{key:"getRandomModel",value:function(){var t=this.obstructModels.length,e=(0,o.default)(Math.random()*t);return this.obstructModels[e]}},{key:"_init",value:function(){if(1==this._needVertex)for(var t=null,e=0;e<this.roadVector.length;e++)t=this.roadVector[e],void 0===this.vertexLen[t.startId]&&(this.vertexLen[t.startId]=new Array),this.vertexLen[t.startId][t.endId]=Number.MAX_VALUE,void 0===this.vertexLen[t.endId]&&(this.vertexLen[t.endId]=new Array),this.vertexLen[t.endId][t.startId]=Number.MAX_VALUE;for(var n=0;n<this.roadVector.length;n++)this._roadDiffusion[n]=!1}},{key:"_resetRoadDiffusion",value:function(){for(var t=0;t<this._roadDiffusion.length;t++)this._roadDiffusion[t]=!1}},{key:"_nodeDistanceFunc",value:function(t,e){return(0,h.default)(t.distance)-(0,h.default)(e.distance)}},{key:"getLifts",value:function(){for(var t=[],e=0;e<this.nodeVector.length;e++){var n=this.nodeVector[e];n.liftType==v.default.NaviLiftType_Lift&&t.push(n)}return t}},{key:"getNodeByFlag",value:function(t){for(var e=0;e<this.nodeVector.length;e++)if(this.nodeVector[e].liftFlag==t)return this.nodeVector[e];return null}},{key:"getEscalators",value:function(){}},{key:"getStaris",value:function(){}},{key:"getAllLifts",value:function(){for(var t=[],e=0;e<this.nodeVector.length;e++){var n=this.nodeVector[e];n.liftType!=v.default.NaviLiftType_NULL&&t.push(n)}return t}},{key:"getGraphByEid",value:function(t){for(var e=null,n=0;n<this.obstructExtents.length;n++)if(t==this.obstructExtents[n].Id){e=this.obstructExtents[n];break}if(!e)return null;for(var i=[],r=0;r<this.nodeVector.length;r++){var o=this.nodeVector[r];p.default.pointInPolygon2d(e.points,o.point,e.points.length)&&i.push(o)}for(var a=[],s=0;s<this.roadVector.length;s++){var u=this.roadVector[s];p.default.pointInPolygon2d(e.points,u.startPoint,e.points.length)&&a.push(u)}for(var l=[],n=0;n<this.obstructModels.length;n++){var d=this.obstructModels[n];p.default.pointInPolygon2d(e.points,d.center,e.points.length)&&l.push(d)}var h=new f(i,a,!0,1);return h.obstructModels=l,h.obstructExtents=[e],h}}]),f}(),f=d;e.default=f},function(t,e,n){"use strict";var i=n(1),r=n(0);r(e,"__esModule",{value:!0}),e.default=void 0,n(21),n(16);var o=i(n(2)),a=i(n(3)),s=i(n(41)),u=i(n(48)),l=function(){function e(t){(0,o.default)(this,e),this._naviGraph=t,this._startNode=null,this._endNode=null,this._startNodeID=-1,this._endNodeID=-1,this._mode=s.default.MODULE_SHORTEST,this._naviGraph.createNodeMap(),this._naviGraph.createRoadMap(),this._naviGraph.makeUpAdjList(),this._kEPSILON_VALUE=5e-4}return(0,a.default)(e,[{key:"routeMultiDestinations",value:function(t,e,n){this._switchToMode(n),this._destIds=e;var i=this._naviGraph.getIndexByNodeID(t);if(-1==i)return u.default.ROUTE_FAILED_CANNOT_CALCULATE;this.endIdxs=[];for(var r=0;r<e.length;r++){var o=this._naviGraph.getIndexByNodeID(e[r]);this.endIdxs.push(o)}var a=this._dijkstraAssist_1vN(this._naviGraph,i,this.endIdxs);return this._naviGraph.consoleNodePres(),!!a}},{key:"getMultiRoute",value:function(t){for(var e=0;e<this.endIdxs.length;e++){var n=[];this._getOneRoute(this.endIdxs[e],n),n.reverse(),t.push(n)}}},{key:"_getOneRoute",value:function(t,e){var n=this._naviGraph.nodeVector[t];e.push(n);var i=n._vPre[0];null!=i&&this._getOneRoute(i,e)}},{key:"routeCalculate",value:function(t,e,n){this._switchToMode(n),this._startNode=t,this._endNode=e,this._startNodeID=t.Id,this._endNodeID=e.Id;var i=this._naviGraph.getIndexByNodeID(this._startNodeID);if(-1==i)return u.default.ROUTE_FAILED_CANNOT_CALCULATE;var r=this._naviGraph.getIndexByNodeID(e.Id);if(-1==r)return u.default.ROUTE_FAILED_CANNOT_CALCULATE;var o=[];o.push(r);var a=this._dijkstraAssist_1vN(this._naviGraph,i,o);return this._naviGraph.consoleNodePres(),a?u.default.ROUTE_SUCCESS:u.default.ROUTE_FAILED_CANNOT_ARRIVE}},{key:"getRouteCalculateResult",value:function(){var t=[],e=this._naviGraph.getIndexByNodeID(this._endNodeID),n=[];n.push(e);var i=[],r=[];return this._multiPathNodeVector(n,this._naviGraph.nodeVector,i,r),t.push.apply(t,i),t}},{key:"dispose",value:function(){this._naviGraph.dispose(),this._naviGraph=null,this._startNode=null,this._endNode=null}},{key:"_dijkstraAssist_1vN",value:function(t,e,n){if(null==t)return!1;var i=t.nodeVector.length;if(e<0||i<=e)return!1;this._removeArrayAll(n,e);for(var r=0;r<i;++r)t.nodeVector[r]._dist=Number.MAX_VALUE,t.nodeVector[r]._visited=!1,t.nodeVector[r]._vPre=[];t.nodeVector[e]._dist=0;var o=n.length,a=0,s=[];s.push(t.nodeVector[e]);for(var u=this._nodeDistCompareFunc.bind(this);0<s.length;){var l=s[0].Id;s.splice(0,1);var d=t.getIndexByNodeID(l);if(null!=d){var h=t.nodeVector[d];if(!h._visited){h._visited=!0;var f=n.indexOf(d);if(-1!=f&&(++a,a==o))return!0;if(0!=t.adjList.size()){var c=t.adjList.get(l);if(c)for(var p=0;p<c.length;p++){var _,v,y=c[p],g=y.nodeId,I=t.getIndexByNodeID(g);null!=I&&(_=y.length,v=t.nodeVector[I],v._visited||(v._dist>_+h._dist?(v._dist=_+h._dist,v._vPre=[],v._vPre.push(d),s.push(t.nodeVector[I]),s.sort(u)):Math.abs(v._dist-(_+h._dist))<1e-12&&-1!=v._vPre.indexOf(d)&&v._vPre.push(d)))}}}}}return!(a<o)}},{key:"_nodeDistCompareFunc",value:function(t,e){return t._dist-(e._dist+this._kEPSILON_VALUE)}},{key:"_removeArrayAll",value:function(t,e){for(var n=t.indexOf(e);-1!=n;)t.splice(n,1),n=t.indexOf(e)}},{key:"_switchToMode",value:function(t){this._mode!=t&&(s.default.MODULE_SHORTEST==t?this._naviGraph.roadVector.forEach(function(t){t.length=t.length/t.roadRank}):s.default.MODULE_BEST==t&&this._naviGraph.roadVector.forEach(function(t){t.length=t.length*t.roadRank}),this._naviGraph.makeUpAdjList(),this._mode=t)}},{key:"_pathNodeVector",value:function(t,e,n,i){var r;0!=e[t]._vPre.length&&(r=e[t]._vPre[0],n.push(e[r]),i.count++,this._pathNodeVector(r,e,n,i))}},{key:"_multiPathNodeVector",value:function(t,e,n,i){for(var r=0;r<t.length;r++){var o=t[r];n.push(e[o]);var a={count:1};this._pathNodeVector(o,e,n,a),i.push(a.count)}}}]),e}(),d=l;e.default=d},function(t,e,n){"use strict";var i=n(0);i(e,"__esModule",{value:!0}),e._Math=void 0,n(65),n(17);var r={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){for(var o=[],t=0;t<256;t++)o[t]=(t<16?"0":"")+t.toString(16);return function(){var t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,n=4294967295*Math.random()|0,i=4294967295*Math.random()|0,r=o[255&t]+o[t>>8&255]+o[t>>16&255]+o[t>>24&255]+"-"+o[255&e]+o[e>>8&255]+"-"+o[e>>16&15|64]+o[e>>24&255]+"-"+o[63&n|128]+o[n>>8&255]+"-"+o[n>>16&255]+o[n>>24&255]+o[255&i]+o[i>>8&255]+o[i>>16&255]+o[i>>24&255];return r.toUpperCase()}}(),clamp:function(t,e,n){return Math.max(e,Math.min(n,t))},euclideanModulo:function(t,e){return(t%e+e)%e},mapLinear:function(t,e,n,i,r){return i+(t-e)*(r-i)/(n-e)},lerp:function(t,e,n){return(1-n)*t+n*e},smoothstep:function(t,e,n){return t<=e?0:n<=t?1:(t=(t-e)/(n-e),t*t*(3-2*t))},smootherstep:function(t,e,n){return t<=e?0:n<=t?1:(t=(t-e)/(n-e),t*t*t*(t*(6*t-15)+10))},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(t){return t*r.DEG2RAD},radToDeg:function(t){return t*r.RAD2DEG},isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}};e._Math=r},function(t,e,n){t.exports=!n(14)&&!n(20)(function(){return 7!=Object.defineProperty(n(101)("div"),"a",{get:function(){return 7}}).a})},function(t,e,n){var i=n(19),r=n(9).document,o=i(r)&&i(r.createElement);t.exports=function(t){return o?r.createElement(t):{}}},function(t,e,n){t.exports=n(155)},function(t,e,n){var i=n(71);t.exports=Array.isArray||function(t){return"Array"==i(t)}},function(t,e,n){var a=n(28),s=n(35),u=n(160)(!1),l=n(73)("IE_PROTO");t.exports=function(t,e){var n,i=s(t),r=0,o=[];for(n in i)n!=l&&a(i,n)&&o.push(n);for(;e.length>r;)a(i,n=e[r++])&&(~u(o,n)||o.push(n));return o}},function(t,e,n){var i=n(71);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==i(t)?t.split(""):Object(t)}},function(t,e,n){var i=n(72),r=Math.min;t.exports=function(t){return 0<t?r(i(t),9007199254740991):0}},function(t){function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}t.exports=e},function(t,e,n){t.exports=n(164)},function(t,e,n){"use strict";var I=n(53),T=n(6),N=n(110),x=n(34),m=n(36),R=n(166),E=n(78),M=n(112),k=n(10)("iterator"),P=!([].keys&&"next"in[].keys()),L="@@iterator",A="keys",O="values",S=function(){return this};t.exports=function(t,e,n,i,r,o,a){R(n,e,i);var s,u,l,d=function(t){if(!P&&t in p)return p[t];switch(t){case A:case O:return function(){return new n(this,t)}}return function(){return new n(this,t)}},h=e+" Iterator",f=r==O,c=!1,p=t.prototype,_=p[k]||p[L]||r&&p[r],v=_||d(r),y=r?f?d("entries"):v:void 0,g="Array"==e&&p.entries||_;if(g&&(l=M(g.call(new t)),l!==Object.prototype&&l.next&&(E(l,h,!0),I||"function"==typeof l[k]||x(l,k,S))),f&&_&&_.name!==O&&(c=!0,v=function(){return _.call(this)}),I&&!a||!P&&!c&&p[k]||x(p,k,v),m[e]=v,m[h]=S,r)if(s={values:f?v:d(O),keys:o?v:d(A),entries:y},a)for(u in s)u in p||N(p,u,s[u]);else T(T.P+T.F*(P||c),e,s);return s}},function(t,e,n){t.exports=n(34)},function(t,e,n){var a=n(18),s=n(27),u=n(51);t.exports=n(14)?Object.defineProperties:function(t,e){s(t);for(var n,i=u(e),r=i.length,o=0;o<r;)a.f(t,n=i[o++],e[n]);return t}},function(t,e,n){var i=n(28),r=n(44),o=n(73)("IE_PROTO"),a=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=r(t),i(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?a:null}},function(t,e,n){var r=n(71),o=n(10)("toStringTag"),a="Arguments"==r(function(){return arguments}()),s=function(t,e){try{return t[e]}catch(t){}};t.exports=function(t){var e,n,i;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=s(e=Object(t),o))?n:a?r(e):"Object"==(i=r(e))&&"function"==typeof e.callee?"Arguments":i}},function(t,e,n){n(176);for(var i=n(9),r=n(34),o=n(36),a=n(10)("toStringTag"),s="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),u=0;u<s.length;u++){var l=s[u],d=i[l],h=d&&d.prototype;h&&!h[a]&&r(h,a,l),o[l]=o.Array}},function(t,e,n){t.exports=n(180)},function(t,e,n){var i=n(104),r=n(75).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return i(t,r)}},function(t,e,n){var i=n(55),r=n(43),o=n(35),a=n(70),s=n(28),u=n(100),l=Object.getOwnPropertyDescriptor;e.f=n(14)?l:function(t,e){if(t=o(t),e=a(e,!0),u)try{return l(t,e)}catch(t){}if(s(t,e))return r(!i.f.call(t,e),t[e])}},function(t,e,n){t.exports=!n(11)&&!n(8)(function(){return 7!=Object.defineProperty(n(119)("div"),"a",{get:function(){return 7}}).a})},function(t,e,n){var i=n(24),r=n(7).document,o=i(r)&&i(r.createElement);t.exports=function(t){return o?r.createElement(t):{}}},function(t,e,n){var i=n(46);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==i(t)?t.split(""):Object(t)}},function(t,e,n){var a=n(31),s=n(62),u=n(122)(!1),l=n(85)("IE_PROTO");t.exports=function(t,e){var n,i=s(t),r=0,o=[];for(n in i)n!=l&&a(i,n)&&o.push(n);for(;e.length>r;)a(i,n=e[r++])&&(~u(o,n)||o.push(n));return o}},function(t,e,n){var u=n(62),l=n(26),d=n(63);t.exports=function(s){return function(t,e,n){var i,r=u(t),o=l(r.length),a=d(n,o);if(s&&e!=e){for(;a<o;)if(i=r[a++],i!=i)return!0}else for(;a<o;a++)if((s||a in r)&&r[a]===e)return s||a||0;return!s&&-1}}},function(t,e,n){var i=n(121),r=n(86);t.exports=Object.keys||function(t){return i(t,r)}},function(t,e,n){for(var i,r=n(7),o=n(13),a=n(45),s=a("typed_array"),u=a("view"),l=!(!r.ArrayBuffer||!r.DataView),d=l,h=0,f=9,c="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");h<f;)(i=r[c[h++]])?(o(i.prototype,s,!0),o(i.prototype,u,!0)):d=!1;t.exports={ABV:l,CONSTR:d,TYPED:s,VIEW:u}},function(t,e,n){var r=n(25);t.exports=function(t,e,n){for(var i in e)r(t,i,e[i],n);return t}},function(t){t.exports=function(t,e,n,i){if(!(t instanceof e)||void 0!==i&&i in t)throw TypeError(n+": incorrect invocation!");return t}},function(t,e,n){var i=n(39),r=n(26);t.exports=function(t){if(void 0===t)return 0;var e=i(t),n=r(e);if(e!==n)throw RangeError("Wrong length!");return n}},function(t,e,n){"use strict";var l=n(37),d=n(63),h=n(26);t.exports=function(t,e,n){for(var i=l(this),r=h(i.length),o=arguments.length,a=d(1<o?e:void 0,r),s=2<o?n:void 0,u=void 0===s?r:d(s,r);a<u;)i[a++]=t;return i}},function(t,e,n){var i=n(31),r=n(37),o=n(85)("IE_PROTO"),a=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=r(t),i(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?a:null}},function(t,e,n){var I=n(61),T=n(120),N=n(37),x=n(26),i=n(207);t.exports=function(h,t){var f=1==h,c=2==h,p=3==h,_=4==h,v=6==h,y=5==h||v,g=t||i;return function(t,e,n){for(var i,r,o=N(t),a=T(o),s=I(e,n,3),u=x(a.length),l=0,d=f?g(t,u):c?g(t,0):void 0;l<u;l++)if((y||l in a)&&(i=a[l],r=s(i,l,o),h))if(f)d[l]=r;else if(r)switch(h){case 3:return!0;case 5:return i;case 6:return l;case 2:d.push(i)}else if(_)return!1;return v?-1:p||_?_:d}}},function(t,e,n){var r=n(23),o=n(82),a=n(5)("species");t.exports=function(t,e){var n,i=r(t).constructor;return void 0===i||null==(n=r(i)[a])?e:o(n)}},function(t,e,n){var i=n(5)("unscopables"),r=Array.prototype;null==r[i]&&n(13)(r,i,{}),t.exports=function(t){r[i][t]=!0}},function(t,e,n){var a=n(6),i=n(52),s=n(20),u=n(92),r="["+u+"]",l="​",o=RegExp("^"+r+r+"*"),d=RegExp(r+r+"*$"),h=function(t,e,n){var i={},r=s(function(){return!!u[t]()||l[t]()!=l}),o=i[t]=r?e(f):u[t];n&&(i[n]=o),a(a.P+a.F*r,"String",i)},f=h.trim=function(t,e){return t=String(i(t)),1&e&&(t=t.replace(o,"")),2&e&&(t=t.replace(d,"")),t};t.exports=h},function(t,e,n){t.exports=n(233)},function(t,e,n){"use strict";var i=n(1),r=n(0);r(e,"__esModule",{value:!0}),e.default=void 0;var o=i(n(2)),a=i(n(3)),s=function(){function t(){(0,o.default)(this,t),this.x=void 0,this.y=void 0,this.z=void 0,this.gid=void 0}return(0,a.default)(t,[{key:"setGeoPoint",value:function(t){this.x=t.x,this.y=t.y}}]),t}(),u=s;e.default=u},function(t,e,n){t.exports=n(238)},function(t,e,n){var i=n(242),r=n(245);function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=i(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&r(t,e)}t.exports=o},function(t,e,n){t.exports=n(246)},function(t,e,n){var i=n(249),r=n(252);function o(t,e){return!e||"object"!==i(e)&&"function"!=typeof e?r(t):e}t.exports=o},function(e,t,n){var i=n(253),r=n(138);function o(t){return e.exports=o=r?i:function(t){return t.__proto__||i(t)},o(t)}e.exports=o},function(t,e,n){"use strict";var i=n(1),r=n(0);r(e,"__esModule",{value:!0}),e.default=void 0;var o=i(n(2)),a=i(n(3)),s=i(n(12)),u=i(n(142)),l=function(){function r(t,e,n,i){(0,o.default)(this,r),this.Id=t,this.groupId=e,this._type=n,this.points=i,this.pointCount=i&&i.length?i.length:0,this._level=-1,this.inId=0,this._parent=null,this._child=null,this._brothers=[],this._linkAccessNodes=[],this._area=null,this.bb=new u.default,this.refreshBB()}return(0,a.default)(r,[{key:"contain",value:function(t){return s.default.pointInPolygon2d1(this.points,t,this.points.length-1)}},{key:"calcCrossPoint",value:function(t,e){for(var n={},i=0;i<this.pointCount;i++){var r=this.points[i],o=this.points[(i+1)%this.pointCount];if(1==s.default.calcCrossPoint(r,o,t,e,n))break}return n}},{key:"refreshBB",value:function(){this.bb.init();for(var t=0;t<this.pointCount;t++)this.bb.expandBy({x:this.points[t].x,y:this.points[t].y})}},{key:"pass",get:function(){return 3&this._type},set:function(t){this._type|=t}},{key:"level",set:function(t){this._level=31&t},get:function(){return 31&this._level}},{key:"area",get:function(){return this._area||(this._area=s.default.calcPolygonArea2d()),this._area}}]),r}(),d=l;e.default=d},function(t,e,n){"use strict";var i=n(1),r=n(0);r(e,"__esModule",{value:!0}),e.default=void 0,n(16);var o=i(n(2)),a=i(n(3)),s=function(){function t(){(0,o.default)(this,t),this.minX=Number.MAX_VALUE,this.minY=Number.MAX_VALUE,this.maxX=-Number.MAX_VALUE,this.maxY=-Number.MAX_VALUE}return(0,a.default)(t,[{key:"init",value:function(){this.minX=Number.MAX_VALUE,this.minY=Number.MAX_VALUE,this.maxX=-Number.MAX_VALUE,this.maxY=-Number.MAX_VALUE}},{key:"expandBy",value:function(t){t&&t.x&&t.y&&(this.minX>t.x&&(this.minX=t.x),this.maxX<t.x&&(this.maxX=t.x),this.minY>t.y&&(this.minY=t.y),this.maxY<t.y&&(this.maxY=t.y))}},{key:"isSeparate",value:function(t){return this.minX>t.maxX||this.minY>t.maxY||this.maxX<t.minX||this.maxY<t.minY}}]),t}(),u=s;e.default=u},function(t,e,n){n(89)("Int8",1,function(i){return function(t,e,n){return i(this,t,e,n)}})},function(t,e,n){"use strict";var i=n(1),r=n(0);r(e,"__esModule",{value:!0}),e.default=void 0;var o=i(n(2)),a=i(n(33)),s=function t(){(0,o.default)(this,t),this.cross=null,this.road=null,this.model=null,this.distance=0,this.toDistance=0,this.stickToRoad=!1,this.obstructType=a.default.NaviObstructType_MODEL},u=s;e.default=u},function(t,e,n){"use strict";var i=n(1),r=n(0);r(e,"__esModule",{value:!0}),e.default=void 0;var o=i(n(47));n(94);var a=i(n(2)),s=i(n(3)),u=function(){function t(){(0,a.default)(this,t)}return(0,s.default)(t,null,[{key:"toColor",value:function(t){if("number"==typeof t)return t;var e=t.split(",");return 3<=e.length?(0,o.default)(e[0])<<16|(0,o.default)(e[1])<<8|(0,o.default)(e[2]):(console.error("color format error",t),0)}},{key:"toRgba",value:function(t){if("number"==typeof t)return"rgba("+(0,o.default)(255*new fm.Color(t).r)+","+(0,o.default)(255*new fm.Color(t).g)+","+(0,o.default)(255*new fm.Color(t).b)+",1)";var e=t.split(",");return 3<=e.length?"rgba("+(0,o.default)(e[0])+","+(0,o.default)(e[1])+","+(0,o.default)(e[2])+",1)":t}},{key:"bindEvent",value:function(t,o,e,a){t.addEventListener(e,function(t){var e,n=t||window.event,i=n.target||n.srcElement,r=n.currentTarget;for(Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(t){for(var e=(this.document||this.ownerDocument).querySelectorAll(t),n=e.length;0<=--n&&e.item(n)!==this;);return-1<n});i!==r;)i.matches(o)&&(e=i,a.call(e,n)),i=i.parentNode})}},{key:"toSceneCoord",value:function(t,e){var n=0;return e.groupID&&(n=t.getFMGroup(e.groupID).height),new fm.Vector3(e.x-t.center.x,t.center.y+n,-e.y+t.center.y)}},{key:"removeFormArray",value:function(t,e){var n=t.indexOf(e);-1<n&&t.splice(n,1)}},{key:"scrollTopAnFun",value:function(){var _,v=!1;return function e(n){var i=n.el,r=n.to,t=n.form,o=(n.time,r<t?"up":"bottom"),a=t<r?r-t:r==t?0:t-r,s=10,u=a/s,l=0,d=function(t){var e=t.val,n=t.nbak,i=t.n,r=t.elTop;return"up"==o?r+(n-i)*e:r-(n-i)*e};function h(){_=0,window.setTimeout(function(){var t=Object(n,{to:i.scrollTop});v=!1,e(t)},s+1)}var f=function(){v=!1,_=!1,0==t&&(i.scrollTop=0)},c=function t(){var e;_--,_<=0?f():(e=function(){!1!==_&&(l=d({val:s,nbak:u,n:_,elTop:r,VDIRECTIONE:o}),l&&(i.scrollTop=l),t())},window.setTimeout(e,s))};function p(){v?h():(v=!0,_=u,c())}p()}}},{key:"toVector",value:function(t){return t.hasOwnProperty("z")?new fm.Vector3(t.x,t.y,t.z):new fm.Vector2(t.x,t.y)}},{key:"sleep",value:function(t){for(var e=(new Date).getTime(),n=0;n<1e7&&!((new Date).getTime()-e>t);n++);}}]),t}(),l=u;e.default=l},function(t,e,n){"use strict";var i=n(1),r=n(0);r(e,"__esModule",{value:!0}),e.default=void 0;var o=i(n(2)),a=i(n(3)),s=i(n(263)),c=function(){function e(t){(0,o.default)(this,e),this._wayPoints=t||[]}return(0,a.default)(e,[{key:"drop",value:function(t){for(var e=-1,n=0;n<this._wayPoints.length;n++)if(this[n]==t){e=n;break}e<0||this._wayPoints.splice(e,1)}},{key:"cloneDrop",value:function(t){for(var e=[],n=0;n<this._wayPoints.length;n++)e.push(this._wayPoints[n]);for(var i=-1,r=0;r<e.length;r++)if(e[r]==t){i=r;break}if(!(i<0))return e.splice(i,1),e}},{key:"toArray",value:function(){for(var t=[],e=0;e<this._wayPoints.length;e++)t.push(this._wayPoints[e]);return t}},{key:"len",value:function(){return this._wayPoints.length}}]),e}(),u=function(){function e(t){(0,o.default)(this,e),0!=t.length&&(this._adjTable=new s.default(t))}return(0,a.default)(e,[{key:"setSId",value:function(t){return this._sId=t,this}},{key:"setEId",value:function(t){return this._eId=t,this}},{key:"setWayNodes",value:function(t){return this._wayPoints=t,this}},{key:"route",value:function(){this._result=this._route(this._sId,this._eId,this._wayPoints)}},{key:"getResult",value:function(){return this._result}},{key:"_route",value:function(t,e,n){if(0==n.length){if(t==e)return{route:[t],dist:0};var i=this._adjTable.lookup(t,e);if(null!=i)return{route:[t,e],dist:i};var r=this._adjTable.enhance(t,e,this._wayPoints);return{route:[t,r.transit,e],dist:r.dist}}for(var o=new c(n),a=o.toArray(),s=1/0,u=[],l=0;l<o.len();l++){var d,h=a[l],f=this._route(t,h,o.cloneDrop(h));null!=f.dist&&(d=this._adjTable.lookup(h,e),null==d?(r=this._adjTable.enhance(h,e,this._wayPoints),d=r.dist,d+f.dist<s&&(s=d+f.dist,f.route.push(r.transit),f.route.push(e),u=f.route)):d+f.dist<s&&(s=d+f.dist,f.route.push(e),u=f.route))}return{route:u,dist:s}}}]),e}(),l=u;e.default=l},function(t,e,n){"use strict";var i=n(1),r=n(0);r(e,"__esModule",{value:!0}),e.SmallQueue=u,e.Queue=void 0;var o=i(n(2)),a=i(n(3)),s=function(){function t(){(0,o.default)(this,t),this.items=[]}return(0,a.default)(t,[{key:"enqueue",value:function(t){this.items.push(t)}},{key:"dequeue",value:function(){return this.isEmpty()?"Underflow":this.items.shift()}},{key:"front",value:function(){return this.isEmpty()?"No elements in Queue":this.items[0]}},{key:"isEmpty",value:function(){return 0==this.items.length}},{key:"printQueue",value:function(){for(var t="",e=0;e<this.items.length;e++)t+=this.items[e]+" ";return t}}]),t}();function u(){var e=[],n=0;this.getLength=function(){return e.length-n},this.isEmpty=function(){return 0==e.length},this.enqueue=function(t){e.push(t)},this.dequeue=function(){if(0!=e.length){var t=e[n];return 2*++n>=e.length&&(e=e.slice(n),n=0),t}},this.peek=function(){return 0<e.length?e[n]:void 0}}e.Queue=s},function(t,e,n){"use strict";var i=n(1),r=n(0);r(e,"__esModule",{value:!0}),e.Vector3=f,n(88);var o,a,s,u,l=i(n(15)),d=n(99),h=n(149);function f(t,e,n){this.x=t||0,this.y=e||0,this.z=n||0}(0,l.default)(f.prototype,{isVector3:!0,set:function(t,e,n){return this.x=t,this.y=e,this.z=n,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multiplyVectors:function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this},applyEuler:(u=new h.Quaternion,function(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(u.setFromEuler(t))}),applyAxisAngle:(s=new h.Quaternion,function(t,e){return this.applyQuaternion(s.setFromAxisAngle(t,e))}),applyMatrix3:function(t){var e=this.x,n=this.y,i=this.z,r=t.elements;return this.x=r[0]*e+r[3]*n+r[6]*i,this.y=r[1]*e+r[4]*n+r[7]*i,this.z=r[2]*e+r[5]*n+r[8]*i,this},applyMatrix4:function(t){var e=this.x,n=this.y,i=this.z,r=t.elements,o=1/(r[3]*e+r[7]*n+r[11]*i+r[15]);return this.x=(r[0]*e+r[4]*n+r[8]*i+r[12])*o,this.y=(r[1]*e+r[5]*n+r[9]*i+r[13])*o,this.z=(r[2]*e+r[6]*n+r[10]*i+r[14])*o,this},applyQuaternion:function(t){var e=this.x,n=this.y,i=this.z,r=t.x,o=t.y,a=t.z,s=t.w,u=s*e+o*i-a*n,l=s*n+a*e-r*i,d=s*i+r*n-o*e,h=-r*e-o*n-a*i;return this.x=u*s+h*-r+l*-a-d*-o,this.y=l*s+h*-o+d*-r-u*-a,this.z=d*s+h*-a+u*-o-l*-r,this},project:function(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)},unproject:function(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)},transformDirection:function(t){var e=this.x,n=this.y,i=this.z,r=t.elements;return this.x=r[0]*e+r[4]*n+r[8]*i,this.y=r[1]*e+r[5]*n+r[9]*i,this.z=r[2]*e+r[6]*n+r[10]*i,this.normalize()},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this},clampScalar:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this},clampLength:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},cross:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e)):this.crossVectors(this,t)},crossVectors:function(t,e){var n=t.x,i=t.y,r=t.z,o=e.x,a=e.y,s=e.z;return this.x=i*s-r*a,this.y=r*o-n*s,this.z=n*a-i*o,this},projectOnVector:function(t){var e=t.dot(this)/t.lengthSq();return this.copy(t).multiplyScalar(e)},projectOnPlane:(a=new f,function(t){return a.copy(this).projectOnVector(t),this.sub(a)}),reflect:(o=new f,function(t){return this.sub(o.copy(t).multiplyScalar(2*this.dot(t)))}),angleTo:function(t){var e=this.dot(t)/Math.sqrt(this.lengthSq()*t.lengthSq());return Math.acos(d._Math.clamp(e,-1,1))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,n=this.y-t.y,i=this.z-t.z;return e*e+n*n+i*i},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},setFromSpherical:function(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)},setFromSphericalCoords:function(t,e,n){var i=Math.sin(e)*t;return this.x=i*Math.sin(n),this.y=Math.cos(e)*t,this.z=i*Math.cos(n),this},setFromCylindrical:function(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)},setFromCylindricalCoords:function(t,e,n){return this.x=t*Math.sin(e),this.y=n,this.z=t*Math.cos(e),this},setFromMatrixPosition:function(t){var e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this},setFromMatrixScale:function(t){var e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),i=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=n,this.z=i,this},setFromMatrixColumn:function(t,e){return this.fromArray(t.elements,4*e)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t},fromBufferAttribute:function(t,e,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}})},function(t,e,n){"use strict";var i=n(1),r=n(0);r(e,"__esModule",{value:!0}),e.Quaternion=u;var o=i(n(267)),m=i(n(270)),a=i(n(15)),s=n(99);function u(t,e,n,i){this._x=t||0,this._y=e||0,this._z=n||0,this._w=void 0!==i?i:1}(0,a.default)(u,{slerp:function(t,e,n,i){return n.copy(t).slerp(e,i)},slerpFlat:function(t,e,n,i,r,o,a){var s,u,l,d,h,f,c,p,_=n[i+0],v=n[i+1],y=n[i+2],g=n[i+3],I=r[o+0],T=r[o+1],N=r[o+2],x=r[o+3];g===x&&_===I&&v===T&&y===N||(f=1-a,s=_*I+v*T+y*N+g*x,u=0<=s?1:-1,l=1-s*s,l>m.default&&(d=Math.sqrt(l),h=Math.atan2(d,s*u),f=Math.sin(f*h)/d,a=Math.sin(a*h)/d),c=a*u,_=_*f+I*c,v=v*f+T*c,y=y*f+N*c,g=g*f+x*c,f===1-a&&(p=1/Math.sqrt(_*_+v*v+y*y+g*g),_*=p,v*=p,y*=p,g*=p)),t[e]=_,t[e+1]=v,t[e+2]=y,t[e+3]=g}}),(0,o.default)(u.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},w:{get:function(){return this._w},set:function(t){this._w=t,this._onChangeCallback()}}}),(0,a.default)(u.prototype,{isQuaternion:!0,set:function(t,e,n,i){return this._x=t,this._y=e,this._z=n,this._w=i,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this},setFromEuler:function(t,e){if(!t||!t.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var n=t._x,i=t._y,r=t._z,o=t.order,a=Math.cos,s=Math.sin,u=a(n/2),l=a(i/2),d=a(r/2),h=s(n/2),f=s(i/2),c=s(r/2);return"XYZ"===o?(this._x=h*l*d+u*f*c,this._y=u*f*d-h*l*c,this._z=u*l*c+h*f*d,this._w=u*l*d-h*f*c):"YXZ"===o?(this._x=h*l*d+u*f*c,this._y=u*f*d-h*l*c,this._z=u*l*c-h*f*d,this._w=u*l*d+h*f*c):"ZXY"===o?(this._x=h*l*d-u*f*c,this._y=u*f*d+h*l*c,this._z=u*l*c+h*f*d,this._w=u*l*d-h*f*c):"ZYX"===o?(this._x=h*l*d-u*f*c,this._y=u*f*d+h*l*c,this._z=u*l*c-h*f*d,this._w=u*l*d+h*f*c):"YZX"===o?(this._x=h*l*d+u*f*c,this._y=u*f*d+h*l*c,this._z=u*l*c-h*f*d,this._w=u*l*d-h*f*c):"XZY"===o&&(this._x=h*l*d-u*f*c,this._y=u*f*d-h*l*c,this._z=u*l*c+h*f*d,this._w=u*l*d+h*f*c),!1!==e&&this._onChangeCallback(),this},setFromAxisAngle:function(t,e){var n=e/2,i=Math.sin(n);return this._x=t.x*i,this._y=t.y*i,this._z=t.z*i,this._w=Math.cos(n),this._onChangeCallback(),this},setFromRotationMatrix:function(t){var e,n=t.elements,i=n[0],r=n[4],o=n[8],a=n[1],s=n[5],u=n[9],l=n[2],d=n[6],h=n[10],f=i+s+h;return 0<f?(e=.5/Math.sqrt(f+1),this._w=.25/e,this._x=(d-u)*e,this._y=(o-l)*e,this._z=(a-r)*e):s<i&&h<i?(e=2*Math.sqrt(1+i-s-h),this._w=(d-u)/e,this._x=.25*e,this._y=(r+a)/e,this._z=(o+l)/e):h<s?(e=2*Math.sqrt(1+s-i-h),this._w=(o-l)/e,this._x=(r+a)/e,this._y=.25*e,this._z=(u+d)/e):(e=2*Math.sqrt(1+h-i-s),this._w=(a-r)/e,this._x=(o+l)/e,this._y=(u+d)/e,this._z=.25*e),this._onChangeCallback(),this},setFromUnitVectors:function(t,e){var n=1e-6,i=t.dot(e)+1;return i<n?(i=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0):(this._x=0,this._y=-t.z,this._z=t.y)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x),this._w=i,this.normalize()},angleTo:function(t){return 2*Math.acos(Math.abs(s._Math.clamp(this.dot(t),-1,1)))},rotateTowards:function(t,e){var n=this.angleTo(t);if(0===n)return this;var i=Math.min(1,e/n);return this.slerp(t,i),this},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(t,e){var n=t._x,i=t._y,r=t._z,o=t._w,a=e._x,s=e._y,u=e._z,l=e._w;return this._x=n*l+o*a+i*u-r*s,this._y=i*l+o*s+r*a-n*u,this._z=r*l+o*u+n*s-i*a,this._w=o*l-n*a-i*s-r*u,this._onChangeCallback(),this},slerp:function(t,e){if(0===e)return this;if(1===e)return this.copy(t);var n=this._x,i=this._y,r=this._z,o=this._w,a=o*t._w+n*t._x+i*t._y+r*t._z;if(a<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,a=-a):this.copy(t),1<=a)return this._w=o,this._x=n,this._y=i,this._z=r,this;var s=1-a*a;if(s<=m.default){var u=1-e;return this._w=u*o+e*this._w,this._x=u*n+e*this._x,this._y=u*i+e*this._y,this._z=u*r+e*this._z,this.normalize(),this._onChangeCallback(),this}var l=Math.sqrt(s),d=Math.atan2(l,a),h=Math.sin((1-e)*d)/l,f=Math.sin(e*d)/l;return this._w=o*h+this._w*f,this._x=n*h+this._x*f,this._y=i*h+this._y*f,this._z=r*h+this._z*f,this._onChangeCallback(),this},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,e){return void 0===e&&(e=0),this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t},_onChange:function(t){return this._onChangeCallback=t,this},_onChangeCallback:function(){}})},function(t,e,n){"use strict";var i=n(1),r=n(0);r(e,"__esModule",{value:!0}),e.default=void 0;var o,a=i(n(153)),s=i(n(154)),u=i(n(41)),l=i(n(66)),d=n(148),h=n(99),f=n(273),c=n(149),p=i(n(274)),_=window.fengmap||{},v={VERSION:a.default.VERSION,BUILD:a.default.BUILD,FMNaviAnalyser:s.default,FMNaviMode:u.default,FMNaviPriority:l.default};for(o in v)v.hasOwnProperty(o)&&(_[o]=v[o]);window.fengmap=_,window.DEBUG=!1,window.Geo=window.Geo||{Vector3:d.Vector3,_Math:h._Math,Matrix4:f.Matrix4,Quaternion:c.Quaternion,Centroid:p.default},window.Calculator=window.Geo;var y=_;e.default=y},function(t,e,n){n(152);var i=n(4).Object;t.exports=function(t,e,n){return i.defineProperty(t,e,n)}},function(t,e,n){var i=n(6);i(i.S+i.F*!n(14),"Object",{defineProperty:n(18).f})},function(t,e,n){"use strict";var i=n(0);i(e,"__esModule",{value:!0}),e.default=void 0;var r={VERSION:"2.7.1",BUILD:1166},o=r;e.default=o},function(t,e,n){"use strict";var i=n(1),r=n(0);r(e,"__esModule",{value:!0}),e.default=void 0;var o=i(n(102)),l=i(n(15)),a=i(n(29)),s=i(n(2)),u=i(n(3)),d=i(n(12)),h=n(199),f=i(n(200)),c=i(n(41)),p=i(n(66)),_=i(n(93)),v=i(n(48)),y=i(n(222));n(145);var g=function(){function e(t){(0,s.default)(this,e),this._options={},this._navi=null,this._naviResults=[],"function"==typeof h.FMMap&&t instanceof h.FMMap&&(this._map=null,this.init(t)),this._endDoor=null}return(0,u.default)(e,[{key:"routePassingPoints",value:function(t,e){var n=this._navi.routePassingPoints(t,e);n==v.default.ROUTE_SUCCESS?(this._naviResults=this._navi.getRouteResult(),this.failedInsertedPts=this._navi.failedInsertedPts):this._naviResults=[]}},{key:"analyzeNavi",value:function(t,e,n,i,r,o){var a=this._navi.route(t,e,n,i,r||c.default.MODULE_SHORTEST,o||p.default.PRIORITY_DEFAULT);return a==v.default.ROUTE_SUCCESS?(this._naviResults=this._navi.getRouteResult(),this._endDoor=this._navi._endDoor):this._naviResults=[],a}},{key:"init",value:function(t){this._map=t,this._navi=new y.default({}),this._navi.initByMap(t)}},{key:"initByOptions",value:function(t){this._navi=new y.default({}),this._navi.initByOptions(t)}},{key:"initByScene",value:function(t){this._navi=new y.default({}),this._navi.initByScene(t)}},{key:"dispose",value:function(){this._map=null;for(var t=0;t<this._naviResults.length;t++){var e=this._naviResults[t];e.dispose(),e=null}this._naviResults=[],this._navi&&(this._navi.dispose(),this._navi=null)}},{key:"getNaviResults",value:function(){return this._naviResults}},{key:"getNaviResult",value:function(){return this.getNaviResults()}},{key:"getRouteAllPoints",value:function(t){var e=t||this._naviResults;if(!this._isNaviResultsValide(e))return[];var n,i=[];for(n in e)e[n].getPointList&&i.push.apply(i,(0,a.default)(e[n].getPointList()));return i}},{key:"getRouteLineSegments",value:function(t){var e=t||this._naviResults;if(!this._isNaviResultsValide(e))return[];for(var n=[],i=0;i<e.length;i++){var r=e[i],o=r.groupId,a=r.pointList,s=new f.default;s.groupId=o,s.points=[];for(var u=0;u<a.length;u++)s.points.push((0,l.default)({},a[u]));n.push(s)}return n}},{key:"getRouteDistance",value:function(t){var e=t||this._naviResults;if(!this._isNaviResultsValide(e))return 0;var n=this.getRouteAllPoints(e);if(0==n.length)return 0;for(var i=0,r=0;r<n.length-1;r++)i+=d.default.distanceOfTwoPoints(n[r],n[r+1]);return i}},{key:"getRouteGroupIds",value:function(t){var e=t||this._naviResults;if(!this._isNaviResultsValide(e))return[];var n,i=[];for(n in e)!e[n].groupId||0!=n&&i[i.length-1]==e[n].groupId||i.push(e[n].groupId);return i}},{key:"getRouteGroupPoints",value:function(t,e){var n=e||this._naviResults;if(!this._isNaviResultsValide(n))return[];var i,r=[];for(i in n)n[i].groupId&&n[i].groupId==t&&(r=r.concat(n[i].getPointList()));return r}},{key:"pathConstraint",value:function(t){return this._navi?this._navi.pathConstraint(t):null}},{key:"_getNaviResults",value:function(t){for(var e,n=[],i=0;i<t.length;i++)null!=t[i].groupId&&(e=new _.default(t[i].groupId,t[i].length,t[i].pointVector,t[i].nodeVector),n.push(e));return n}},{key:"_isNaviResultsValide",value:function(t){if(!(0,o.default)(t))return!1;if(0==t.length)return!1;for(var e=0;e<t.length;e++)if(!t[e]instanceof _.default)return!1;return!0}},{key:"navi",get:function(){this._navi}},{key:"passPts",set:function(t){this._navi.passPts=t}},{key:"naviToDoor",set:function(t){this._navi.naviToDoor=t},get:function(){return this._navi.naviToDoor}},{key:"losedPoints",get:function(){return this._navi.failedInsertedPts}}]),e}(),I=g;e.default=I},function(t,e,n){n(156),t.exports=n(4).Array.isArray},function(t,e,n){var i=n(6);i(i.S,"Array",{isArray:n(103)})},function(t,e,n){n(158),t.exports=n(4).Object.assign},function(t,e,n){var i=n(6);i(i.S+i.F,"Object",{assign:n(159)})},function(t,e,n){"use strict";var h=n(14),f=n(51),c=n(76),p=n(55),_=n(44),v=n(105),r=Object.assign;t.exports=!r||n(20)(function(){var t={},e={},n=Symbol(),i="abcdefghijklmnopqrst";return t[n]=7,i.split("").forEach(function(t){e[t]=t}),7!=r({},t)[n]||Object.keys(r({},e)).join("")!=i})?function(t){for(var e=_(t),n=arguments.length,i=1,r=c.f,o=p.f;i<n;)for(var a,s=v(arguments[i++]),u=r?f(s).concat(r(s)):f(s),l=u.length,d=0;d<l;)a=u[d++],h&&!o.call(s,a)||(e[a]=s[a]);return e}:r},function(t,e,n){var u=n(35),l=n(106),d=n(161);t.exports=function(s){return function(t,e,n){var i,r=u(t),o=l(r.length),a=d(n,o);if(s&&e!=e){for(;a<o;)if(i=r[a++],i!=i)return!0}else for(;a<o;a++)if((s||a in r)&&r[a]===e)return s||a||0;return!s&&-1}}},function(t,e,n){var i=n(72),r=Math.max,o=Math.min;t.exports=function(t,e){return t=i(t),t<0?r(t+e,0):o(t,e)}},function(t,e,n){var i=n(102),r=n(107);function o(t){if(i(t))return r(t)}t.exports=o},function(t,e,n){var i=n(108),r=n(174),o=n(115);function a(t){if(void 0!==o&&r(Object(t)))return i(t)}t.exports=a},function(t,e,n){n(77),n(168),t.exports=n(4).Array.from},function(t,e,n){var u=n(72),l=n(52);t.exports=function(s){return function(t,e){var n,i,r=String(l(t)),o=u(e),a=r.length;return o<0||a<=o?s?"":void 0:(n=r.charCodeAt(o),n<55296||56319<n||o+1===a||(i=r.charCodeAt(o+1))<56320||57343<i?s?r.charAt(o):n:s?r.slice(o,o+2):i-56320+(n-55296<<10)+65536)}}},function(t,e,n){"use strict";var i=n(56),r=n(43),o=n(78),a={};n(34)(a,n(10)("iterator"),function(){return this}),t.exports=function(t,e,n){t.prototype=i(a,{next:r(1,n)}),o(t,e+" Iterator")}},function(t,e,n){var i=n(9).document;t.exports=i&&i.documentElement},function(t,e,n){"use strict";var p=n(68),i=n(6),_=n(44),v=n(169),y=n(170),g=n(106),I=n(171),T=n(172);i(i.S+i.F*!n(173)(function(t){Array.from(t)}),"Array",{from:function(t,e,n){var i,r,o,a,s=_(t),u="function"==typeof this?this:Array,l=arguments.length,d=1<l?e:void 0,h=void 0!==d,f=0,c=T(s);if(h&&(d=p(d,2<l?n:void 0,2)),null==c||u==Array&&y(c))for(i=g(s.length),r=new u(i);f<i;f++)I(r,f,h?d(s[f],f):s[f]);else for(a=c.call(s),r=new u;!(o=a.next()).done;f++)I(r,f,h?v(a,d,[o.value,f],!0):o.value);return r.length=f,r}})},function(t,e,n){var o=n(27);t.exports=function(e,t,n,i){try{return i?t(o(n)[0],n[1]):t(n)}catch(t){var r=e.return;throw void 0!==r&&o(r.call(e)),t}}},function(t,e,n){var i=n(36),r=n(10)("iterator"),o=Array.prototype;t.exports=function(t){return void 0!==t&&(i.Array===t||o[r]===t)}},function(t,e,n){"use strict";var i=n(18),r=n(43);t.exports=function(t,e,n){e in t?i.f(t,e,r(0,n)):t[e]=n}},function(t,e,n){var i=n(113),r=n(10)("iterator"),o=n(36);t.exports=n(4).getIteratorMethod=function(t){if(null!=t)return t[r]||t["@@iterator"]||o[i(t)]}},function(t,e,n){var o=n(10)("iterator"),a=!1;try{var i=[7][o]();i.return=function(){a=!0},Array.from(i,function(){throw 2})}catch(t){}t.exports=function(t,e){if(!e&&!a)return!1;var n=!1;try{var i=[7],r=i[o]();r.next=function(){return{done:n=!0}},i[o]=function(){return r},t(i)}catch(t){}return n}},function(t,e,n){t.exports=n(175)},function(t,e,n){n(114),n(77),t.exports=n(179)},function(t,e,n){"use strict";var i=n(177),r=n(178),o=n(36),a=n(35);t.exports=n(109)(Array,"Array",function(t,e){this._t=a(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,r(1)):r(0,"keys"==e?n:"values"==e?t[n]:[n,t[n]])},"values"),o.Arguments=o.Array,i("keys"),i("values"),i("entries")},function(t){t.exports=function(){}},function(t){t.exports=function(t,e){return{value:e,done:!!t}}},function(t,e,n){var i=n(113),r=n(10)("iterator"),o=n(36);t.exports=n(4).isIterable=function(t){var e=Object(t);return void 0!==e[r]||"@@iterator"in e||o.hasOwnProperty(i(e))}},function(t,e,n){n(181),n(185),n(186),n(187),t.exports=n(4).Symbol},function(t,e,n){"use strict";var i=n(9),a=n(28),r=n(14),o=n(6),s=n(110),u=n(182).KEY,l=n(20),d=n(74),h=n(78),f=n(54),c=n(10),p=n(79),_=n(80),v=n(183),y=n(103),g=n(27),I=n(19),T=n(44),N=n(35),x=n(70),m=n(43),R=n(56),E=n(184),M=n(117),k=n(76),P=n(18),L=n(51),A=M.f,O=P.f,S=E.f,b=i.Symbol,w=i.JSON,C=w&&w.stringify,D="prototype",F=c("_hidden"),z=c("toPrimitive"),V={}.propertyIsEnumerable,j=d("symbol-registry"),G=d("symbols"),U=d("op-symbols"),B=Object[D],Z="function"==typeof b&&!!k.f,H=i.QObject,Y=!H||!H[D]||!H[D].findChild,q=r&&l(function(){return 7!=R(O({},"a",{get:function(){return O(this,"a",{value:7}).a}})).a})?function(t,e,n){var i=A(B,e);i&&delete B[e],O(t,e,n),i&&t!==B&&O(B,e,i)}:O,X=function(t){var e=G[t]=R(b[D]);return e._k=t,e},W=Z&&"symbol"==typeof b.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof b},K=function(t,e,n){return t===B&&K(U,e,n),g(t),e=x(e,!0),g(n),a(G,e)?(n.enumerable?(a(t,F)&&t[F][e]&&(t[F][e]=!1),n=R(n,{enumerable:m(0,!1)})):(a(t,F)||O(t,F,m(1,{})),t[F][e]=!0),q(t,e,n)):O(t,e,n)},Q=function(t,e){g(t);for(var n,i=v(e=N(e)),r=0,o=i.length;r<o;)K(t,n=i[r++],e[n]);return t},J=function(t,e){return void 0===e?R(t):Q(R(t),e)},$=function(t){var e=V.call(this,t=x(t,!0));return!(this===B&&a(G,t)&&!a(U,t))&&(!(e||!a(this,t)||!a(G,t)||a(this,F)&&this[F][t])||e)},tt=function(t,e){if(t=N(t),e=x(e,!0),t!==B||!a(G,e)||a(U,e)){var n=A(t,e);return!n||!a(G,e)||a(t,F)&&t[F][e]||(n.enumerable=!0),n}},et=function(t){for(var e,n=S(N(t)),i=[],r=0;n.length>r;)a(G,e=n[r++])||e==F||e==u||i.push(e);return i},nt=function(t){for(var e,n=t===B,i=S(n?U:N(t)),r=[],o=0;i.length>o;)!a(G,e=i[o++])||n&&!a(B,e)||r.push(G[e]);return r};Z||(b=function(t){if(this instanceof b)throw TypeError("Symbol is not a constructor!");var e=f(0<arguments.length?t:void 0),n=function(t){this===B&&n.call(U,t),a(this,F)&&a(this[F],e)&&(this[F][e]=!1),q(this,e,m(1,t))};return r&&Y&&q(B,e,{configurable:!0,set:n}),X(e)},s(b[D],"toString",function(){return this._k}),M.f=tt,P.f=K,n(116).f=E.f=et,n(55).f=$,k.f=nt,r&&!n(53)&&s(B,"propertyIsEnumerable",$,!0),p.f=function(t){return X(c(t))}),o(o.G+o.W+o.F*!Z,{Symbol:b});for(var it="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),rt=0;it.length>rt;)c(it[rt++]);for(var ot=L(c.store),at=0;ot.length>at;)_(ot[at++]);o(o.S+o.F*!Z,"Symbol",{for:function(t){return a(j,t+="")?j[t]:j[t]=b(t)},keyFor:function(t){if(!W(t))throw TypeError(t+" is not a symbol!");for(var e in j)if(j[e]===t)return e},useSetter:function(){Y=!0},useSimple:function(){Y=!1}}),o(o.S+o.F*!Z,"Object",{create:J,defineProperty:K,defineProperties:Q,getOwnPropertyDescriptor:tt,getOwnPropertyNames:et,getOwnPropertySymbols:nt});var st=l(function(){k.f(1)});o(o.S+o.F*st,"Object",{getOwnPropertySymbols:function(t){return k.f(T(t))}}),w&&o(o.S+o.F*(!Z||l(function(){var t=b();return"[null]"!=C([t])||"{}"!=C({a:t})||"{}"!=C(Object(t))})),"JSON",{stringify:function(t){for(var e,n,i=[t],r=1;r<arguments.length;)i.push(arguments[r++]);if(n=e=i[1],(I(e)||void 0!==t)&&!W(t))return y(e)||(e=function(t,e){if("function"==typeof n&&(e=n.call(this,t,e)),!W(e))return e}),i[1]=e,C.apply(w,i)}}),b[D][z]||n(34)(b[D],z,b[D].valueOf),h(b,"Symbol"),h(Math,"Math",!0),h(i.JSON,"JSON",!0)},function(t,e,n){var i=n(54)("meta"),r=n(19),o=n(28),a=n(18).f,s=0,u=Object.isExtensible||function(){return!0},l=!n(20)(function(){return u(Object.preventExtensions({}))}),d=function(t){a(t,i,{value:{i:"O"+ ++s,w:{}}})},h=function(t,e){if(!r(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!o(t,i)){if(!u(t))return"F";if(!e)return"E";d(t)}return t[i].i},f=function(t,e){if(!o(t,i)){if(!u(t))return!0;if(!e)return!1;d(t)}return t[i].w},c=function(t){return l&&p.NEED&&u(t)&&!o(t,i)&&d(t),t},p=t.exports={KEY:i,NEED:!1,fastKey:h,getWeak:f,onFreeze:c}},function(t,e,n){var s=n(51),u=n(76),l=n(55);t.exports=function(t){var e=s(t),n=u.f;if(n)for(var i,r=n(t),o=l.f,a=0;r.length>a;)o.call(t,i=r[a++])&&e.push(i);return e}},function(t,e,n){var i=n(35),r=n(116).f,o={}.toString,a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],s=function(t){try{return r(t)}catch(t){return a.slice()}};t.exports.f=function(t){return a&&"[object Window]"==o.call(t)?s(t):r(i(t))}},function(){},function(t,e,n){n(80)("asyncIterator")},function(t,e,n){n(80)("observable")},function(t,e,n){var i=n(108),r=n(107);function o(t,e){if(t){if("string"==typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?i(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}}t.exports=o},function(t){function e(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}t.exports=e},function(t,e,n){t.exports=n(81)("native-function-to-string",Function.toString)},function(t,e,n){"use strict";var i=n(8);t.exports=function(t,e){return!!t&&i(function(){e?t.call(null,function(){},1):t.call(null)})}},function(t,e,n){var o=n(24),a=n(193).set;t.exports=function(t,e,n){var i,r=e.constructor;return r!==n&&"function"==typeof r&&(i=r.prototype)!==n.prototype&&o(i)&&a&&a(t,i),t}},function(t,e,r){var n=r(24),i=r(23),o=function(t,e){if(i(t),!n(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,n,i){try{i=r(61)(Function.call,r(83).f(Object.prototype,"__proto__").set,2),i(t,[]),n=!(t instanceof Array)}catch(t){n=!0}return function(t,e){return o(t,e),n?t.__proto__=e:i(t,e),t}}({},!1):void 0),check:o}},function(t,e){e.f={}.propertyIsEnumerable},function(t,e,n){var a=n(30),i=n(38),s=n(8),u=n(196),r="["+u+"]",l="​",o=RegExp("^"+r+r+"*"),d=RegExp(r+r+"*$"),h=function(t,e,n){var i={},r=s(function(){return!!u[t]()||l[t]()!=l}),o=i[t]=r?e(f):u[t];n&&(i[n]=o),a(a.P+a.F*r,"String",i)},f=h.trim=function(t,e){return t=String(i(t)),1&e&&(t=t.replace(o,"")),2&e&&(t=t.replace(d,"")),t};t.exports=h},function(t){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},function(t,e,n){var a=n(22),s=n(23),u=n(123);t.exports=n(11)?Object.defineProperties:function(t,e){s(t);for(var n,i=u(e),r=i.length,o=0;o<r;)a.f(t,n=i[o++],e[n]);return t}},function(t,e,n){var i=n(7).document;t.exports=i&&i.documentElement},function(t,e,n){"use strict";var i=n(0);i(e,"__esModule",{value:!0}),e.BoundingBox=e.FMMapCoord=e.NaviService=e.NaviDataType=e.FMLanguageType=e.FMLocationMarker=e.FMLineMarker=e.FMImageMarker=e.FMUtil=e.DataManager=e.EventDispatcher=e.FMRouteCalcuResult=e.FMNaviPriority=e.FMNaviMode=e.FMSegment=e.FMMap=e.Map=e.Graphics=void 0;var r={},o={};window.fengmap&&(o=window.fengmap,r=window.fengmap.inner||{});var a=r.Graphics||{};e.Graphics=a;var s=o.FMMap||{};e.FMMap=s;var u=o.Map||{};e.Map=u;var l=r.FMSegment||{};e.FMSegment=l;var d=r.FMNaviMode||{};e.FMNaviMode=d;var h=r.FMNaviPriority||{};e.FMNaviPriority=h;var f=r.FMRouteCalcuResult||{};e.FMRouteCalcuResult=f;var c=r.EventDispatcher||{};e.EventDispatcher=c;var p=r.DataManager||{};e.DataManager=p;var _=r.FMUtil||{};e.FMUtil=_;var v=r.FMImageMarker||{};e.FMImageMarker=v;var y=r.FMLineMarker||{};e.FMLineMarker=y;var g=r.FMLocationMarker||{};e.FMLocationMarker=g;var I=r.FMLanguageType||{};e.FMLanguageType=I;var T=r.NaviDataType||{};e.NaviDataType=T;var N=r.NaviService||{};e.NaviService=N;var x=r.FMMapCoord||{};e.FMMapCoord=x;var m=r.BoundingBox||{};e.BoundingBox=m},function(t,e,n){"use strict";var i=n(1),r=n(0);r(e,"__esModule",{value:!0}),e.default=void 0;var d=i(n(29)),o=i(n(2)),a=i(n(3)),u=i(n(201)),l=i(n(12)),s=function(){function e(t){(0,o.default)(this,e),this._points=t||null,this._groupId=0,this._lineDis=[],this._linePoints=null,this._screenPoints=[],this._screenDis=[],this._radiusPoint=[],this._radiuInit=!1,this._uvys=null,this._minRadius=1,this.needSmooth=!0}return(0,a.default)(e,[{key:"initSegement",value:function(t,e){"number"!=typeof e&&(e=this._minRadius),this._linePoints=this.pointsToLinePnts(t,e),this._uvys=this.computerUVY()}},{key:"pointsToRadius",value:function(t){for(var e,n,i,r,o=[],a=new u.default,s=0;s<this._points.length;s++)0<s&&s<this._points.length-1?(e=l.default.distanceOfTwoPoints(o[o.length-1],this._points[s]),n=l.default.distanceOfTwoPoints(this._points[s],this._points[s+1]),i=.5*(n<e?n:e),r=t,i<r&&(r=i),o.push.apply(o,(0,d.default)(a.computerArcLineByPoints(o[o.length-1],this._points[s],this._points[s+1],r||1,12)))):o.push(this._points[s]);this._radiusPoint=o,this._radiuInit=!0}},{key:"pointsToLinePnts",value:function(t,e){var n;this.needSmooth?this._radiuInit||this.pointsToRadius(e):(n=[],n.push.apply(n,(0,d.default)(this._points)),this._radiusPoint=n);for(var i=[],r=0;r<this._radiusPoint.length;r++){var o,a,s=this._radiusPoint[r].x-t.x,u=this._radiusPoint[r].z,l=-this._radiusPoint[r].y+t.y;i.push(s,u,l),0!==r&&(o=new fm.Vector3(this._radiusPoint[r].x,this._radiusPoint[r].y,this._radiusPoint[r].z),a=new fm.Vector3(this._radiusPoint[r-1].x,this._radiusPoint[r-1].y,this._radiusPoint[r-1].z),this._lineDis.push(o.distanceTo(a)))}return i}},{key:"getIndexDis",value:function(t){for(var e=0,n=0;n<this._lineDis.length;n++)n<t&&(e+=this._lineDis[n]);return e}},{key:"computerUVY",value:function(){for(var t,e=[],n=this.getIndexDis(this._lineDis.length),i=0;i<this._radiusPoint.length;i++)0===i?e.push(0):i===this._radiusPoint.length-1?e.push(1):(t=this.getIndexDis(i)/n,e.push(t),e.push(t));return e}},{key:"computeScreenCoord",value:function(t,e,n,i){for(var r=[],o=0,a=[],s=t.matrixWorldInverse,u=0;u<this._linePoints.length;u+=3){var l=this._linePoints[u],d=this._linePoints[u+1],h=this._linePoints[u+2],f=new fm.Vector3(l+i.x,d+i.y,h+i.z),c=f.applyMatrix4(s);c.z,t.near;var p,_=c.applyMatrix4(t.projectionMatrix),v=new fm.Vector2(e/2+e/2*_.x,n/2-n/2*_.y);r.push(v),2<u&&(p=v.distanceTo(r[Math.round(u/3)-1]),o+=p,a.push(p))}return this._screenPoints=r,this._screenDis=a,o}},{key:"_calcMinRadius",value:function(){if(this.points){this._minRadius=1;for(var t=0;t<this._points.length-1;t++){var e=this._points[t],n=this._points[t+1],i=.368*l.default.distanceOfTwoPoints(e,n);this._minRadius>i&&(this._minRadius=i)}}}},{key:"points",get:function(){return this._points},set:function(t){this._points=t}},{key:"groupId",get:function(){return this._groupId},set:function(t){this._groupId=t}},{key:"allLength",get:function(){return this.getIndexDis(this._lineDis.length)}},{key:"linePoints",get:function(){return this._linePoints}},{key:"uvys",get:function(){return this._uvys}}]),e}(),h=s;e.default=h},function(t,e,n){"use strict";var i=n(1),r=n(0);r(e,"__esModule",{value:!0}),e.default=void 0,n(88),n(203),n(216);var o=i(n(2)),a=i(n(3)),s=(i(n(217)),function(){function t(){(0,o.default)(this,t)}return(0,a.default)(t,[{key:"createGeometry",value:function(t,e,n,i){for(var r=new Float32Array((e+1)*n*3),o=new Float32Array((e+1)*n*2),a=new Uint16Array(e*n*2*3),s=0;s<e+1;s++)for(var u=s/e*t,l=4/Math.sqrt(2*Math.PI)*Math.exp(-u*u/2/i)/Math.sqrt(i),d=0;d<n;d++){var h=d/n*Math.PI*2,f=u*Math.sin(h),c=u*Math.cos(h),p=s*n*3+3*d;r[p]=c,r[p+1]=l,r[p+2]=f;var _,v,y,g,I,T=s*n*2+2*d;o[T]=d/n,o[T+1]=s/e,s<e&&(v=void 0,y=void 0,g=void 0,I=void 0,_=s*n*6+6*d,v=s*n+d,y=d+1===n?s*n:v+1,g=v+n,I=y+n,a[_]=v,a[_+1]=y,a[_+2]=g,a[_+3]=y,a[_+4]=I,a[_+5]=g)}return{index:a,uv:o,vertice:r}}},{key:"computerArcLineByPoints",value:function(t,e,n,i,r){var o=(new fm.Vector3).copy(t).distanceTo(e),a=(new fm.Vector3).copy(n).distanceTo(e),s=(new fm.Vector3).copy(t),u=(new fm.Vector3).copy(t),l=[];i<o&&(s=(new fm.Vector3).copy(e).add((new fm.Vector3).copy(t).sub(e).normalize().multiplyScalar(i)),l.push(s)),i<a&&(u=(new fm.Vector3).copy(e).add((new fm.Vector3).copy(n).sub(e).normalize().multiplyScalar(i)));for(var d=new fm.QuadraticBezierCurve3(s,e,u),h=0;h<r-1;h++){var f=(h+1)/r,c=d.getPoint(f);l.push(c)}return i<a&&l.push(u),l}}]),t}()),u=s;e.default=u},function(t,e,n){var i=n(30),r=n(8),a=n(38),s=/"/g,o=function(t,e,n,i){var r=String(a(t)),o="<"+e;return""!==n&&(o+=" "+n+'="'+String(i).replace(s,"&quot;")+'"'),o+">"+r+"</"+e+">"};t.exports=function(e,t){var n={};n[e]=t(o),i(i.P+i.F*r(function(){var t=""[e]('"');return t!==t.toLowerCase()||3<t.split('"').length}),"String",n)}},function(t,e,n){n(89)("Uint16",2,function(i){return function(t,e,n){return i(this,t,e,n)}})},function(t,e,n){"use strict";var i=n(7),r=n(11),o=n(60),a=n(124),s=n(13),u=n(125),l=n(8),d=n(126),h=n(39),f=n(26),c=n(127),p=n(84).f,_=n(22).f,v=n(128),y=n(90),g="ArrayBuffer",I="DataView",T="prototype",N="Wrong length!",x="Wrong index!",m=i[g],R=i[I],E=i.Math,M=i.RangeError,k=i.Infinity,P=m,L=E.abs,A=E.pow,O=E.floor,S=E.log,b=E.LN2,w="buffer",C="byteLength",D="byteOffset",F=r?"_b":w,z=r?"_l":C,V=r?"_o":D;function j(t,e,n){var i,r,o,a=new Array(n),s=8*n-e-1,u=(1<<s)-1,l=u>>1,d=23===e?A(2,-24)-A(2,-77):0,h=0,f=t<0||0===t&&1/t<0?1:0;for(t=L(t),t!=t||t===k?(r=t!=t?1:0,i=u):(i=O(S(t)/b),t*(o=A(2,-i))<1&&(i--,o*=2),t+=1<=i+l?d/o:d*A(2,1-l),2<=t*o&&(i++,o/=2),u<=i+l?(r=0,i=u):1<=i+l?(r=(t*o-1)*A(2,e),i+=l):(r=t*A(2,l-1)*A(2,e),i=0));8<=e;a[h++]=255&r,r/=256,e-=8);for(i=i<<e|r,s+=e;0<s;a[h++]=255&i,i/=256,s-=8);return a[--h]|=128*f,a}function G(t,e,n){var i,r=8*n-e-1,o=(1<<r)-1,a=o>>1,s=r-7,u=n-1,l=t[u--],d=127&l;for(l>>=7;0<s;d=256*d+t[u],u--,s-=8);for(i=d&(1<<-s)-1,d>>=-s,s+=e;0<s;i=256*i+t[u],u--,s-=8);if(0===d)d=1-a;else{if(d===o)return i?NaN:l?-k:k;i+=A(2,e),d-=a}return(l?-1:1)*i*A(2,d-e)}function U(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]}function B(t){return[255&t]}function Z(t){return[255&t,t>>8&255]}function H(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]}function Y(t){return j(t,52,8)}function q(t){return j(t,23,4)}function X(t,e,n){_(t[T],e,{get:function(){return this[n]}})}function W(t,e,n,i){var r=+n,o=c(r);if(o+e>t[z])throw M(x);var a=t[F]._b,s=o+t[V],u=a.slice(s,s+e);return i?u:u.reverse()}function K(t,e,n,i,r,o){var a=+n,s=c(a);if(s+e>t[z])throw M(x);for(var u=t[F]._b,l=s+t[V],d=i(+r),h=0;h<e;h++)u[l+h]=d[o?h:e-h-1]}if(a.ABV){if(!l(function(){m(1)})||!l(function(){new m(-1)})||l(function(){return new m,new m(1.5),new m(NaN),m.name!=g})){m=function(t){return d(this,m),new P(c(t))};for(var Q,J=m[T]=P[T],$=p(P),tt=0;$.length>tt;)(Q=$[tt++])in m||s(m,Q,P[Q]);o||(J.constructor=m)}var et=new R(new m(2)),nt=R[T].setInt8;et.setInt8(0,2147483648),et.setInt8(1,2147483649),!et.getInt8(0)&&et.getInt8(1)||u(R[T],{setInt8:function(t,e){nt.call(this,t,e<<24>>24)},setUint8:function(t,e){nt.call(this,t,e<<24>>24)}},!0)}else m=function(t){d(this,m,g);var e=c(t);this._b=v.call(new Array(e),0),this[z]=e},R=function(t,e,n){d(this,R,I),d(t,m,I);var i=t[z],r=h(e);if(r<0||i<r)throw M("Wrong offset!");if(n=void 0===n?i-r:f(n),i<r+n)throw M(N);this[F]=t,this[V]=r,this[z]=n},r&&(X(m,C,"_l"),X(R,w,"_b"),X(R,C,"_l"),X(R,D,"_o")),u(R[T],{getInt8:function(t){return W(this,1,t)[0]<<24>>24},getUint8:function(t){return W(this,1,t)[0]},getInt16:function(t,e){var n=W(this,2,t,e);return(n[1]<<8|n[0])<<16>>16},getUint16:function(t,e){var n=W(this,2,t,e);return n[1]<<8|n[0]},getInt32:function(t,e){return U(W(this,4,t,e))},getUint32:function(t,e){return U(W(this,4,t,e))>>>0},getFloat32:function(t,e){return G(W(this,4,t,e),23,4)},getFloat64:function(t,e){return G(W(this,8,t,e),52,8)},setInt8:function(t,e){K(this,1,t,B,e)},setUint8:function(t,e){K(this,1,t,B,e)},setInt16:function(t,e,n){K(this,2,t,Z,e,n)},setUint16:function(t,e,n){K(this,2,t,Z,e,n)},setInt32:function(t,e,n){K(this,4,t,H,e,n)},setUint32:function(t,e,n){K(this,4,t,H,e,n)},setFloat32:function(t,e,n){K(this,4,t,q,e,n)},setFloat64:function(t,e,n){K(this,8,t,Y,e,n)}});y(m,g),y(R,I),s(R[T],a.VIEW,!0),e[g]=m,e[I]=R},function(t,e,n){var i=n(40),r=n(5)("iterator"),o=Array.prototype;t.exports=function(t){return void 0!==t&&(i.Array===t||o[r]===t)}},function(t,e,n){var i=n(64),r=n(5)("iterator"),o=n(40);t.exports=n(57).getIteratorMethod=function(t){if(null!=t)return t[r]||t["@@iterator"]||o[i(t)]}},function(t,e,n){var i=n(208);t.exports=function(t,e){return new(i(t))(e)}},function(t,e,n){var i=n(24),r=n(209),o=n(5)("species");t.exports=function(t){var e;return r(t)&&(e=t.constructor,"function"!=typeof e||e!==Array&&!r(e.prototype)||(e=void 0),i(e)&&(e=e[o],null===e&&(e=void 0))),void 0===e?Array:e}},function(t,e,n){var i=n(46);t.exports=Array.isArray||function(t){return"Array"==i(t)}},function(t){t.exports=function(t,e){return{value:e,done:!!t}}},function(t,e,n){"use strict";var I=n(60),T=n(30),N=n(25),x=n(13),m=n(40),R=n(212),E=n(90),M=n(129),k=n(5)("iterator"),P=!([].keys&&"next"in[].keys()),L="@@iterator",A="keys",O="values",S=function(){return this};t.exports=function(t,e,n,i,r,o,a){R(n,e,i);var s,u,l,d=function(t){if(!P&&t in p)return p[t];switch(t){case A:case O:return function(){return new n(this,t)}}return function(){return new n(this,t)}},h=e+" Iterator",f=r==O,c=!1,p=t.prototype,_=p[k]||p[L]||r&&p[r],v=_||d(r),y=r?f?d("entries"):v:void 0,g="Array"==e&&p.entries||_;if(g&&(l=M(g.call(new t)),l!==Object.prototype&&l.next&&(E(l,h,!0),I||"function"==typeof l[k]||x(l,k,S))),f&&_&&_.name!==O&&(c=!0,v=function(){return _.call(this)}),I&&!a||!P&&!c&&p[k]||x(p,k,v),m[e]=v,m[h]=S,r)if(s={values:f?v:d(O),keys:o?v:d(A),entries:y},a)for(u in s)u in p||N(p,u,s[u]);else T(T.P+T.F*(P||c),e,s);return s}},function(t,e,n){"use strict";var i=n(87),r=n(59),o=n(90),a={};n(13)(a,n(5)("iterator"),function(){return this}),t.exports=function(t,e,n){t.prototype=i(a,{next:r(1,n)}),o(t,e+" Iterator")}},function(t,e,n){var o=n(5)("iterator"),a=!1;try{var i=[7][o]();i.return=function(){a=!0},Array.from(i,function(){throw 2})}catch(t){}t.exports=function(t,e){if(!e&&!a)return!1;var n=!1;try{var i=[7],r=i[o]();r.next=function(){return{done:n=!0}},i[o]=function(){return r},t(i)}catch(t){}return n}},function(t,e,n){"use strict";var i=n(7),r=n(22),o=n(11),a=n(5)("species");t.exports=function(t){var e=i[t];o&&e&&!e[a]&&r.f(e,a,{configurable:!0,get:function(){return this}})}},function(t,e,n){"use strict";var d=n(37),h=n(63),f=n(26);t.exports=[].copyWithin||function(t,e,n){var i=d(this),r=f(i.length),o=h(t,r),a=h(e,r),s=2<arguments.length?n:void 0,u=Math.min((void 0===s?r:h(s,r))-a,r-o),l=1;for(a<o&&o<a+u&&(l=-1,a+=u-1,o+=u-1);0<u--;)a in i?i[o]=i[a]:delete i[o],o+=l,a+=l;return i}},function(t,e,n){n(89)("Float32",4,function(i){return function(t,e,n){return i(this,t,e,n)}})},function(t,e,n){"use strict";var i=n(1),r=n(0);r(e,"__esModule",{value:!0}),e.default=void 0,n(65),n(17);var o,a,p,_,v,y,g,I,T,N,x,s=i(n(47)),u=(o=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22],a=[82,9,106,213,48,54,165,56,191,64,163,158,129,243,215,251,124,227,57,130,155,47,255,135,52,142,67,68,196,222,233,203,84,123,148,50,166,194,35,61,238,76,149,11,66,250,195,78,8,46,161,102,40,217,36,178,118,91,162,73,109,139,209,37,114,248,246,100,134,104,152,22,212,164,92,204,93,101,182,146,108,112,72,80,253,237,185,218,94,21,70,87,167,141,157,132,144,216,171,0,140,188,211,10,247,228,88,5,184,179,69,6,208,44,30,143,202,63,15,2,193,175,189,3,1,19,138,107,58,145,17,65,79,103,220,234,151,242,207,206,240,180,230,115,150,172,116,34,231,173,53,133,226,249,55,232,28,117,223,110,71,241,26,113,29,41,197,137,111,183,98,14,170,24,190,27,252,86,62,75,198,210,121,32,154,219,192,254,120,205,90,244,31,221,168,51,136,7,199,49,177,18,16,89,39,128,236,95,96,81,127,169,25,181,74,13,45,229,122,159,147,201,156,239,160,224,59,77,174,42,245,176,200,235,187,60,131,83,153,97,23,43,4,126,186,119,214,38,225,105,20,99,85,33,12,125],p=0,_=0,v=[2,0,0,0],y=function(t,e){for(var n=0,i=0,r=0,i=0;i<8;i++)1&e&&(n^=t),r=128&t,t<<=1,r&&(t^=27),e>>=1;return n},g=function(t,e,n){for(var i=0;i<4;i++)t[0+i]^=e[16*n+4*i],t[4+i]^=e[16*n+4*i+1],t[8+i]^=e[16*n+4*i+2],t[12+i]^=e[16*n+4*i+3]},I=function(t){for(var e,n,i,r=1;r<4;r++)for(n=0;n<r;){for(i=t[4*r+4-1],e=3;0<e;e--)t[4*r+e]=t[4*r+e-1];t[4*r+0]=i,n++}},T=function(t){for(var e,n,i,r=0;r<4;r++)for(e=0;e<4;e++)n=(240&t[4*r+e])>>4,i=15&t[4*r+e],t[4*r+e]=a[16*n+i]},N=function(t){for(var e=0;e<4;e++)t[e]=o[16*((240&t[e])>>4)+(15&t[e])]},x=function(t){return(0,s.default)(t,16)},{decryption:function(t,e){for(var n=Array(16),i=0;i<16;i++)n[i]=16*x(e.substr(2*i,1))+x(e.substr(2*i+1,1));for(var r=Array(16),i=0;i<16;i++)r[i]=16*x(t.substr(2*i,1))+x(t.substr(2*i+1,1));var o=Array(16);switch(i=[],n.length){default:case 16:p=4,_=10;break;case 24:p=6,_=12;break;case 32:p=8,_=14}for(var a=i=Array(16*(_+1)),s=Array(4),u=4*(_+1),l=0;l<p;l++)a[4*l+0]=n[4*l+0],a[4*l+1]=n[4*l+1],a[4*l+2]=n[4*l+2],a[4*l+3]=n[4*l+3];for(l=p;l<u;l++){if(s[0]=a[4*(l-1)+0],s[1]=a[4*(l-1)+1],s[2]=a[4*(l-1)+2],s[3]=a[4*(l-1)+3],0==l%p){for(var n=s,d=void 0,h=void 0,d=n[0],h=0;h<3;h++)n[h]=n[h+1];if(n[3]=d,N(s),n=l/p,1==n)v[0]=1;else if(1<n)for(v[0]=2,n--;0<n-1;)v[0]=y(v[0],2),n--;n=s,d=v,h=s,h[0]=n[0]^d[0],h[1]=n[1]^d[1],h[2]=n[2]^d[2],h[3]=n[3]^d[3]}else 6<p&&4==l%p&&N(s);a[4*l+0]=a[4*(l-p)+0]^s[0],a[4*l+1]=a[4*(l-p)+1]^s[1],a[4*l+2]=a[4*(l-p)+2]^s[2],a[4*l+3]=a[4*(l-p)+3]^s[3]}for(a=Array(16),s=0;s<4;s++)for(l=0;l<4;l++)a[4*s+l]=r[s+4*l];for(g(a,i,_),r=_-1;1<=r;r--)for(I(a),T(a),g(a,i,r),s=a,l=[14,9,13,11],u=h=void 0,n=Array(4),d=Array(4),u=0;u<4;u++){for(h=0;h<4;h++)n[h]=s[4*h+u];var h=l,f=n,c=d;for(c[0]=y(h[0],f[0])^y(h[3],f[1])^y(h[2],f[2])^y(h[1],f[3]),c[1]=y(h[1],f[0])^y(h[0],f[1])^y(h[3],f[2])^y(h[2],f[3]),c[2]=y(h[2],f[0])^y(h[1],f[1])^y(h[0],f[2])^y(h[3],f[3]),c[3]=y(h[3],f[0])^y(h[2],f[1])^y(h[1],f[2])^y(h[0],f[3]),h=0;h<4;h++)s[4*h+u]=d[h]}for(I(a),T(a),g(a,i,0),s=0;s<4;s++)for(l=0;l<4;l++)o[s+4*l]=a[4*s+l];for(r="",i=0;i<16;++i)a=o[i].toString(16),a.length<2&&(a="0"+a),r+=a;return r}}),l=u;e.default=l},function(t,e,n){n(11)&&"g"!=/./g.flags&&n(22).f(RegExp.prototype,"flags",{configurable:!0,get:n(91)})},function(t,e,n){n(220),t.exports=n(4).parseInt},function(t,e,n){var i=n(6),r=n(221);i(i.G+i.F*(parseInt!=r),{parseInt:r})},function(t,e,n){var i=n(9).parseInt,r=n(133).trim,o=n(92),a=/^[-+]?0[xX]/;t.exports=8!==i(o+"08")||22!==i(o+"0x16")?function(t,e){var n=r(String(t),3);return i(n,e>>>0||(a.test(n)?16:10))}:i},function(t,e,n){"use strict";var i=n(1),r=n(0);r(e,"__esModule",{value:!0}),e.default=void 0,n(67),n(88);var l=i(n(15));n(16);var x=i(n(29)),a=i(n(47));n(21);var o=i(n(2)),s=i(n(3)),I=i(n(12)),u=i(n(41)),m=i(n(66)),M=i(n(48)),T=i(n(93)),d=i(n(223)),h=i(n(224)),v=i(n(49)),R=i(n(33)),N=i(n(42)),f=i(n(237)),c=i(n(96)),p=i(n(141)),_=i(n(257)),y=i(n(97)),g=i(n(258)),E=i(n(98)),k=i(n(259)),P=i(n(145)),L=i(n(261)),A=i(n(265)),O=function(){function e(t){(0,o.default)(this,e),this._options=new d.default(t),this._naviService=new h.default(this._options),this._startPoint=null,this._startGroupId=null,this._endPoint=null,this._endGroupId=null,this._startZone=null,this._mode=u.default.MODULE_SHORTEST,this._priority=m.default.PRIORITY_DEFAULT,this._graphs=new v.default,this._outlineAnalyseDijkstra=null,this._multiFloorDijkstraMap=new v.default,this._groupLiftNodes=new v.default,this._extentNodes=[],this._extentRoads=[],this._predictExtentNodes=[],this._predictLiftNodes=[],this._result=[],this._weightBias=1,this._liftLessWeightGain=1,this._liftWeightGain=1,this._liftGreaterWightGain=1,this._escalatorGreaterWightGain=1,this._escalatorWeightGain=1,this._escalatorLessWightGain=1,this._stairGreaterWeightGain=1,this._stairWeightGain=1,this._stairLessWeightGain=1,this._scene=null,this._eDijKCollection=null,this._naviToDoor=!1,this._startModel=null,this._endModel=null,this._endDoor=null,this._assignedInfos=[]}return(0,s.default)(e,[{key:"initByMap",value:function(t){var e,n;t&&t._currentSceneId&&t.dataManager&&(e=t.dataManager._sceneDecodeData[t._currentSceneId],e&&(this._naviService.setScene(e),this._scene=e,n=e.floors,0!=n.length&&(this._initNaviGraphs(n),this._initDijkstras(),this._eDijKCollection=new L.default,this._eDijKCollection.loadGraphs(this._graphs))))}},{key:"initByOptions",value:function(){}},{key:"initByScene",value:function(t){var e;t&&(this._scene=t,this._naviService.setScene(t),e=t.floors,0!=e.length&&(this._initNaviGraphs(e),this._initDijkstras()))}},{key:"initByNaviGraphs",value:function(t){t&&(this._initNaviGraphs(t),this._initDijkstras())}},{key:"dispose",value:function(){this._options=null,this._naviService=null,this._graphs.each(function(t,e){e.dispose()}),this._graphs.clear(),this._graphs=null,this._outlineAnalyseDijkstra.dispose(),this._outlineAnalyseDijkstra=null,this._multiFloorDijkstraMap.each(function(t,e){e.dispose()}),this._multiFloorDijkstraMap.clear(),this._multiFloorDijkstraMap=null,this._groupLiftNodes.clear(),this._groupLiftNodes=null,this._extentNodes=null,this._extentRoads=null,this._predictExtentNodes=null,this._predictLiftNodes=null,this._result=null}},{key:"routePassingPoints",value:function(t,e){return this.naviAdapter=new A.default(t,e,this._passPts,this._eDijKCollection),this.naviAdapter.executeCalculation(),this._result=this.naviAdapter.routes,this._failedInsertedPts=this.naviAdapter.failInsertedPts,M.default.ROUTE_SUCCESS}},{key:"calc_outlines_dist",value:function(t){for(var e=0,n=0;n<t.length-1;n++)e+=Math.abs(t[n].groupId-t[n+1].groupId);return{dist:e,seq:t}}},{key:"calc_sort_outlines_dist",value:function(t){for(var e=[],n=0;n<t.length;n++)e.push(this.calc_outlines_dist(t[n]));return e.sort(function(t,e){return t.dist-e.dist}),e}},{key:"routeAssigned",value:function(){for(var t in this._assignedInfos){var e=(0,a.default)(t),n=this._multiFloorDijkstraMap.get(e);n.assignedPts=this._assignedInfos[e],n.routeAssigned(),this._result.push({groupId:e,result:n.getRouteCalculateResult()})}}},{key:"route",value:function(t,y,e,g,I,n){var T=this;this.reset();var i=this._multiFloorDijkstraMap.get(t);if(!i)return M.default.ROUTE_FAILED_NO_DATA_START;var r=i._calcPointReachable(y);if(!r)return M.default.ROUTE_FAILED_NO_DATA_START;this._startModel=r.model;var o=this._multiFloorDijkstraMap.get(e);if(!o)return M.default.ROUTE_FAILED_NO_DATA_END;var a=o._calcPointReachable(g);if(!a)return M.default.ROUTE_FAILED_NO_DATA_END;this._endModel=a.model,this._result=[],this._startGroupId=t,this._startPoint=y,this._endGroupId=e,this._endPoint=g;var s=r.extentId,u=a.extentId,N=r.model,x=a.model;if(0==s||0==u)return M.default.ROUTE_FAILED_CANNOT_ARRIVE;var m=null;this._mode=I,this._switchToPriority(n);var l=function(){T._result=[];for(var t=[],e=[T._startPoint],n=0;n<T._predictExtentNodes.length-1;n++){var i=[],r=[];if(!T._calcPredictLiftNodes(T._predictExtentNodes[n],T._predictExtentNodes[n+1],e[e.length-1],i,r))return M.default.ROUTE_FAILED_CANNOT_ARRIVE;for(var o=!1,a=0;a<i.length;a++){var s,u,l=i[a]._wrappedNode,d=r[a]._wrappedNode,h=i[a].groupId,f=r[a].groupId;if(m=0==n?(s=T._multiFloorDijkstraMap.get(h),s._startModel=N,s.routeCalculate(y,l,I)):(u=T._multiFloorDijkstraMap.get(h),u.routeCalculate(t[t.length-1],l,I)),M.default.ROUTE_SUCCESS==m){var c=T._multiFloorDijkstraMap.get(h),p=c.getRouteCalculateResult();if(T._result.push({groupId:h,result:p}),t.push(d),e.push(d.point),o=!0,T._predictExtentNodes.length-2==n){var _=T._multiFloorDijkstraMap.get(f);if(_._endModel=x,m=_.routeCalculate(d,g,I),M.default.ROUTE_SUCCESS!=m){T._result.splice(T._result.length-1,1),o=!1,e.splice(e.length-1,1),t.splice(t.length-1,1);continue}var v=_.getRouteCalculateResult();T._result.push({groupId:f,result:v})}if(M.default.ROUTE_SUCCESS==m)break}}if(!o)return M.default.ROUTE_FAILED_CANNOT_ARRIVE}return M.default.ROUTE_SUCCESS};if(t==e&&s==u){var d=this._multiFloorDijkstraMap.get(t);if(d._startModel=N,d._endModel=x,m=d.routeCalculate(y,g,I),m!=M.default.ROUTE_SUCCESS){for(var h=[],f=0;f<this._extentNodes.length;f++)this._extentNodes[f].groupId==t&&this._extentNodes[f].extentId==s&&h.push(this._extentNodes[f]);var c=this._enlarge_connected_nodes_num(h,h[0],1);if(0==c.length)return M.default.ROUTE_FAILED_OUTLINE;for(var p=this.calc_sort_outlines_dist(c),f=0;f<p.length;f++){this._predictExtentNodes=p[f].seq;var _=l();if(_==M.default.ROUTE_SUCCESS)return _}return M.default.ROUTE_FAILED_CANNOT_ARRIVE}var v=d.getRouteCalculateResult();this._result.push({groupId:t,result:v})}else{var R=this._calcPredictExtentNodes(t,s,e,u);if(R!=M.default.ROUTE_SUCCESS)return M.default.ROUTE_FAILED_OUTLINE;this._predictExtentNodes.reverse();var E=l();if(M.default.ROUTE_SUCCESS!=R)return E}return M.default.ROUTE_SUCCESS}},{key:"getRouteResult",value:function(){if(this._naviToDoor&&(this._endDoor=null,this._endModel&&0<this._result.length)){for(var t,e=this._result[this._result.length-1],n=e.result,i={x:-1,y:-1},r=n.length-1;0<r;r--){var o=n[r],a=n[r-1];if(I.default.segCrossPolygon(o.point,a.point,this._endModel.points,i)){t=r;break}}n.splice(t);var s=new N.default;s.Id=-1,s.point=i,n.push(s),this._endDoor=i}for(var u=[],l=0;l<this._result.length;l++){this._simplifyRouteResult(this._result[l]);for(var d=this._result[l],h=d.groupId,f=d.result,c=[],p=0,_=0;_<f.length;_++)c.push(f[_].point),_!=f.length-1&&(p+=I.default.distanceOfTwoPoints(f[_].point,f[_+1].point));var v,y,g=new T.default;g._groupId=h,g._nodeList=f,g._pointList=c,g._length=p,u.push(g),l!=this._result.length-1&&(v=this._getBeginTransitionRoute(this._result[l]),y=this._getEndTransitionRoute(this._result[l+1]),u.push(v),u.push(y))}return u}},{key:"setBannedPoltyons",value:function(t){for(var e in t){var n=(0,a.default)(e),i=this._multiFloorDijkstraMap.get(n);i.setBannedPoltyons(t[e])}}},{key:"clearBannedAreas",value:function(){this._multiFloorDijkstraMap.each(function(t,e,n){n.clearBannedArea()})}},{key:"refreshBannedArea",value:function(){this._multiFloorDijkstraMap.each(function(t,e){e._zoneIdSimpleDijkstraMap.get(-1).refreshAdjList()})}},{key:"_simplifyRouteResult",value:function(t){if(t&&t.result){var e=t.result,n=e.length;if(n&&!(n<2)){var i=[];i.push(e[0]);var r=e[0],o=e[n-1];I.default.distanceOfTwoPoints(r.point,o.point),I.default.epsilon();for(var a=1;a<n-1;a++){var s=e[a];null!=r&&I.default.distanceOfTwoPoints(r.point,s.point)<I.default.epsilon()||null!=o&&I.default.distanceOfTwoPoints(o.point,s.point)<I.default.epsilon()||i.push(s)}i.push(o),n=i.length;for(var u=new Array(n),l=0;l<n;l++)u[l]=0;for(var d=1;d<n-1;d++){for(var h=i[d],f=d-1;0!=u[f];)f--;var c=i[f],p=i[d+1];I.default.isPointOnSegment(h.point,c.point,p.point)&&(u[d]=1)}for(var _=[],v=0;v<n;v++)0==u[v]&&_.push(i[v]);t.result=_}}}},{key:"resetBanned",value:function(){this._multiFloorDijkstraMap.each(function(t,e){e.resetBanned()})}},{key:"reset",value:function(){this._predictExtentNodes=[],this._predictLiftNodes=[],this._multiFloorDijkstraMap.each(function(t,e){e.reset()})}},{key:"pathConstraint",value:function(n){var i=this;if(this._multiFloorDijkstraMap.size()<=0)return null;var t=this._multiFloorDijkstraMap.get(n.groupID);if(!t)return null;var e=t._naviGraph;if(!e)return null;var r=[];r.push.apply(r,(0,x.default)(e.roadVector)),t._zoneIdGraph.each(function(t,e){r.push.apply(r,(0,x.default)(e.roadVector))});var o={},a=e.queryContainExtentId(n),s={distance:Number.MAX_VALUE,road:null,coord:{groupID:n.groupID}},u=null;return r.length&&(r.forEach(function(t){var e;t.roadEntry!=R.default.NaviRoadEntry_FORBID&&a==t.extentId&&(e=I.default.pointDistanceToLine(n,t.startPoint,t.endPoint,o),e<s.distance&&(s.distance=e,s.road=t,s.angle=i._getRouteAngle(t.startPoint,t.endPoint),(0,l.default)(s.coord,o)))}),u=s),u}},{key:"_getRouteAngle",value:function(t,e){var n=new Geo.Vector3(0,0,1),i=new Geo.Vector3(t.x,0,t.y),r=new Geo.Vector3(e.x,0,e.y),o=r.clone().sub(i).normalize(),a=o.angleTo(n)*Geo._Math.RAD2DEG,s=0<o.clone().cross(n).y;return s?360-a:a}},{key:"_initNaviGraphs",value:function(t){for(var e in this._graphs=new v.default,t){var n=t[e].gid;if(null!=n){var i=t[e].geo[0],r=t[e].biz[0],o=t[e].navi[0],a=this._naviService.convertToGroup(n,i,r,o),s=new v.default,u=this._initNaviNodes(a,s),l=this._initNaviRoads(a),d=this._initNaviZones(a),h=this._initNaviObstructExtents(a),f=this._initNaviObstructModels(a);this._processNaviObstructModels(f,u,o,s);var c=new y.default(u,l,!0,1);c.groupId=n,0!=h.length&&(c.obstructExtents=h),0!=d.length&&(c.zones=d),0!=f.length&&(c.obstructModels=f);for(var p=0;p<l.length;p++)l[p].extentId=c.queryContainExtentId(l[p].startPoint);this._graphs.put(a.gid,c)}}}},{key:"_initNaviNodes",value:function(i,r){var t,o=[],e=function(t){var e=i.naviNodes[t];if(null==e.nodeId)return"continue";var n=new N.default;n.Id=e.nodeId,n.point=e.geoArr,n.nodeType=e.nodeType,n.liftType=e.liftType,n.liftFlag=e.liftFlag,n.liftEntry=e.liftEntry,e.linkSegArr.forEach(function(t){n.segLinks.push((0,a.default)(t))}),e.liftFloorArr.forEach(function(t){n.liftFloors.push((0,a.default)(t))}),o.push(n),r.put(e.nodeId,t)};for(t in i.naviNodes)e(t);return o}},{key:"_initNaviRoads",value:function(t){var e,n=[];for(e in t.naviSegments){var i,r=t.naviSegments[e],o=r.geoArr;o&&(i=new c.default,i.Id=r.segmentId,i.startId=r.snode,i.startPoint=o[0],i.endId=r.enode,i.endPoint=o[1],i.length=r.length,i.roadEntry=r.entry,i.roadRank=r.rank,n.push(i))}return n}},{key:"_initNaviObstructExtents",value:function(t){for(var e=[],n=0,i=t.extentLayer.length;n<i;n++){var r=t.extentLayer[n],o=r.geoArr,o=o||[],a=new _.default(r.eid,t.gid,0,o,r.center,r.holes);a.fid=r.fid,e.push(a)}return e}},{key:"_initNaviObstructModels",value:function(t){for(var e=[],n=0,i=t.modelLayer.length;n<i;n++){var r=t.modelLayer[n],o=r.geoArr,o=o||[],a=new _.default(r.eid,t.gid,0,o,r.center,r.holes);a.fid=r.fid,a.pass=r.pass,e.push(a)}return e}},{key:"_initNaviZones",value:function(t){for(var e=[],n=0,i=t.naviZones.length;n<i;n++){var r=t.naviZones[n],o=new p.default(r.id,t.gid,r.type,r.geoArr);e.push(o)}return e}},{key:"_processNaviObstructModels",value:function(t,e,n,i){for(var r=new v.default,o=0;o<t.length;o++){var a=t[o];r.put(a.Id,o)}for(var s=0;s<n.naviModels.length;s++)for(var u=n.naviModels[s],l=u.id,d=t[r.get(l)],h=0;h<u.doorids.length;h++){var f=u.doorids[h],c=e[i.get(f)];d.doors.push(c);var p=u.nodetypes[h],_=u.entrytypes[h];d.doorTypes.push(p),d.doorEntrys.push(_)}}},{key:"_processLiftFloors",value:function(){var a;this._graphs.size()<=0||(a={},this._graphs.each(function(t,e){var n,i=[];for(n in e.queryLiftNodesByType(R.default.NaviLiftType_Escalator,i),i){var r,o=i[n];o.liftFlag&&(r=o.liftFlag,a[r]?a[r]=a[r].concat(o.liftFloors):a[r]=o.liftFloors)}}),this._graphs.each(function(t,e){var n,i=[];for(n in e.queryLiftNodesByType(R.default.NaviLiftType_Escalator,i),i){var r,o=i[n];o.liftFlag&&(r=o.liftFlag,a[r]&&(o.liftFloors=a[r]))}}))}},{key:"_initDijkstras",value:function(){var t,n=this;!this._graphs||!this._graphs instanceof v.default||(this._initExtentNodes(),this._initExtentRoads(),t=new y.default(this._extentNodes,this._extentRoads),this._outlineAnalyzeDijkstra=new E.default(t),this._graphs.each(function(t,e){n._multiFloorDijkstraMap.put(t,new k.default(e))}))}},{key:"_initExtentNodes",value:function(){var d=this;this._extentNodes=[];var h=0;this._graphs.each(function(t,e){for(var n=e.obstructExtents,i=0;i<n.length;i++){var r=n[i],o=new g.default;o.Id=h++,o.groupId=t,o.extentId=r.Id,o.extent=r;for(var a=0;a<e.nodeVector.length;a++){var s,u,l=e.nodeVector[a];l.liftType!=R.default.NaviLiftType_NULL&&I.default.pointInPolygon2d(r.points,l.point,r.pointCount)&&(s=new f.default,u=e.queryZoneByPoint(l.point),s.zone=u,s.setNode(l),s.groupId=t,s._wrappedNode=l,s._liftType=l.liftType,o.liftNodes.push(s))}d._extentNodes.push(o)}})}},{key:"_initExtentRoads",value:function(){this._extentRoads=[];for(var t=0;t<this._extentNodes.length;t++)for(var e=this._extentNodes[t],n=0;n<this._extentNodes.length;n++){var i,r,o=this._extentNodes[n];t!=n&&(i=this._checkConnection(e,o),null!=i&&(r=new c.default,r.startId=e.Id,r.endId=o.Id,r.entryType=R.default.NaviRoadEntry_FORWARD,r.length=i,this._extentRoads.push(r)))}}},{key:"_checkConnection",value:function(t,e){for(var n=Number.MAX_VALUE,i=!1,r=(t.groupId,e.groupId),o=0;o<t.liftNodes.length;o++){var a=t.liftNodes[o],s=a.liftType;if(m.default.PRIORITY_LIFTONLY==this._priority){if(R.default.NaviLiftType_Lift!=s)continue}else if(m.default.PRIORITY_ESCALATORONLY==this._priority){if(R.default.NaviLiftType_Escalator!=s)continue}else if(m.default.PRIORITY_STAIRONLY==this._priority){if(R.default.NaviLiftType_Stair!=s)continue}else if(m.default.PRIORITY_ACCESSIBLEONLY==this._priority&&R.default.NaviLiftType_Accessible!=s)continue;if(s==R.default.NaviLiftType_Stair||-1!=a.liftFloors.indexOf(r))for(var u=0;u<e.liftNodes.length;u++){var l=e.liftNodes[u];if(null!=l&&a.liftFlag==l.liftFlag)if(m.default.PRIORITY_LIFTFIRST==this._priority||m.default.PRIORITY_DEFAULT==this._priority){if(R.default.NaviLiftType_Lift==s||R.default.NaviLiftType_Accessible==s){var d=this._liftLessWeightGain;return d}if(R.default.NaviLiftType_Escalator==s){var h=this._escalatorWeightGain;h<n&&(n=h),i=!0;break}if(R.default.NaviLiftType_Stair==s){var f=this._stairGreaterWeightGain;f<n&&(n=f),i=!0;break}}else if(m.default.PRIORITY_ESCALATORFIRST==this._priority){if(R.default.NaviLiftType_Lift==s||R.default.NaviLiftType_Accessible==s){var c=this._liftWeightGain;c<n&&(n=c),i=!0;break}if(R.default.NaviLiftType_Escalator==s){var p=this._escalatorLessWightGain;return p}if(R.default.NaviLiftType_Stair==s){var _=this._stairGreaterWeightGain;_<n&&(n=_),i=!0;break}}else if(m.default.PRIORITY_STAIRFIRST==this._priority){if(R.default.NaviLiftType_Lift==s){var v=this._liftWeightGain;v<n&&(n=v),i=!0;break}if(R.default.NaviLiftType_Escalator==s||R.default.NaviLiftType_Accessible==s){var y=this._escalatorGreaterWeightGain;y<n&&(n=y),i=!0;break}if(R.default.NaviLiftType_Stair==s){var g=this._stairLessWeightGain;return g}}else{if(m.default.PRIORITY_LIFTFIRST1==this._priority||m.default.PRIORITY_STAIRFIRST1==this._priority||m.default.PRIORITY_ESCALATORFIRST1==this._priority)return this._weightBias;if(m.default.PRIORITY_LIFTONLY==this._priority||m.default.PRIORITY_ESCALATORONLY==this._priority||m.default.PRIORITY_STAIRONLY==this._priority||m.default.PRIORITY_ACCESSIBLEONLY==this._priority)return this._weightBias}}}return i?n:null}},{key:"_getLiftNode",value:function(t,e){for(var n=0;n<e.length;n++)if(e[n].liftFlag==t)return e[n];return null}},{key:"_switchToPriority",value:function(t){var e;this._priority==t&&this._outlineAnalyseDijkstra||(this._priority=t,this._initExtentRoads(),e=new y.default(this._extentNodes,this._extentRoads),this._outlineAnalyseDijkstra=new E.default(e))}},{key:"_getEndTransitionRoute",value:function(t){var e=t.result,n=new T.default;return n._groupId=t.groupId,n._nodeList.push(e[0]),n._pointList.push(e[0].point),n._length=0,n}},{key:"_getBeginTransitionRoute",value:function(t){var e=t.result,n=new T.default;return n._groupId=t.groupId,n._nodeList.push(e[e.length-1]),n._pointList.push(e[e.length-1].point),n._length=0,n}},{key:"_getExtentNode",value:function(t,e){for(var n=0;n<this._extentNodes.length;n++)if(this._extentNodes[n].groupId==t&&this._extentNodes[n].extentId==e)return this._extentNodes[n];return null}},{key:"_calcPredictExtentNodes",value:function(t,e,n,i){var r=this._getExtentNode(t,e),o=this._getExtentNode(n,i),a=this._outlineAnalyseDijkstra.routeCalculate(r,o);if(a!=M.default.ROUTE_SUCCESS)return a;var s=this._outlineAnalyseDijkstra.getRouteCalculateResult();this._predictExtentNodes=[];for(var u=0;u<s.length;u++)this._predictExtentNodes.push(s[u]);return a}},{key:"_compareLiftFirstFunc",value:function(t,e){return t.liftType==R.default.NaviLiftType_Lift&&e.liftType==R.default.NaviLiftType_Lift?t._dist-e._dist:t.liftType==R.default.NaviLiftType_Lift?-1:e.liftType==R.default.NaviLiftType_Lift?1:t._dist-e._dist}},{key:"_compareEscalatorFirstFunc",value:function(t,e){return t.liftType==R.default.NaviLiftType_Escalator&&e.liftType==R.default.NaviLiftType_Escalator?t._dist-e._dist:t.liftType==R.default.NaviLiftType_Escalator?-1:e.liftType==R.default.NaviLiftType_Escalator?1:t._dist-e._dist}},{key:"_compareStairFirstFunc",value:function(t,e){return t.liftType==R.default.NaviLiftType_Stair&&e.liftType==R.default.NaviLiftType_Stair?t._dist-e._dist:t.liftType==R.default.NaviLiftType_Stair?-1:e.liftType==R.default.NaviLiftType_Stair?1:t._dist-e._dist}},{key:"_has_extent_node",value:function(t,e){if(null==t)return!1;for(var n=0;n<t.length;n++)if(t[n].Id==e.Id)return!0;return!1}},{key:"_has_adj_nodeId",value:function(t,e){if(null==t)return!1;for(var n=0;n<t.length;n++)if(t[n].nodeId==e.Id)return!0;return!1}},{key:"_enlarge_connected_nodes_num",value:function(t,e,n){var i=this._outlineAnalyseDijkstra._naviGraph.adjList;if(0==i.size())return[];var r=t.length-1,o=i.get(t[r].Id);if(null==o)return[];if(0==n)return this._has_adj_nodeId(o,e)?(t.push(e),t):[];for(var a=[],s=0;s<o.length;s++){var u,l,d,h=o[s];this._has_extent_node(t,h)||h.nodeId==e.Id||(u=t.concat(),l=this._outlineAnalyseDijkstra._naviGraph.getIndexByNodeID(h.nodeId),u.push(this._outlineAnalyseDijkstra._naviGraph.nodeVector[l]),d=this._enlarge_connected_nodes_num(u,e,n-1),0!=d.length&&a.push(d))}return a}},{key:"_calcPredictConnectedLift",value:function(t,e,n){for(var i=t.liftNodes,r=n.liftNodes,o=0;o<i.length;o++){var a=i[o];a._dist=I.default.distanceOfTwoPoints(a.point,e)}m.default.PRIORITY_DEFAULT==this._priority||m.default.PRIORITY_LIFTONLY==this._priority||m.default.PRIORITY_LIFTONLY==this._priority?i.sort(this._compareLiftFirstFunc):m.default.PRIORITY_ESCALATORFIRST==this._priority||m.default.PRIORITY_ESCALATORONLY==this._priority?i.sort(this._compareEscalatorFirstFunc):m.default.PRIORITY_STAIRFIRST!=this._priority&&m.default.PRIORITY_STAIRONLY!=this._priority||i.sort(this._compareLiftFirstFunc);for(var s=null,u=null,l=!1,d=0;d<i.length;d++){for(var h=i[d],f=h.liftFlag,c=(h.liftFloors,0);c<r.length;c++)if(r[c].liftFlag==f){s=h,u=r[c],l=!0;break}if(l)break}return null==s||null==u?null:{startLiftNodes:s,endLiftNodes:u}}},{key:"_calcPredictLiftNodesBak",value:function(t,e,n,i,r){this._startZone=this._multiFloorDijkstraMap.get(t.groupId)._naviGraph.queryZoneByPoint(n);for(var o=t.queryLiftNodes(this._startZone,n,this._endPoint,this._priority),a=0;a<o.length;a++){var s=o[a];if(R.default.NaviLiftType_Stair!=s.liftType){var u=s.liftFloors;if(-1==u.indexOf(e.groupId))continue}for(var l=0;l<e.liftNodes.length;l++){var d=e.liftNodes[l];if(s.liftFlag==d.liftFlag){i.push(s),r.push(d);break}}}return 0==i.length}},{key:"_calcPredictLiftNodes",value:function(r,e,t,n,i){this._startZone=this._multiFloorDijkstraMap.get(r.groupId)._naviGraph.queryZoneByPoint(t);var o=[];function a(t,e){var n,i=r.queryLifts(t,e);(n=o).push.apply(n,(0,x.default)(i))}for(var s=r.liftNodes,u=0;u<s.length;u++){var l=s[u],d=P.default.toVector(l.point),h=P.default.toVector(this._endPoint),f=P.default.toVector(t);l._dist=h.sub(d).length()+d.sub(f).length()}var c,p=r.extent.bb,_=p.maxX-p.minX+(p.maxY-p.minY);m.default.PRIORITY_LIFTONLY!=this._priority&&m.default.PRIORITY_ESCALATORONLY!=this._priority&&m.default.PRIORITY_STAIRONLY!=this._priority&&m.default.PRIORITY_ACCESSIBLEONLY!=this._priority||(c=null,m.default.PRIORITY_LIFTONLY==this._priority&&(c=R.default.NaviLiftType_Lift),m.default.PRIORITY_ESCALATORONLY==this._priority&&(c=R.default.NaviLiftType_Escalator),m.default.PRIORITY_STAIRONLY==this._priority&&(c=R.default.NaviLiftType_Stair),m.default.PRIORITY_ACCESSIBLEONLY==this._priority&&(c=R.default.NaviLiftType_Accessible),o=r.queryLifts(c)),m.default.PRIORITY_LIFTFIRST!=this._priority&&m.default.PRIORITY_ESCALATORFIRST!=this._priority&&m.default.PRIORITY_STAIRFIRST!=this._priority&&m.default.PRIORITY_DEFAULT!=this._priority||(m.default.PRIORITY_LIFTFIRST!=this._priority&&m.default.PRIORITY_DEFAULT!=this._priority||(a(R.default.NaviLiftType_Lift,-15),a(R.default.NaviLiftType_Escalator,-8),a(R.default.NaviLiftType_Stair,0)),m.default.PRIORITY_ESCALATORFIRST==this._priority&&(a(R.default.NaviLiftType_Lift,-8),a(R.default.NaviLiftType_Escalator,-15),a(R.default.NaviLiftType_Stair,0)),m.default.PRIORITY_STAIRFIRST==this._priority&&(a(R.default.NaviLiftType_Lift,-8),a(R.default.NaviLiftType_Escalator,0),a(R.default.NaviLiftType_Stair,-15))),m.default.PRIORITY_LIFTFIRST1!=this._priority&&m.default.PRIORITY_ESCALATORFIRST1!=this._priority&&m.default.PRIORITY_STAIRFIRST1!=this._priority||(m.default.PRIORITY_LIFTFIRST1==this._priority&&(a(R.default.NaviLiftType_Lift,-_),a(R.default.NaviLiftType_Escalator,0),a(R.default.NaviLiftType_Stair,0)),m.default.PRIORITY_ESCALATORFIRST1==this._priority&&(a(R.default.NaviLiftType_Lift,0),a(R.default.NaviLiftType_Escalator,-_),a(R.default.NaviLiftType_Stair,0)),m.default.PRIORITY_STAIRFIRST1==this._priority&&(a(R.default.NaviLiftType_Lift,0),a(R.default.NaviLiftType_Escalator,0),a(R.default.NaviLiftType_Stair,-_)));var v=this;o.sort(function(t,e){if(t.zone!=e.zone){if(t.zone==v._startZone)return-1;if(e.zone==v._startZone)return 1}return t._dist-e._dist});for(var y=0;y<o.length;y++){var g,I=o[y];if(R.default.NaviLiftType_Stair!=I._liftType&&(g=I._wrappedNode.liftFloors,g.find(function(t){return t==e.groupId})),!(1==I.liftEntry&&e.groupId<r.groupId||2==I.liftEntry&&e.groupId>r.groupId))for(var T=0;T<e.liftNodes.length;T++){var N=e.liftNodes[T];if(I.liftFlag==N.liftFlag){n.push(I),i.push(N);break}}}return 0!=n.length}},{key:"assginedInfos",set:function(t){this._assignedInfos=t},get:function(){return this._assignedInfos}},{key:"passPts",set:function(t){this._passPts=t}},{key:"failedInsertedPts",get:function(){return this._failedInsertedPts}},{key:"naviToDoor",get:function(){return this._naviToDoor},set:function(t){this._naviToDoor=t}}]),e}(),S=O;e.default=S},function(t,e,n){"use strict";var i=n(1),r=n(0);r(e,"__esModule",{value:!0}),e.default=void 0;var o=i(n(2)),a=i(n(3)),s=function(){function e(t){(0,o.default)(this,e),this._options=t,this._options.hasOwnProperty("naviServerURL")&&null!=this._options.naviServerURL||(this._options.naviServerURL=".http://source.fengmap.com/newmap"),void 0===this._options.useStatic&&(this._options.useStatic=!1)}return(0,a.default)(e,[{key:"naviServerURL",get:function(){return this._options.naviServerURL}},{key:"useStatic",get:function(){return this._options.useStatic}}]),e}(),u=s;e.default=u},function(t,e,n){"use strict";var i=n(1),r=n(0);r(e,"__esModule",{value:!0}),e.default=void 0,n(94);var o=i(n(2)),a=i(n(3)),u=i(n(231)),s=i(n(232)),l=i(n(236)),d=function(){function e(t){(0,o.default)(this,e),this._options=t,this._staticNaviScene=null,this._wktReader=new s.default,this._scene=null}return(0,a.default)(e,[{key:"setScene",value:function(t){this._scene=t}},{key:"queryScene",value:function(t,n){var e,i=this;this._options.useStatic?(e=this._options.naviServerURL+"/"+t+".fmap",new u.default(e,function(t){var e=i._convertStatic1(t);n(e.scene_data)},!0)):(e=this._options.naviServerURL+"/"+t,new u.default(e,function(t){var e=i._convertSite1(t);n(e.scene_data)},!0))}},{key:"queryNaviData",value:function(t,n,i){var e,r,o,a,s=this;this._options.useStatic?(e=s._convertStatic2(n),i(e)):(r=null,o=null,a=null,s=this,new u.default(this._options.naviServerURL+"/group_v2/"+t+"/"+n+"/geo",function(t){var e;r=t,null!=r&&null!=o&&null!=a&&(e=s._convertSite2(n,r,o,a),i(e))},!0),new u.default(this._options.naviServerURL+"/group_v2/"+t+"/"+n+"/biz",function(t){var e;o=t,null!=r&&null!=o&&null!=a&&(e=s._convertSite2(n,r,o,a),i(e))},!0),new u.default(this._options.naviServerURL+"/group_v2/"+t+"/"+n+"/navi",function(t){var e;a=t,null!=r&&null!=o&&null!=a&&(e=s._convertSite2(n,r,o,a),i(e))},!0))}},{key:"convertToGroup",value:function(t,e,n,i){return this._convertToGroup(t,e,n,i)}},{key:"convertGeo2Geometry",value:function(t,e){return this._convertGeo2Geometry(t,e)}},{key:"convertArray2Geometry",value:function(t,e){return this._convertArray2Geometry(t,e)}},{key:"_convertSite1",value:function(t){var e=fmSceneDecode(t),t={scene_data:e};return t}},{key:"_convertSite2",value:function(t,e,n,i){var r=fmFloorGeoDecode(e),o=fmFloorBizDecode(n),a=fmFloorNaviDecode(i);return this._convertToGroup(t,r,o,a)}},{key:"_convertGeo2Geometry",value:function(t){var e=this._wktReader.parse(t);return{points:e._points,holes:e._holes}}},{key:"_convertArray2Geometry",value:function(t,e){var n=(new l.default).parseGeometry(t,e);return{points:n._points,holes:n._holes}}},{key:"_tempFlipX",value:function(t){if(t&&"string"!=typeof t)for(var e in t){var n=t[e];if("vertices"==e||"vertex"==e)for(var i in n)i%2==0&&(n[i]=-n[i]);else"scene_data"==e?(n.x=-n.x,n.defCenX=-n.defCenX):this._tempFlipX(n)}}},{key:"_convertStringToArray",value:function(t){if(""==t||!t)return[];var e=[],n=t,i=[];return 0<=n.indexOf("|")||0<=n.indexOf("-")||0<=n.indexOf(",")?(i=n.split(/[|,-]/),e.push.apply(e,i)):e.push(n),e}},{key:"_convertStatic1",value:function(t){return this._staticNaviScene=fmMapDecode(t,!1),t={scene_data:this._staticNaviScene.scene},t}},{key:"_convertStatic2",value:function(t){for(var e=this._staticNaviScene.floors,n=0;n<e.length;n++){var i=e[n];if(i.gid==t)return this._convertToGroup(t,i.geo[0],i.biz[0],i.navi[0])}return null}},{key:"_convertToGroup",value:function(t,e,n,i){for(var r={},o=[],a=[],s=[],u=[],l=[],d=this._scene.scene.file_ver,h=0,f=e.extentLayer.length;h<f;h++){var c=e.extentLayer[h],p=null,p=1===d?this._convertGeo2Geometry(c.geo):this._convertArray2Geometry(c.idxs,c.pts);c.geoArr=p.points,c.holes=p.holes,a.push(c)}for(var _=0,v=e.labelLayer.length;_<v;_++)r[e.labelLayer[_].eid]=e.labelLayer[_];for(var y=0,g=e.modelLayer.length;y<g;y++){var I=e.modelLayer[y],T=n.modelLayer[y],N={};N.fid=T.fid,N.eid=I.eid,N.pass=T.pass,N.center=1===d?this._convertGeo2Geometry(r[I.eid].geo).points[0]:this._convertArray2Geometry(r[I.eid].idxs,r[I.eid].pts).points[0];var x=null,x=1===d?this._convertGeo2Geometry(I.geo):this._convertArray2Geometry(I.idxs,I.pts);N.geoArr=x.points,N.holes=x.holes,o.push(N)}for(var m=0,R=i.naviNodes.length;m<R;m++){var E=i.naviNodes[m];E.geoArr=1===d?this._convertGeo2Geometry(E.geo).points[0]:this._convertArray2Geometry(E.idxs,E.pts).points[0],E.linkSegArr=this._convertStringToArray(E.linkSeg),E.liftFloorArr=this._convertStringToArray(E.liftFloor),s.push(E)}for(var M=0,k=i.naviSegments.length;M<k;M++){var P=i.naviSegments[M];P.geoArr=1===d?this._convertGeo2Geometry(P.geo).points:this._convertArray2Geometry(P.idxs,P.pts).points,P.m_Id=i.mid,u.push(P)}if(i.naviZones)for(var L=0,k=i.naviZones.length;L<k;L++){var A=i.naviZones[L],O=null,O=1===d?this._convertGeo2Geometry(A.geo):this._convertArray2Geometry(A.idxs,A.pts);A.geoArr=O.points,A.holes=O.holes,A.m_Id=i.mid,l.push(A)}var S={gid:t,extentLayer:a,modelLayer:o,naviSegments:u,naviNodes:s,naviZones:l};return S}}]),e}(),h=d;e.default=h},function(t,e,n){var i=n(24),r=n(46),o=n(5)("match");t.exports=function(t){var e;return i(t)&&(void 0!==(e=t[o])?!!e:"RegExp"==r(t))}},function(t,e,n){"use strict";var i=n(227)(!0);t.exports=function(t,e,n){return e+(n?i(t,e).length:1)}},function(t,e,n){var u=n(39),l=n(38);t.exports=function(s){return function(t,e){var n,i,r=String(l(t)),o=u(e),a=r.length;return o<0||a<=o?s?"":void 0:(n=r.charCodeAt(o),n<55296||56319<n||o+1===a||(i=r.charCodeAt(o+1))<56320||57343<i?s?r.charAt(o):n:s?r.slice(o,o+2):i-56320+(n-55296<<10)+65536)}}},function(t,e,n){"use strict";var r=n(64),o=RegExp.prototype.exec;t.exports=function(t,e){var n=t.exec;if("function"==typeof n){var i=n.call(t,e);if("object"!=typeof i)throw new TypeError("RegExp exec method returned something other than an Object or null");return i}if("RegExp"!==r(t))throw new TypeError("RegExp#exec called on incompatible receiver");return o.call(t,e)}},function(t,e,n){"use strict";n(230);var d=n(25),h=n(13),f=n(8),c=n(38),p=n(5),_=n(95),v=p("species"),y=!f(function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")}),g=function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var n="ab".split(t);return 2===n.length&&"a"===n[0]&&"b"===n[1]}();t.exports=function(n,t,e){var o,i,r,a,s=p(n),u=!f(function(){var t={};return t[s]=function(){return 7},7!=""[n](t)}),l=u?!f(function(){var t=!1,e=/a/;return e.exec=function(){return t=!0,null},"split"===n&&(e.constructor={},e.constructor[v]=function(){return e}),e[s](""),!t}):void 0;u&&l&&("replace"!==n||y)&&("split"!==n||g)||(o=/./[s],i=e(c,s,""[n],function(t,e,n,i,r){return e.exec===_?u&&!r?{done:!0,value:o.call(e,n,i)}:{done:!0,value:t.call(n,e,i)}:{done:!1}}),r=i[0],a=i[1],d(String.prototype,n,r),h(RegExp.prototype,s,2==t?function(t,e){return a.call(t,this,e)}:function(t){return a.call(t,this)}))}},function(t,e,n){"use strict";var i=n(95);n(30)({target:"RegExp",proto:!0,forced:i!==/./.exec},{exec:i})},function(t,e,n){"use strict";var i=n(1),r=n(0);r(e,"__esModule",{value:!0}),e.default=void 0;var o=i(n(2)),a=i(n(3)),s=function(){function t(){(0,o.default)(this,t),this.requestMethod="GET",this._requestHeader={},this.sendData=null}return(0,a.default)(t,[{key:"getFile",value:function(t,e,n,i,r){void 0!==this._path&&(t=this._path+t);var o,a=new XMLHttpRequest;for(o in a.open(this.requestMethod,t,!0),a.addEventListener("load",function(){var t=this.response;200===this.status||0===this.status||201===this.status?(0===this.status&&console.warn("FMMap FileLoader: HTTP Status 0 received."),e(t)):n(t)},!1),a.addEventListener("progress",function(){i&&i()},!1),a.addEventListener("error",function(){n()},!1),a.addEventListener("abort",function(){r&&r()},!1),void 0!==this._responseType&&(a.responseType=this._responseType),void 0!==this._withCredentials&&(a.withCredentials=this._withCredentials),a.overrideMimeType&&a.overrideMimeType(void 0!==this._mimeType?this._mimeType:"text/plain"),this._requestHeader)a.setRequestHeader(o,this._requestHeader[o]);a.send(this.sendData)}},{key:"setPath",value:function(t){return this._path=t,this}},{key:"setResponseType",value:function(t){return this._responseType=t,this}},{key:"setWithCredentials",value:function(t){return this._withCredentials=t,this}},{key:"setMimeType",value:function(t){return this._mimeType=t,this}},{key:"setRequestHeader",value:function(t){return t&&(this._requestHeader=t),this}}]),t}(),u=s;e.default=u},function(e,n,i){"use strict";var r=i(1),o=i(0);o(n,"__esModule",{value:!0}),n.default=void 0;var s=r(i(134));i(94);var a=r(i(2)),u=r(i(3)),l=l||{};l.GLEN1="MULTIPOLYGON(((".length,l.GLEN2="POINT(".length,l.GLEN3="MULTILINESTRING((".length;var d=function(){function e(){(0,a.default)(this,e),this._points,this._holes}return(0,u.default)(e,[{key:"parse",value:function(t){if(this._points=[],this._holes=[],0==t.indexOf("MULTIPOLYGON((("))for(var e=t.substring(l.GLEN1,t.length-3).split(/\),\(/),n=0;n<e.length;n++){var i=e[n].split(/,/);if(0==n)for(var r=0;r<i.length;r++){var o=i[r].split(" ");this._points.push({x:(0,s.default)(o[0]),y:(0,s.default)(o[1])})}else{for(var a=[],r=0;r<i.length;r++)o=i[r].split(" "),a.push({x:(0,s.default)(o[0]),y:(0,s.default)(o[1])});this._holes.push(a)}}else if(0==t.indexOf("POINT("))o=t.substring(l.GLEN2,t.length-1).split(" "),this._points.push({x:(0,s.default)(o[0]),y:(0,s.default)(o[1])});else if(0==t.indexOf("MULTILINESTRING(("))for(i=t.substring(l.GLEN3,t.length-2).split(","),r=0;r<i.length;r++)o=i[r].split(" "),this._points.push({x:(0,s.default)(o[0]),y:(0,s.default)(o[1])});return this}},{key:"toFixed",value:function(t){return+t.toFixed(2)}},{key:"parsePnt",value:function(t){if(this._points=[],0==t.indexOf("MULTIPOLYGON((("))for(var e=t.substring(l.GLEN1,t.length-3).split(","),n=0;n<e.length;n++){var i=e[n].split(" ");this._points.push({x:(0,s.default)(i[0]),y:(0,s.default)(i[1])})}else if(0==t.indexOf("POINT("))i=t.substring(l.GLEN2,t.length-1).split(" "),this._points.push({x:(0,s.default)(i[0]),y:(0,s.default)(i[1])});else if(0==t.indexOf("MULTILINESTRING(("))for(e=t.substring(l.GLEN3,t.length-2).split(","),n=0;n<e.length;n++)i=e[n].split(" "),this._points.push({x:(0,s.default)(i[0]),y:(0,s.default)(i[1])});return this}},{key:"toPntStrip",value:function(t){var e=[],n=this._points.length;if(!0===t){if(1<=n)for(var i=0;i<n-1;i++){var r=this._points[i];e.push(r.x,r.y)}}else for(i=0;i<n;i++)r=this._points[i],e.push(r.x,r.y);return e}},{key:"mergePnts",value:function(t){for(var e=[],n=t.length,i=0;i<n;i++){for(var r=t[i],o={x:this.toFixed(r.x),y:this.toFixed(r.y)},a=e.length,s=!1,u=0;u<a;u++){var l=e[u];if(l.x==o.x&&l.y==o.y){s=!0;break}}s||e.push(o)}return e}},{key:"toStrip",value:function(e){var n=[],i=this._points.length;if(i<=0)return n;for(var r=this._points.splice(i-1,1)[0],o=this.mergePnts(this._points),a=o.length,s=0;s<a;s++){var u=o[s];n.push(u.x,u.y)}return!0===e||(t={x:this.toFixed(r.x),y:this.toFixed(r.y)},n.push(t.x,t.y),this._points.push(r)),n}},{key:"hasHoles",value:function(){return null!=this._holes&&0<this._holes.length}},{key:"toStripHoles",value:function(e){for(var n=[],i=0;i<this._holes.length;i++){for(var r=this._holes[i],o=[],a=r.length,s=r.splice(a-1,1)[0],u=this.mergePnts(r),l=u.length,d=0;d<l;d++){var h=u[d];o.push(h.x,h.y)}!0===e||(t={x:this.toFixed(s.x),y:this.toFixed(s.y)},o.push(t.x,t.y)),n.push(o)}return n}},{key:"holes",set:function(t){this._holes=t},get:function(){return this._holes}},{key:"points",get:function(){return this._points},set:function(t){this._points=t}}]),e}(),h=d;n.default=h},function(t,e,n){n(234),t.exports=n(4).parseFloat},function(t,e,n){var i=n(6),r=n(235);i(i.G+i.F*(parseFloat!=r),{parseFloat:r})},function(t,e,n){var i=n(9).parseFloat,r=n(133).trim;t.exports=1/i(n(92)+"-0")!=-1/0?function(t){var e=r(String(t),3),n=i(e);return 0===n&&"-"==e.charAt(0)?-0:n}:i},function(e,n,i){"use strict";var r=i(1),o=i(0);o(n,"__esModule",{value:!0}),n.default=void 0;var a=r(i(2)),s=r(i(3)),u=function(){function e(){(0,a.default)(this,e),this._points,this._holes}return(0,s.default)(e,[{key:"parse",value:function(t,e){this._points=[],this._holes=[];for(var n=0,i=0;i<t.length;i++){var r=t[i].idxs,r=r||t[i];if("number"==typeof r)for(;n<r;)this._points.push({x:e[n],y:e[n+1]}),n+=2;else for(var o=0;o<r.length;o++)for(var a=r[o];n<a;)this._points.push({x:e[n],y:e[n+1]}),n+=2}return this}},{key:"parseGeometry",value:function(t,e){this._points=[],this._holes=[];for(var n=0,i=0;i<t.length;i++){var r=t[i].idxs,r=r||t[i];if("number"==typeof r)for(;n<r;)this._points.push({x:e[n],y:e[n+1]}),n+=2;else for(var o=0;o<r.length;o++)if(0===o)for(var a=r[o];n<a;)this._points.push({x:e[n],y:e[n+1]}),n+=2;else{for(var s=[],u=r[o];n<u;)s.push({x:e[n],y:e[n+1]}),n+=2;this._holes.push(s)}}return this}},{key:"mergePnts",value:function(t){for(var e=[],n=t.length,i=0;i<n;i++){for(var r=t[i],o={x:this.toFixed(r.x),y:this.toFixed(r.y)},a=e.length,s=!1,u=0;u<a;u++){var l=e[u];if(l.x==o.x&&l.y==o.y){s=!0;break}}s||e.push(o)}return e}},{key:"toStrip",value:function(e){var n=[],i=this._points.length;if(i<=0)return n;for(var r=this._points.splice(i-1,1)[0],o=this._points,a=o.length,s=0;s<a;s++){var u=o[s];n.push(u.x,u.y)}return!0===e||(t={x:this.toFixed(r.x),y:this.toFixed(r.y)},n.push(t.x,t.y),this._points.push(r)),n}},{key:"toFixed",value:function(t){return+t.toFixed(2)}},{key:"hasHoles",value:function(){return null!=this._holes&&0<this._holes.length}},{key:"toStripHoles",value:function(e){for(var n=[],i=0;i<this._holes.length;i++){for(var r=this._holes[i],o=[],a=r.length,s=r.splice(a-1,1)[0],u=this.mergePnts(r),l=u.length,d=0;d<l;d++){var h=u[d];o.push(h.x,h.y)}!0===e||(t={x:this.toFixed(s.x),y:this.toFixed(s.y)},o.push(t.x,t.y)),n.push(o)}return n}},{key:"holes",set:function(t){this._holes=t},get:function(){return this._holes}},{key:"points",get:function(){return this._points},set:function(t){this._points=t}}]),e}(),l=u;n.default=l},function(t,e,n){"use strict";var i=n(1),r=n(0);r(e,"__esModule",{value:!0}),e.default=void 0,n(65),n(17);var o=i(n(136)),a=i(n(2)),s=i(n(137)),u=i(n(139)),l=i(n(140)),d=i(n(42));function h(i){var r=f();return function(){var t,e=(0,l.default)(i),n=r?(t=(0,l.default)(this).constructor,(0,o.default)(e,arguments,t)):e.apply(this,arguments);return(0,u.default)(this,n)}}function f(){if("undefined"==typeof Reflect||!o.default)return!1;if(o.default.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call((0,o.default)(Date,[],function(){})),!0}catch(t){return!1}}var c=function(t){(0,s.default)(n,t);var e=h(n);function n(){var t;return(0,a.default)(this,n),t=e.call(this),t.liftId=0,t.groupId=0,t.zone=null,t._dist=0,t._wrappedNode=null,t._liftType=null,t}return n}(d.default),p=c;e.default=p},function(t,e,n){n(239),t.exports=n(4).Reflect.construct},function(t,e,n){var i=n(6),u=n(56),l=n(69),d=n(27),h=n(19),r=n(20),f=n(240),c=(n(9).Reflect||{}).construct,p=r(function(){function t(){}return!(c(function(){},[],t)instanceof t)}),_=!r(function(){c(function(){})});i(i.S+i.F*(p||_),"Reflect",{construct:function(t,e,n){l(t),d(e);var i=arguments.length<3?t:l(n);if(_&&!p)return c(t,e,i);if(t==i){switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3])}var r=[null];return r.push.apply(r,e),new(f.apply(t,r))}var o=i.prototype,a=u(h(o)?o:Object.prototype),s=Function.apply.call(t,a,e);return h(s)?s:a}})},function(t,e,n){"use strict";var o=n(69),a=n(19),s=n(241),u=[].slice,l={},d=function(t,e,n){if(!(e in l)){for(var i=[],r=0;r<e;r++)i[r]="a["+r+"]";l[e]=Function("F,a","return new F("+i.join(",")+")")}return l[e](t,n)};t.exports=Function.bind||function(e){var n=o(this),i=u.call(arguments,1),r=function(){var t=i.concat(u.call(arguments));return this instanceof r?d(n,t.length,t):s(n,t,e)};return a(n.prototype)&&(r.prototype=n.prototype),r}},function(t){t.exports=function(t,e,n){var i=void 0===n;switch(e.length){case 0:return i?t():t.call(n);case 1:return i?t(e[0]):t.call(n,e[0]);case 2:return i?t(e[0],e[1]):t.call(n,e[0],e[1]);case 3:return i?t(e[0],e[1],e[2]):t.call(n,e[0],e[1],e[2]);case 4:return i?t(e[0],e[1],e[2],e[3]):t.call(n,e[0],e[1],e[2],e[3])}return t.apply(n,e)}},function(t,e,n){t.exports=n(243)},function(t,e,n){n(244);var i=n(4).Object;t.exports=function(t,e){return i.create(t,e)}},function(t,e,n){var i=n(6);i(i.S,"Object",{create:n(56)})},function(n,t,e){var i=e(138);function r(t,e){return n.exports=r=i||function(t,e){return t.__proto__=e,t},r(t,e)}n.exports=r},function(t,e,n){n(247),t.exports=n(4).Object.setPrototypeOf},function(t,e,n){var i=n(6);i(i.S,"Object",{setPrototypeOf:n(248).set})},function(t,e,r){var n=r(19),i=r(27),o=function(t,e){if(i(t),!n(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,n,i){try{i=r(68)(Function.call,r(117).f(Object.prototype,"__proto__").set,2),i(t,[]),n=!(t instanceof Array)}catch(t){n=!0}return function(t,e){return o(t,e),n?t.__proto__=e:i(t,e),t}}({},!1):void 0),check:o}},function(e,t,n){var i=n(250),r=n(115);function o(t){return e.exports=o="function"==typeof r&&"symbol"==typeof i?function(t){return typeof t}:function(t){return t&&"function"==typeof r&&t.constructor===r&&t!==r.prototype?"symbol":typeof t},o(t)}e.exports=o},function(t,e,n){t.exports=n(251)},function(t,e,n){n(77),n(114),t.exports=n(79).f("iterator")},function(t){function e(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}t.exports=e},function(t,e,n){t.exports=n(254)},function(t,e,n){n(255),t.exports=n(4).Object.getPrototypeOf},function(t,e,n){var i=n(44),r=n(112);n(256)("getPrototypeOf",function(){return function(t){return r(i(t))}})},function(t,e,n){var r=n(6),o=n(4),a=n(20);t.exports=function(t,e){var n=(o.Object||{})[t]||Object[t],i={};i[t]=e(n),r(r.S+r.F*a(function(){n(1)}),"Object",i)}},function(t,e,n){"use strict";var i=n(1),r=n(0);r(e,"__esModule",{value:!0}),e.default=void 0;var s=i(n(2)),o=i(n(3)),u=i(n(142)),l=i(n(12)),d=i(n(141)),a=function(){function a(t,e,n,i,r,o){(0,s.default)(this,a),this.Id=t,this.fid="",this.points=i,this.pointCount=i&&i.length?i.length:0,this.center=r,this.holes=o,this._type=n,this.groupID=e,this.doors=[],this.doorTypes=[],this.doorEntrys=[],this.parent=null,this.child=null,this.brothers=[],this.level=0,this.inId=0,this._area=null,this.isExtent=!1,this.bb=new u.default,this.refreshBB()}return(0,o.default)(a,[{key:"contain",value:function(t){return l.default.pointInPolygon2d(this.points,t,this.points.length-1)}},{key:"refreshBB",value:function(){this.bb.init();for(var t=0;t<this.pointCount;t++)this.bb.expandBy({x:this.points[t].x,y:this.points[t].y})}},{key:"toZone",value:function(){var t=new d.default(this.isExtent?-this.Id:this.Id,this.groupID,this._type,this.points);return t.pass=this.pass,t.level=this.level,t.inId=this.inId,pZone}},{key:"pass",set:function(t){this._type|=t},get:function(){return 3&this._type}},{key:"level",set:function(t){this._level=31&t},get:function(){return 31&_level}},{key:"area",get:function(){return null==this._area&&(this._area=l.default.calcPolygonArea2d(this.points)),this._area}}]),a}(),h=a;e.default=h},function(t,e,n){"use strict";var i=n(1),r=n(0);r(e,"__esModule",{value:!0}),e.default=void 0,n(65),n(17);var o=i(n(136));n(21);var s=i(n(29)),a=i(n(2)),u=i(n(3)),l=i(n(137)),d=i(n(139)),h=i(n(140)),f=i(n(42)),c=i(n(33)),p=i(n(66)),_=i(n(12));function v(i){var r=y();return function(){var t,e=(0,h.default)(i),n=r?(t=(0,h.default)(this).constructor,(0,o.default)(e,arguments,t)):e.apply(this,arguments);return(0,d.default)(this,n)}}function y(){if("undefined"==typeof Reflect||!o.default)return!1;if(o.default.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call((0,o.default)(Date,[],function(){})),!0}catch(t){return!1}}var g=function(t){(0,l.default)(n,t);var e=v(n);function n(){var t;return(0,a.default)(this,n),t=e.call(this),t.groupId=0,t.extentId=0,t.liftNodes=[],t._zone=null,t._firstPriorityOffset=15,t._secondPriorityOffset=8,t}return(0,u.default)(n,[{key:"queryLifts",value:function(t,e){if(1==arguments.length){for(var n=t,i=[],r=0;r<this.liftNodes.length;r++)n==this.liftNodes[r]._liftType&&i.push(this.liftNodes[r]);return i}if(2!=arguments.length)return[];for(var n=arguments[0],o=e,a=[],r=0;r<this.liftNodes.length;r++){var s=this.liftNodes[r];n==s._liftType&&(s._dist=s._dist+o,a.push(s))}return a}},{key:"queryLiftNodes",value:function(t,e,n,i){this._zone=t;var r=[];r.push.apply(r,(0,s.default)(this.liftNodes));for(var o=0;o<r.length;o++){var a=r[o];a._dist=_.default.distanceOfTwoPoints(n,a.point)+_.default.distanceOfTwoPoints(a.point,e)}return this._liftNodeSort(r,i)}},{key:"_liftNodeSort",value:function(t,e){if(e==p.default.PRIORITY_LIFTFIRST1){var n=this._sortLiftFirst.bind(this);t.sort(n)}else if(e==p.default.PRIORITY_ESCALATORFIRST1){var i=this._sortEscalatorFirst.bind(this);t.sort(i)}else if(e!=p.default.PRIORITY_STAIRFIRST1){var r=this._sortStairFirst.bind(this);t.sort(r)}else{var o;this._modifyDistance(t,e);for(var a=[],s=0;s<t.length;s++)t[s]._dist&&a.push(t[s]);t=[],(o=t).push.apply(o,a);var u=this._sortDistFunc.bind(this);t.sort(u)}return t}},{key:"_sortLiftFirst",value:function(t,e){if(t.zone!=e.zone){if(this._zone==t.zone)return-1;if(this._zone==e.zone)return 1}return t.liftType!=c.default.NaviLiftType_Lift&&t.liftType!=c.default.NaviLiftType_Accessible||e.liftType!=c.default.NaviLiftType_Lift&&e.liftType!=c.default.NaviLiftType_Accessible?t.liftType==c.default.NaviLiftType_Lift||t.liftType==c.default.NaviLiftType_Accessible?-1:e.liftType==c.default.NaviLiftType_Lift||e.liftType==c.default.NaviLiftType_Accessible?1:t._dist-e._dist:t._dist<e._dist}},{key:"_sortEscalatorFirst",value:function(t,e){if(t.zone!=e.zone){if(this._zone==t.zone)return-1;if(this._zone==e.zone)return 1}return t.liftType==c.default.NaviLiftType_Escalator&&e.liftType==c.default.NaviLiftType_Escalator?t._dist<e._dist:t.liftType==c.default.NaviLiftType_Escalator?-1:e.liftType==c.default.NaviLiftType_Escalator?1:t._dist-e._dist}},{key:"_sortStairFirst",value:function(t,e){if(t.zone!=e.zone){if(this._zone==t.zone)return-1;if(this._zone==e.zone)return 1}return t.liftType==c.default.NaviLiftType_Stair&&e.liftType==c.default.NaviLiftType_Stair?t._dist<e._dist:t.liftType==c.default.NaviLiftType_Stair?-1:e.liftType==c.default.NaviLiftType_Stair?1:t._dist-e._dist}},{key:"_sortDistFunc",value:function(t,e){if(t.zone!=e.zone){if(this._zone==t.zone)return-1;if(this._zone==e.zone)return 1}return t._dist-e._dist}},{key:"_modifyDistance",value:function(t,e){if(e==p.default.PRIORITY_DEFAULT)for(var n=0;n<t.length;n++)t[n].liftType==c.default.NaviLiftType_Escalator?t[n]._dist-=this._firstPriorityOffset:t[n].liftType!=c.default.NaviLiftType_Lift&&t[n].liftType!=c.default.NaviLiftType_Accessible||(t[n]._dist-=this._secondPriorityOffset);else if(e==p.default.PRIORITY_STAIRFIRST)for(var i=0;i<t.length;i++)t[i].liftType==c.default.NaviLiftType_Stair?t[i]._dist-=this._firstPriorityOffset:t[i].liftType==c.default.NaviLiftType_Escalator&&(t[i]._dist-=this._secondPriorityOffset);else if(e==p.default.PRIORITY_ESCALATORFIRST)for(var r=0;r<t.length;r++)t[r].liftType==c.default.NaviLiftType_Escalator?t[r]._dist-=this._firstPriorityOffset:t[r].liftType!=c.default.NaviLiftType_Lift&&t[r].liftType!=c.default.NaviLiftType_Accessible||(t[r]._dist-=this._secondPriorityOffset);else if(e==p.default.PRIORITY_LIFTFIRST)for(var o=0;o<t.length;o++)t[o].liftType==c.default.NaviLiftType_Lift||t[o].liftType==c.default.NaviLiftType_Accessible?t[o]._dist-=this._firstPriorityOffset:t[o].liftType==c.default.NaviLiftType_Escalator&&(t[o]._dist-=this._secondPriorityOffset);else if(e==p.default.PRIORITY_STAIRONLY)for(var a=0;a<t.length;a++)t[a].liftType!=c.default.NaviLiftType_Stair&&(t[a]._dist=null);else if(e==p.default.PRIORITY_ESCALATORONLY)for(var s=0;s<t.length;s++)t[s].liftType!=c.default.NaviLiftType_Escalator&&(t[s]._dist=null);else if(e==p.default.PRIORITY_LIFTONLY)for(var u=0;u<t.length;u++)t[u].liftType!=c.default.NaviLiftType_Lift&&t[u].liftType!=c.default.NaviLiftType_Accessible&&(t[u]._dist=null);else if(e==p.default.PRIORITY_ACCESSIBLEONLY)for(var l=0;l<t.length;l++)t[l].liftType!=c.default.NaviLiftType_Accessible&&(t[l]._dist=null)}}]),n}(f.default),I=g;e.default=I},function(t,e,n){"use strict";var i=n(1),r=n(0);r(e,"__esModule",{value:!0}),e.default=void 0,n(21),n(50),n(32),n(17),n(67);var B=i(n(15));n(143);var w=i(n(29));n(16);var o=i(n(2)),a=i(n(3)),C=i(n(12)),Z=i(n(33)),s=i(n(41)),l=i(n(144)),H=i(n(42)),Y=i(n(96)),d=i(n(49)),u=i(n(98)),q=i(n(97)),D=i(n(48)),F=(i(n(93)),i(n(260))),h=function(){function e(t){(0,o.default)(this,e),this._startModel=null,this._endModel=null,this._naviGraph=t,this._zoneMap=new d.default,this._zoneIdGraph=new d.default,this._originDijkstra=null,this._zoneIdSimpleDijkstraMap=new d.default,this._resultVector=[],this._startZoneId=Number.INT_MIN,this._endZoneId=Number.INT_MIN,this._tmpId=-1,this._startNode=null,this._endNode=null,this._mode=s.default.MODULE_SHORTEST,this._zonePNTModelsMap=new d.default,this._zoneNPModelsMap=new d.default,this._modelIdRoadsMap=new d.default,this._variableModelPairs=[],this._unattachedTempRoads=[],this._attachedTempRoads=[],this._unattachedTempRoadTrees=[],this._kScaleVariable=100,this._kRemainedZoneId=-1,this._kMinModelAngle=15,this._kDoorToler=.1,this._tmpAdjNodeIds=[],this._assignedPts=[],this._newTempRoads=[],this._bannedPolys=[],this._assignedNodes=[],this._segmentByZones(),this._assemblePassNotThroughModels(),this._assembleNotPassModels(),this._fitVariableRoadsToModel(),this._adjustNPModelRoads()}return(0,a.default)(e,[{key:"routeCalculate",value:function(t,e,n){if(this._startZoneId=t instanceof H.default?this._calcZoneIdByCoord(t.point):this._calcZoneIdByCoord(t),this._endZoneId=e instanceof H.default?this._calcZoneIdByCoord(e.point):this._calcZoneIdByCoord(e),n&&(this._mode=n),this._naviGraph.consoleNodeInfos(),this._naviGraph.consoleRoadInfos(),t instanceof H.default)this._startNode=t;else if(D.default.ROUTE_FAILED_NO_DATA_START==this._processStartPoint(t,t))return D.default.ROUTE_FAILED_NO_DATA_START;if(this._naviGraph.consoleNodeInfos(),this._naviGraph.consoleRoadInfos(),e instanceof H.default)this._endNode=e;else if(D.default.ROUTE_FAILED_NO_DATA_END==this._processEndPoint(e,t instanceof H.default?t.point:t))return D.default.ROUTE_FAILED_NO_DATA_END;return this._naviGraph.consoleNodeInfos(),this._naviGraph.consoleRoadInfos(),null==this._startNode?D.default.ROUTE_FAILED_NO_DATA_START:null==this._endNode?D.default.ROUTE_FAILED_NO_DATA_END:(this._naviGraph.consoleNodeInfos(),this._naviGraph.consoleRoadInfos(),this._naviGraph.consoleAdjInfos(),this._routeCalculate())}},{key:"routeAssigned",value:function(){var t;this._assignedNodes=[];for(var e=0;e<this._assignedPts.length;e++){var n=this._assignedPts[e],n={x:n[0],y:n[1]},i=this._calcZoneIdByCoord(n),r=this._insertTmpIsolatedNode(i,n);this._assignedNodes.push(r)}(t=this._resultVector).push.apply(t,(0,w.default)(this._assignedNodes))}},{key:"getRouteCalculateResult",value:function(){return this._resultVector}},{key:"dispose",value:function(){this._startModel=null,this._endModel=null,this._naviGraph.dispose(),this._naviGraph=null,this._zoneMap.clear(),this._zoneMap=null,this._zoneIdGraph.each(function(t,e){e.dispose()}),this._zoneIdGraph.clear(),this._zoneIdGraph=null,null!=this._originDijkstra&&(this._originDijkstra.dispose(),this._originDijkstra=null),this._zoneIdSimpleDijkstraMap.each(function(t,e){e.dispose()}),this._zoneIdSimpleDijkstraMap.clear(),this._zoneIdSimpleDijkstraMap=null,this._resultVector=[],this._startNode=null,this._endNode=null,this._zonePNTModelsMap.clear(),this._zonePNTModelsMap=null,this._zoneNPModelsMap.clear(),this._zoneNPModelsMap=null,this._modelIdRoadsMap.clear(),this.__zoneNPModelsMap=null,this._variableModelPairs=[],this._unattachedTempRoads=[],this._attachedTempRoads=[],this._unattachedTempRoadTrees=[]}},{key:"reset",value:function(){this._resultVector=[],this._clearTempElements(-1),this._clearTempElements(this._startZoneId),this._startZoneId=Number.INT_MIN,this._clearTempElements(this._endZoneId),this._endZoneId=Number.INT_MIN,this._clearTempAdjList(),this._tmpAdjNodeIds=[];var t=this._naviGraph.roadVector.length;this._tmpId<-2*t&&(this._tmpId=-1);for(var e=0;e<this._variableModelPairs.length;e++){var n=this._variableModelPairs[e];this._switchVariableHinderTo(n.zoneId,n.model,Z.default.NaviRoadHinderType_HINDER_HIGH)}this._variableModelPairs=[],this._unattachedTempRoads=[],this._attachedTempRoads=[],this._unattachedTempRoadTrees=[]}},{key:"resetBanned",value:function(){this._newTempRoads=[];for(var t=0;t<this._noEntryRoads.length;t++){var e=this._noEntryRoads[t];e.road.roadEntry=e.originEntry}this._noEntryRoads=[],this._clearTempElements(-1);var n=this._zoneIdSimpleDijkstraMap.get(-1)._naviGraph;n.makeUpAdjList()}},{key:"setBannedPoltyons",value:function(t){this.resetBanned(),0!=t.length&&(this._bannedPolys=t,this._dealBannedAreas())}},{key:"clearBannedArea",value:function(){}},{key:"_dealBannedAreas",value:function(){for(var t=0;t<this._bannedPolys.length;t++)this._banBySinglePolygon(this._bannedPolys[t])}},{key:"_insertNewTempRoad",value:function(t,e,n,i,r){var o,a;t instanceof H.default?o=t:(o=new H.default,o.Id=e,o.point=t,this._naviGraph.nodeVector.push(o)),n instanceof H.default?a=n:(a=new H.default,a.Id=i,a.point=n,this._naviGraph.nodeVector.push(a));var s=new Y.default;s.Id=this._tmpId--,s.startId=o.Id,s.startPoint=o.point,s.endId=a.Id,s.endPoint=a.point,s.roadEntry=r,this._naviGraph.roadVector.push(s)}},{key:"_banBySinglePolygon",value:function(t){for(var e=this._naviGraph.queryRoadsByPolygon(t),n=0;n<e.length;n++){var i=e[n],r=i.road,o=r.roadEntry;this._noEntryRoads.push({road:r,originEntry:o}),r.roadEntry=Z.default.NaviRoadEntry_FORBID,1==i.crss.length&&(1==C.default.pointInPolygon2d(t,r.startPoint,t.length)?this._insertNewTempRoad(i.crss[0],this._tmpId--,r.endPoint,this._tmpId--,o):this._insertNewTempRoad(r.startPoint,this._tmpId--,i.crss[0],this._tmpId--,o)),2==i.crss.length&&(this._insertNewTempRoad(r.startPoint,this._newTempId(),i.crss[0],this._newTempId(),o),this._insertNewTempRoad(i.crss[1],this._newTempId(),r.endPoint,this._newTempId(),o))}var a=new NaviModel;a.Id=this._tmpId--,a.points=t,a.points.push(t[0]),a.pass=Z.default.NaviModelPassType_NOT_PASS,this._naviGraph.obstructModels.push(a)}},{key:"_newTempId",value:function(){return this._tmpId--}},{key:"_calcPointReachable",value:function(t){var e=this._naviGraph.queryContainExtentId(t);if(-1==e)return null;var n=this._calcZoneIdByCoord(t),i=-0,r=this._zoneIdGraph.get(n).findModel(t,i);if(null==r)return{extentId:e,model:null};if(r.pass==Z.default.NaviModelPassType_PASS_THROUGH||r.pass==Z.default.NaviModelPassType_PASS_NOT_THROUGH){if(0<r.doors.length)return{extentId:e,model:r};for(var o={},a=[],s=[],u=this._zoneIdGraph.get(n),l=u.roadVector,d=!0,h=r.points.length,f=0;f<h-1;f++)for(var c=r.points[f],p=r.points[f+1],_=0;_<l.length;_++){var v=l[_];if(1==C.default.calcCrossPoint(c,p,v.startPoint,v.endPoint,o)){if(d=!1,Z.default.NaviRoadEntry_FORBID==v.roadEntry)continue;var y=new Object;y.x=o.x,y.y=o.y,a.push(y),s.push(l[_])}}if(d)return{extentId:e,model:r};if(0==a.length)return null;r.doors=[],r.doorEntrys=[],r.doorTypes=[];for(var g=0;g<a.length;g++){var I=a[g],T=s[g],N=this._insertNodeToRoad(n,I,T);N.nodeType=Z.default.NaviNodeType_COMMON,T.roadEntry==Z.default.NaviRoadEntry_BOTH?N.entranceType=Z.default.NaviEntranceType_ACCESS:C.default.pointInPolygon2d(r.points,T.startPoint,r.points.length-1)?(T.roadEntry==Z.default.NaviRoadEntry_FORWARD&&(N.entranceType=Z.default.NaviEntranceType_EXIT),T.roadEntry==Z.default.NaviRoadEntry_BACK&&(N.entranceType=Z.default.NaviEntranceType_ENTRANCE)):(T.roadEntry==Z.default.NaviRoadEntry_FORWARD&&(N.entranceType=Z.default.NaviEntranceType_ENTRANCE),T.roadEntry==Z.default.NaviRoadEntry_BACK&&(N.entranceType=Z.default.NaviEntranceType_EXIT)),r.doors.push(N),r.doorEntrys.push(N.entranceType),r.doorTypes.push(N.nodeType)}}return r.pass!=Z.default.NaviModelPassType_NOT_PASS?{extentId:e,model:r}:null}},{key:"_processStartPoint",value:function(o,t){var a=this;this._startNode=this._insertTmpIsolatedNode(this._startZoneId,o);var e=null,i=!0,e=null!=this._startModel&&this._startModel.pass==Z.default.NaviModelPassType_PASS_THROUGH&&0==this._startModel.doors.length?this._seekNearRoads(this._startZoneId,o,t,30,this._startModel):this._seekNearRoads(this._startZoneId,o,t);if(null==this._startModel&&(i=!1),0<e.size()){i=!1,e.each(function(t,e,n){for(n=0;n<e.length;n++)0!=e[n].road.roadEntry&&(i=!0)});var s=0,u=!1,l=[];if(e.each(function(t,e){var n,i=e[0].road,r=a._exploreUprightLikelyJoints(a._startZoneId,o,i,e,a._startModel);0==r.length?s++:Math.abs(r[0].rotateAngle)>C.default.epsilon()?l.push.apply(l,(0,w.default)(r)):(u=!0,n=a._insertTempNodeToRoad(a._startZoneId,r[0].cross,r[0].road),a._joinTwoNodes(a._startZoneId,a._startNode,n))}),u||l.forEach(function(t){var e=a._insertTempNodeToRoad(a._startZoneId,t.cross,t.road);a._joinTwoNodes(a._startZoneId,a._startNode,e)}),s==e.size())return D.default.ROUTE_FAILED_NO_DATA_START}if(i&&null!=this._startModel&&0<this._startModel.doors.length){for(var n=null,r=!1,d=0;d<this._startModel.doors.length;d++){n=this._startModel.doors[d];var h=this._startModel.doorEntrys[d];h!=Z.default.NaviEntranceType_EXIT&&h!=Z.default.NaviEntranceType_ACCESS||(this._joinTwoNodes(this._startZoneId,this._startNode,n),r=!0)}if(!r)return D.default.ROUTE_FAILED_NO_DATA_START}}},{key:"_processEndPoint",value:function(o,t){var a=this;this._endNode=this._insertTmpIsolatedNode(this._endZoneId,o);var e=null,i=!0,e=null!=this._endModel&&this._endModel.pass==Z.default.NaviModelPassType_PASS_THROUGH&&0==this._endModel.doors.length?this._seekNearRoads(this._endZoneId,o,t,30,this._endModel):this._seekNearRoads(this._endZoneId,o,t);if(null==this._endModel&&(i=!1),0<e.size()){i=!1,e.each(function(t,e,n){for(n=0;n<e.length;n++)0!=e[n].road.roadEntry&&(i=!0)});var s=0,u=!1,l=[];if(e.each(function(t,e){var n,i=e[0].road,r=a._exploreUprightLikelyJoints(a._endZoneId,o,i,e,a._endModel);0==r.length?s++:Math.abs(r[0].rotateAngle)>C.default.epsilon()?l.push.apply(l,(0,w.default)(r)):(u=!0,n=a._insertTempNodeToRoad(a._endZoneId,r[0].cross,r[0].road),a._joinTwoNodes(a._endZoneId,a._endNode,n))}),u||l.forEach(function(t){var e=a._insertTempNodeToRoad(a._endZoneId,t.cross,t.road);a._joinTwoNodes(a._endZoneId,a._endNode,e)}),s==e.size())return D.default.ROUTE_FAILED_NO_DATA_END}if(i&&null!=this._endModel&&0<this._endModel.doors.length){for(var n=null,r=!1,d=0;d<this._endModel.doors.length;d++){n=this._endModel.doors[d];var h=this._endModel.doorEntrys[d];h!=Z.default.NaviEntranceType_ENTRANCE&&h!=Z.default.NaviEntranceType_ACCESS||(this._joinTwoNodes(this._endZoneId,this._endNode,n),r=!0)}if(!r)return D.default.ROUTE_FAILED_NO_DATA_END}}},{key:"_routeCalculate",value:function(){window.DEBUG&&F.default.printRoads(this._naviGraph);var t=this._isPointInPNTModel(this._startNode.point);t&&(this._switchVariableHinderTo(this._startZoneId,t,Z.default.NaviRoadHinderType_HINDER_GENERAL),this._variableModelPairs.push({zoneId:this._startZoneId,model:t}));var e=this._isPointInPNTModel(this._endNode.point);if(e&&(this._switchVariableHinderTo(this._endZoneId,e,Z.default.NaviRoadHinderType_HINDER_GENERAL),this._variableModelPairs.push({zoneId:this._endZoneId,model:e})),this._resultVector=[],this._startZoneId==this._endZoneId){var n,i=this._zoneIdSimpleDijkstraMap.get(this._startZoneId),r=i.routeCalculate(this._startNode,this._endNode,this._mode);if(r!=D.default.ROUTE_SUCCESS)return r;var o=i.getRouteCalculateResult();this._resultVector=[],o.reverse(),(n=this._resultVector).push.apply(n,(0,w.default)(o))}else{if(-1!=this._startZoneId&&-1==this._endZoneId){var a,s,u=this._findNearZoneDoor(this._startNode.point,this._startZoneId,Z.default.NaviEntranceType_EXIT),l=this._zoneIdSimpleDijkstraMap.get(this._startZoneId),d=l.routeCalculate(this._startNode,u,this._mode);if(d!=D.default.ROUTE_SUCCESS)return d;var h=l.getRouteCalculateResult(h),f=this._zoneIdSimpleDijkstraMap.get(-1),d=f.routeCalculate(u,this._endNode,this._mode);if(d!=D.default.ROUTE_SUCCESS)return d;var c=f.getRouteCalculateResult();h.reverse(),c.reverse(),(a=this._resultVector).push.apply(a,(0,w.default)(h)),(s=this._resultVector).push.apply(s,(0,w.default)(c))}if(-1==this._startZoneId&&-1!=this._endZoneId){var p,_,v=this._findNearZoneDoor(this._endNode.point,this._endZoneId,Z.default.NaviEntranceType_ENTRANCE),y=this._zoneIdSimpleDijkstraMap.get(this._endZoneId),g=y.routeCalculate(v,this._endNode,this._mode);if(g!=D.default.ROUTE_SUCCESS)return g;var I=y.getRouteCalculateResult(),T=this._zoneIdSimpleDijkstraMap.get(-1),g=T.routeCalculate(this._startNode,v,this._mode);if(g!=D.default.ROUTE_SUCCESS)return g;var N=T.getRouteCalculateResult();N.reverse(),I.reverse(),(p=this._resultVector).push.apply(p,(0,w.default)(N)),(_=this._resultVector).push.apply(_,(0,w.default)(I))}if(-1!=this._startZoneId&&-1!=this._endZoneId){var x,m,R,E=this._findNearZoneDoor(this._startNode.point,this._startZoneId,Z.default.NaviEntranceType_EXIT),M=this._zoneIdSimpleDijkstraMap.get(this._startZoneId),k=M.routeCalculate(this._startNode,E,this._mode);if(k!=D.default.ROUTE_SUCCESS)return k;var P=M.getRouteCalculateResult(P),L=this._findNearZoneDoor(this._endNode.point,this._endZoneId,Z.default.NaviEntranceType_ENTRANCE),A=this._zoneIdSimpleDijkstraMap.get(this._endZoneId),k=A.routeCalculate(L,this._endNode,this._mode);if(k!=D.default.ROUTE_SUCCESS)return k;var O=A.getRouteCalculateResult(O),S=this._zoneIdSimpleDijkstraMap.get(-1);if(k=S.routeCalculate(E,L,this._mode),k!=D.default.ROUTE_SUCCESS)return k;var b=S.getRouteCalculateResult();P.reverse(),b.reverse(),O.reverse(),(x=this._resultVector).push.apply(x,(0,w.default)(P)),(m=this._resultVector).push.apply(m,(0,w.default)(b)),(R=this._resultVector).push.apply(R,(0,w.default)(O))}}return D.default.ROUTE_SUCCESS}},{key:"_getIndexFormID",value:function(t,e,n){for(var i=0;i<e;i++)if(null!=t[i]&&t[i].Id==n)return i;return-1}},{key:"_calcZoneIdByCoord",value:function(t){for(var e=this._naviGraph.zones,n=0;n<e.length;n++){var i=e[n];if(i.contain(t))return i.Id}return-1}},{key:"_segmentByZones",value:function(){for(var n=this,t=this._naviGraph.zones,e=0;e<t.length;e++){var i=t[e],r=this._sliceGraph(this._naviGraph,i);this._zoneIdGraph.put(i.Id,r)}this._zoneIdGraph.put(-1,this._naviGraph),this._zoneIdGraph.each(function(t,e){e.simplify(),n._zoneIdSimpleDijkstraMap.put(t,new u.default(e))}),this._zoneIdGraph.each(function(t,e){e.consoleNodeInfos(),e.consoleRoadInfos()})}},{key:"_sliceGraph",value:function(t,e){var n;if(t&&e){for(var i,r=0,o=0,a=t.roadVector.length,s=t.nodeVector.length,u=t.roadVector,l=t.nodeVector,d=0,h=new Int8Array(a),f=0;f<a;f++)u[f]&&u[f].roadEntry!=Z.default.NaviRoadEntry_FORBID&&(i=u[f],r=e.contain(i.startPoint),o=e.contain(i.endPoint),0==r&&0==o||(d=!0),1==r&&1==o&&(h[f]=1),1==r&&0==o&&(h[f]=2),0==r&&1==o&&(h[f]=3),0==r&&0==o&&(h[f]=4),2==r&&0==o&&(h[f]=6),2==r&&1==o&&(h[f]=7),0==r&&2==o&&(h[f]=8),1==r&&2==o&&(h[f]=9));if(0==d)return null;for(var c,p,_,v,y,g,I,T,N,x,m,R,E,M=new Array(s),k=new Array(a),P=0,L=new Int8Array(s),A=h.length,O=0,S=A;O<S;O++)0!=h[O]&&6!=h[O]&&8!=h[O]&&1!=h[O]&&u[O]&&(c=u[O],p=c.roadEntry,_=[c.Id],2==h[O]||9==h[O]?(v=null,v=2==h[O]?e.calcCrossPoint(c.startPoint,c.endPoint):(0,B.default)({},c.endPoint),y=new H.default,y.Id=this._naviGraph.generateNodeId(),y.nodeType=Z.default.NaviNodeType_COMMON,y.liftType=Z.default.NaviLiftType_NULL,y.entranceType=Z.default.NaviEntranceType_ACCESS,y.point=(0,B.default)({},v),g=new Y.default,g.setRoad(c),g.Id=this._naviGraph.generateRoadId(),_.push(g.Id),y.segLinks=_,I=new H.default,I.setNode(y),p==Z.default.NaviRoadEntry_FORWARD?I.entranceType=Z.default.NaviEntranceType_EXIT:p==Z.default.NaviRoadEntry_BACK&&(I.entranceType=Z.default.NaviEntranceType_ENTRANCE),e._linkAccessNodes.push(I),P=this._getIndexFormID(l,s,g.endId),g.endPoint=(0,B.default)({},I.point),g.pointVector[1]=(0,B.default)({},I.point),g.endId=I.Id,g.calcLength(),k[O]=g,M[P]=I,P=this._getIndexFormID(l,s,g.startId),M[P]=l[P],M[P].segLinks.splice(M[P].segLinks.indexOf(c.Id),1,g.Id),T=new H.default,T.setNode(y),c.startId=T.Id,c.startPoint=(0,B.default)({},T.point),c.pointVector[0]=(0,B.default)({},T.point),c.calcLength(),l[P].segLinks.splice(l[P].segLinks.indexOf(c.Id),1),l.push(T),L[P]=2):3!=h[O]&&7!=h[O]||(N=null,N=3==h[O]?e.calcCrossPoint(c.startPoint,c.endPoint):(0,B.default)({},c.startPoint),x=new H.default,x.Id=this._naviGraph.generateNodeId(),x.nodeType=Z.default.NaviNodeType_COMMON,x.liftType=Z.default.NaviLiftType_NULL,x.entranceType=Z.default.NaviEntranceType_ACCESS,x.point=(0,B.default)({},N),m=new Y.default,m.setRoad(c),m.Id=this._naviGraph.generateRoadId(),_.push(m.Id),x.segLinks=_,R=new H.default,R.setNode(x),p==Z.default.NaviRoadEntry_FORWARD?R.entranceType=Z.default.NaviEntranceType_ENTRANCE:p==Z.default.NaviRoadEntry_BACK&&(R.entranceType=Z.default.NaviEntranceType_EXIT),e._linkAccessNodes.push(R),P=this._getIndexFormID(l,s,m.startId),m.startPoint=(0,B.default)({},R.point),m.pointVector[0]=(0,B.default)({},R.point),m.startId=R.Id,m.calcLength(),k[O]=m,M[P]=R,P=this._getIndexFormID(l,s,m.endId),M[P]=l[P],M[P].segLinks.splice(M[P].segLinks.indexOf(c.Id),1,m.Id),E=new H.default,E.setNode(x),c.endId=E.Id,c.endPoint=(0,B.default)({},E.point),c.pointVector[1]=(0,B.default)({},E.point),c.calcLength(),l[P].segLinks.splice(l[P].segLinks.indexOf(c.Id),1),l.push(E),L[P]=2));for(var b,w=0,C=A;w<C;w++)1==h[w]&&(b=u[w],b&&(k[w]=b,P=this._getIndexFormID(l,s,b.startId),2!=L[P]&&(M[P]=l[P],L[P]=1),P=this._getIndexFormID(l,s,b.endId),2!=L[P]&&(M[P]=l[P],L[P]=1),u[w]=null));for(var D=0;D<s;D++)1==L[D]&&(l[D]=null);for(var F=new q.default(M,k,!0,1),z=[],V=t.obstructModels,j=0;j<V.length;j++){var G,U=V[j];U&&(G=this._modelInZone(U,e),G&&z.push(U))}return(n=F.obstructModels).push.apply(n,z),F}}},{key:"_assemblePassNotThroughModels",value:function(){var a=this;this._zoneIdGraph.each(function(t,e){for(var n=e.obstructModels,i=0;i<n.length;i++){var r,o=n[i];Z.default.NaviModelPassType_PASS_NOT_THROUGH==o.pass&&(r=a._zonePNTModelsMap.get(t),r||(r=[],a._zonePNTModelsMap.put(t,r)),r.push(o))}}),this._zonePNTModelsMap.each(function(t,e){for(var n=0;n<e.length;n++)e[n].fid})}},{key:"_assembleNotPassModels",value:function(){var a=this;this._zoneIdGraph.each(function(t,e){for(var n=e.obstructModels,i=0;i<n.length;i++){var r,o=n[i];Z.default.NaviModelPassType_NOT_PASS==o.pass&&(r=a._zoneNPModelsMap.get(t),r||(r=[],a._zoneNPModelsMap.put(t,r)),r.push(o))}}),this._zoneNPModelsMap.each(function(t,e){for(var n=0;n<e.length;n++)e[n].fid})}},{key:"_fitVariableRoadsToModel",value:function(){var u=this;this._zonePNTModelsMap.each(function(t,e){for(var n=u._zoneIdGraph.get(t).roadVector,i=0;i<e.length;i++){for(var r=e[i],o=0;o<n.length;o++){var a,s=n[o].calcMiddlePoint();C.default.pointInPolygon2d(r.points,s,r.pointCount)&&(n[o].length=n[o].length*u._kScaleVariable,a=u._modelIdRoadsMap.get(r.Id),a||(a=[],u._modelIdRoadsMap.put(r.Id,a)),a.push(n[o]))}u._switchVariableHinderTo(t,r,Z.default.NaviRoadHinderType_HINDER_HIGH)}})}},{key:"_adjustNPModelRoads",value:function(){var p=this;this._zoneNPModelsMap.each(function(t,e){for(var n=p._zoneIdGraph.get(t),i=n.roadVector,r=0;r<e.length;r++)for(var o=e[r],a=0;a<i.length;a++){var s=i[a],u=s.roadEntry,l=s.calcMiddlePoint();if(C.default.pointInPolygon2d(o.points,l,o.pointCount-1)){if(s.length=Number.MAX_VALUE,u==Z.default.NaviRoadEntry_BOTH||u==Z.default.NaviRoadEntry_FORWARD){var d=p._zoneIdGraph.get(t).adjList.get(s.startId);if(d)for(var h=0;h<d.length;h++)d[h].nodeId==s.endId&&(d[h].length=s.length)}if(s.roadEntry==Z.default.NaviRoadEntry_BOTH||s.roadEntry==Z.default.NaviRoadEntry_BACK){var f=p._zoneIdGraph.get(t).adjList.get(s.endId);if(f)for(var c=0;c<f.length;c++)f[c].nodeId==s.startId&&(f[c].length=s.length)}}}})}},{key:"_switchVariableHinderTo",value:function(t,e,n){var i=this._modelIdRoadsMap.get(e.Id);if(i){if(Z.default.NaviRoadHinderType_HINDER_HIGH==n)for(var r=0;r<i.length;r++){var o=i[r];if(o.calcLength(),o.length=i.length*this._kScaleVariable,o.roadEntry==Z.default.NaviRoadEntry_BOTH||o.roadEntry==Z.default.NaviRoadEntry_FORWARD){var a=this._zoneIdGraph.get(t).adjList.get(o.startId);if(a)for(var s=0;s<a.length;s++)a[s].nodeId==o.endId&&(a[s].length=o.length)}if(o.roadEntry==Z.default.NaviRoadEntry_BOTH||o.roadEntry==Z.default.NaviRoadEntry_BACK){var u=this._zoneIdGraph.get(t).adjList.get(o.endId);if(u)for(var l=0;l<u.length;l++)u[l].nodeId==o.startId&&(u[l].length=o.length)}}if(Z.default.NaviRoadHinderType_HINDER_GENERAL==n)for(var d=0;d<i.length;d++){var h=i[d];if(h.calcLength(),h.roadEntry==Z.default.NaviRoadEntry_BOTH||h.roadEntry==Z.default.NaviRoadEntry_FORWARD){var f=this._zoneIdGraph.get(t).adjList.get(h.startId);if(f)for(var c=0;c<f.length;c++)f[c].nodeId==h.endId&&(f[c].length=h.length)}if(h.roadEntry==Z.default.NaviRoadEntry_BOTH||h.roadEntry==Z.default.NaviRoadEntry_BACK){var p=this._zoneIdGraph.get(t).adjList.get(h.endId);if(p)for(var _=0;_<p.length;_++)p[_].nodeId==h.startId&&(p[_].length=h.length)}}}}},{key:"_findNearZoneDoor",value:function(t,e,n){var i=this._naviGraph.getZone(e);if(null==i)return null;for(var r=this._zoneIdGraph.get(e).findModel(t,o),o=r.area,a=Number.MAX_VALUE,s=null,u=0;u<i._linkAccessNodes.length;u++){var l=i._linkAccessNodes[u],d=C.default.distanceOfTwoPoints(l.point,t);if((l.entranceType==Z.default.NaviEntranceType_ACCESS||l.entranceType==n)&&d<a){var h=this._findMinAreaNearestObstructModel(e,l.point);if(h!=r){if(h.pass==Z.default.NaviModelPassType_PASS_NOT_THROUGH)continue;a=d,s=l}else a=d,s=l}}return s}},{key:"_findMinAreaNearestObstructModel",value:function(t,e){for(var n=null,i=this._zoneIdGraph.get(t),r=Number.MAX_VALUE,o=Number.MAX_VALUE,a=null,s=i.obstructModels,u=0;u<s.length;u++){var l,d=s[u],h=C.default.pointToPolygon2d(d.points,e,d.points.length-1);h<o&&(o=h,a=d),this._kDoorToler>h&&(l=d.area,l<r&&(r=l,n=d))}return null==n?a:n}},{key:"_modelInZone",value:function(t,e){if(t.bb.isSeparate(e.bb))return!1;var n=t.center;return!!C.default.pointInPolygon2d(e.points,n,e.pointCount)}},{key:"_insertTempNodeToRoad",value:function(t,e,n){var i=this._tmpAdjNodeIds.find(function(t){return t==n.startId}),r=this._tmpAdjNodeIds.find(function(t){return t==n.endId});null==i&&this._tmpAdjNodeIds.push(n.startId),null==r&&this._tmpAdjNodeIds.push(n.endId);for(var o=this._unattachedTempRoadTrees,a=null,s=0;s<o.length;s++)if(o[s]._wrappedRoad==n){a=o[s];break}if(null==a)a={},a._wrappedRoad=n,o.push(a);else for(;null!=a._fromChild;)var u=a._fromChild._wrappedRoad,a=C.default.pointIsInRect1(e,u.startPoint,u.endPoint)?a._fromChild:a._toChild;n=a._wrappedRoad;var l=new H.default;l.Id=this._newTmpId(),l.point=e;var d=new Y.default;d.Id=this._newTmpId(),d.startId=n.startId,d.startPoint=n.startPoint,d.endId=l.Id,d.endPoint=l.point,d.pointVector=[n.startPoint,l.point],d.roadRank=n.roadRank;var h=new Y.default;h.Id=this._newTmpId(),h.startId=l.Id,h.startPoint=l.point,h.endId=n.endId,h.endPoint=n.endPoint,h.pointVector=[l.point,n.endPoint],h.roadRank=n.roadRank,this._unattachedTempRoads.push(d),this._unattachedTempRoads.push(h);var f={};f._wrappedRoad=d;var c={};c._wrappedRoad=h,a._fromChild=f,a._toChild=c,l.tempType=1,d.tempType=1,h.tempType=1,d.calcLength(),h.calcLength(),d.roadEntry=n.roadEntry,h.roadEntry=n.roadEntry;var p=this._zoneIdGraph.get(t);p.nodeVector.push(l),p.roadVector.push(d),p.roadVector.push(h);var _,v,y,g=this._zoneIdSimpleDijkstraMap.get(t)._naviGraph;return g._nodeMap.put(l.Id,p.nodeVector.length-1),n.roadEntry==Z.default.NaviRoadEntry_BOTH&&(_=[],_.push({nodeId:n.startId,length:d.length}),_.push({nodeId:n.endId,length:h.length}),g.adjList.put(l.Id,_),_=g.adjList.get(n.startId),_||(_=[],g.adjList.put(n.startId,_)),_.push({nodeId:l.Id,length:d.length}),_=g.adjList.get(n.endId),_||(_=[],g.adjList.put(n.endId,_)),_.push({nodeId:l.Id,length:h.length})),n.roadEntry==Z.default.NaviRoadEntry_FORWARD&&(v=[],v.push({nodeId:n.endId,length:h.length}),g.adjList.put(l.Id,v),v=g.adjList.get(n.startId),v||(v=[],g.adjList.put(n.startId,v)),v.push({nodeId:l.Id,length:d.length})),n.roadEntry==Z.default.NaviRoadEntry_BACK&&(y=[],y.push({nodeId:n.startId,length:d.length}),g.adjList.put(l.Id,y),y=g.adjList.get(n.endId),y||(y=[],g.adjList.put(n.endId,y)),y.push({nodeId:l.Id,length:h.length})),l}},{key:"_insertItemToVector",value:function(t,e){for(var n=e.length-1;0<=n;n--)if(e[n].Id&&0<e[n].Id)return e.splice(n+1,0,t),n+1;return-1}},{key:"_insertNodeToRoad",value:function(t,e,n,i){if(i)return this._insertTempNodeToRoad(t,e,n);var r=this._zoneIdGraph.get(t),o=new H.default;o.Id=r.generateNodeId(),o.point=e;var a=new Y.default;a.Id=r.generateRoadId(),a.startId=n.startId,a.startPoint=n.startPoint,a.endId=o.Id,a.endPoint=o.point,a.pointVector=[n.startPoint,o.point];var s=new Y.default;s.Id=r.generateRoadId(),s.startId=o.Id,s.startPoint=o.point,s.endId=n.endId,s.endPoint=n.endPoint,s.pointVector=[o.point,n.endPoint];var u=[];u.push(a.Id),u.push(s.Id),o.segLinks=u,a.calcLength(),s.calcLength(),a.roadEntry=n.roadEntry,s.roadEntry=n.roadEntry;var l,d,h,f=r.nodeVector,c=r.roadVector,p=this._insertItemToVector(o,f);return this._insertItemToVector(a,c),this._insertItemToVector(s,c),r._nodeMap.put(o.Id,p),n.roadEntry==Z.default.NaviRoadEntry_BOTH&&(l=[],l.push({nodeId:n.startId,length:a.length}),l.push({nodeId:n.endId,length:s.length}),r.adjList.put(o.Id,l),l=r.adjList.get(n.startId),l||(l=[],r.adjList.put(n.startId,l)),l.push({nodeId:o.Id,length:a.length}),l=r.adjList.get(n.endId),l||(l=[],r.adjList.put(n.endId,l)),l.push({nodeId:o.Id,length:s.length})),n.roadEntry==Z.default.NaviRoadEntry_FORWARD&&(d=[],d.push({nodeId:n.endId,length:s.length}),r.adjList.put(o.Id,d),d=r.adjList.get(n.startId),d||(d=[],r.adjList.put(n.startId,d)),d.push({nodeId:o.Id,length:a.length})),n.roadEntry==Z.default.NaviRoadEntry_BACK&&(h=[],h.push({nodeId:n.startId,length:a.length}),r.adjList.put(o.Id,h),h=r.adjList.get(n.endId),h||(h=[],r.adjList.put(n.endId,h)),h.push({nodeId:o.Id,length:s.length})),o}},{key:"_clearTmpPoint",value:function(t){if(null!=t){for(var e=this._zoneIdGraph.get(t),n=e.nodeVector.length-1;0<=n;n--){var i=e.nodeVector[n];if(null==i||0<=i.Id)break;e.nodeVector.splice(n,1)}for(var r=e.roadVector.length-1;0<=r;r--){var o=e.roadVector[r];if(null==o||0<=o.Id)break;e.roadVector.splice(r,1)}}}},{key:"_deleteTmpConnectionEntirely",value:function(t,e){var n=t.get(e);if(n)for(var i=0;i<n.length;i++)n[i].nodeId<0&&(n.splice(i,1),i--)}},{key:"_removeConnection",value:function(t,e){for(var n=t.get(e),i=0;i<n.length;i++)this._deleteTmpConnectionEntirely(t,n[i].nodeId);t.remove(e)}},{key:"_calcAdherenceAtOneAngle",value:function(t,e,n,i,r,o){r.toDistance=Number.MAX_VALUE,r.stickToRoad=!1,r.rotateAngle=0;for(var a=Number.MAX_VALUE,s={},u=this._zoneIdGraph.get(t),l=0;l<u.roadVector.length;l++){var d,h,f=u.roadVector[l];null!=f&&f.roadEntry!=Z.default.NaviRoadEntry_FORBID&&(d=C.default.quickRayIntersect(e,n,f.startPoint,f.endPoint,s),d&&(h=C.default.distanceOfTwoPoints(e,s),(h<a||Math.abs(h-a)<.1&&f.Id<0)&&(a=h,r.cross=(0,B.default)({},s),r.distance=a,r.road=f,r.stickToRoad=!0)))}u=this._zoneIdGraph.get(-1);for(var c={},p=0;p<u.obstructModels.length;p++){var _=u.obstructModels[p];if(null!=_&&_!=o&&Z.default.NaviModelPassType_DECORATE!=_.pass&&(null==o||!C.default.pointInPolygon2d(_.points,o.center,_.points.length-1)))for(var v=_.points.length,y=0;y<v-1;y++){var g=C.default.quickRayIntersect(e,n,_.points[y],_.points[y+1],c);if(g){var I=C.default.distanceOfTwoPoints(e,c);if(I<a)return a=I,r.model=_,r.distance=Number.MAX_VALUE,r.stickToRoad=!1,r.obstructType=Z.default.NaviObstructType_MODEL,!1}}}for(var T={},N=u.obstructExtents,x=0;x<N.length;x++){for(var m=N[x],R=N[x].holes,E=0;E<R.length;E++)for(var M=R[E],k=0;k<M.length-1;k++){var P=C.default.quickRayIntersect(e,n,M[k],M[k+1],T);if(P){var L=C.default.distanceOfTwoPoints(e,T);if(L<a)return a=L,r.model=m,r.distance=Number.MAX_VALUE,r.stickToRoad=!1,r.obstructType=Z.default.NaviObstructType_EXTENT,!1}}for(var A=N[x].points,O=0;O<A.length-1;O++){var S=C.default.quickRayIntersect(e,n,A[O],A[O+1],T);if(S){var b=C.default.distanceOfTwoPoints(e,T);if(b<a)return a=b,r.model=m,r.distance=Number.MAX_VALUE,r.stickToRoad=!1,r.obstructType=Z.default.NaviObstructType_EXTENT,!1}}}return r.toDistance=C.default.distanceOfTwoPoints(r.cross,i),!0}},{key:"_adherenceCompare",value:function(t,e){return t.toDistance-e.toDistance}},{key:"_adherenceAngleCompare",value:function(t,e){return e.rotateAngle-t.rotateAngle}},{key:"_clearTempElements",value:function(t){var e=this._zoneIdGraph.get(t);if(e){for(var n=e.nodeVector,i=n.length-1;0<=i;i--){var r=n[i];if(null==r||0<=r.Id)break;n.splice(i,1)}for(var o=e.roadVector,a=o.length-1;0<=a;a--){var s=o[a];if(null==s||0<=s.Id)break;o.splice(a,1)}}}},{key:"_clearTempAdjList",value:function(){var s=this;this._zoneIdSimpleDijkstraMap.each(function(t,e){for(var n=[],i=e._naviGraph.adjList,r=0;r<i.keys.length;r++)i.keys[r]<0&&n.push(i.keys[r]);for(var o=0;o<n.length;o++)s._removeConnection(e._naviGraph.adjList,n[o]);for(var a=0;a<s._tmpAdjNodeIds.length;a++)s._deleteTmpConnectionEntirely(i,s._tmpAdjNodeIds[a])})}},{key:"_exploreUprightLikelyJoints",value:function(t,e,n,i,r){for(var o=[],a=0;a<i.length;a++)if(i[a].distance<C.default.epsilon())return o.push(i[a]),o;var s={x:0,y:0},u=C.default.calcFootOfUpright(e,n.startPoint,n.endPoint,s),l={};if(u&&this._isTwoPointsConnectedDirectly(e,s,l,r)){var d={};return d.cross=s,d.stickToRoad=!0,d.road=n,d.rotateAngle=0,d.dist=C.default.distanceOfTwoPoints(e,s),o.push(d),o}for(var h={x:s.x-e.x,y:s.y-e.y},f=0;f<i.length;f++){var c=i[f],p={x:c.cross.x-e.x,y:c.cross.y-e.y},_=C.default.calcRotateAngle(p,h),_=270<_?_-360:_;c.rotateAngle=_}i.sort(this._adherenceAngleCompare);var v=null,y=null;if(i[i.length-1].rotateAngle<0)return v=i[i.length-1],o.push(v),o;for(var g=0;g<i.length;g++)if(0<i[g].rotateAngle)return v=i[g],0==g?o.push(v):(y=i[g-1],C.default.distanceOfTwoPoints(v.cross,n.startPoint)>C.default.distanceOfTwoPoints(y.cross,n.startPoint)?(o.push(y),o.push(v)):(o.push(v),o.push(y))),o;return o}},{key:"_calcAllAdherance",value:function(t,e,n,i,r,o){for(var a=r||30,s=0;s<360;s+=a){var u=new l.default;this._calcAdherenceAtOneAngle(t,e,s,n,u,o),1==u.stickToRoad&&i.push(u)}i.sort(this._adherenceCompare)}},{key:"_seekNearRoads",value:function(t,e,n,i,r){var o=new d.default,a=[];for(this._calcAllAdherance(t,e,n,a,i,r);0!=a.length;){var s=a[0],u=o.get(s.road.Id);u?u.push(s):(u=[],u.push(s),o.put(s.road.Id,u)),a.splice(0,1)}return o}},{key:"_insertTmpIsolatedNode",value:function(t,e){var n=new H.default;n.Id=this._newTmpId(),n.point=(0,B.default)({},e);var i=this._zoneIdGraph.get(t);i.nodeVector.push(n);var r=this._zoneIdSimpleDijkstraMap.get(t);return r._naviGraph._nodeMap.put(n.Id,i.nodeVector.length-1),n}},{key:"_insertIsolatedNode",value:function(t,e,n){if(n)return this._insertTmpIsolatedNode(t,e);var i=new H.default;i.Id=this._naviGraph.generateNodeId(),i.point=(0,B.default)({},e);var r=this.zoneIdGraph.get(t),o=r.nodeVector,a=this._insertItemToVector(i,o);return r._nodeMap.put(i.Id,a),i}},{key:"_isTwoPointsConnectedDirectly",value:function(t,e,n,i){for(var r=this._zoneIdGraph.get(-1),o=null,a=0;a<r.obstructModels.length;a++)if(o=r.obstructModels[a],null!=o&&o!=i&&Z.default.NaviModelPassType_DECORATE!=o.pass)for(var s=o.points,u=0;u<s.length-1;u++)if(C.default.calcCrossPoint(t,e,s[u],s[u+1],n)){var l=C.default.distanceOfTwoPoints(t,n),d=C.default.distanceOfTwoPoints(e,n);if(!(l<=C.default.epsilon()||d<=C.default.epsilon()))return!1}for(var h=r.obstructExtents,f=0;f<h.length;f++){for(var c=h[f],p=c.holes,_=0;_<p.length;_++)for(var v=p[_],y=0;y<v.length-1;y++)if(C.default.calcCrossPoint(t,e,v[y],v[y+1],n))return!1;for(var g=c.points,I=0;I<g.length-1;I++)if(C.default.calcCrossPoint(t,e,g[I],g[I+1],n))return!1}return!0}},{key:"_joinTwoNodes",value:function(t,e,n,i,r,o){for(var a=0;a<this._attachedTempRoads.length;a++){var s=this._attachedTempRoads[a],u={};if(1==C.default.calcCrossPoint(s.startPoint,s.endPoint,e.point,n.point,u)&&C.default.distanceOfTwoPoints(e.point,u)>C.default.epsilon())return null}void 0===i&&(i=Z.default.NaviRoadEntry_BOTH),void 0===r&&(r=!0),void 0===o&&(o=!0);var l=new Y.default;l.startId=e.Id,l.startPoint=e.point,l.endId=n.Id,l.endPoint=n.point,l.pointVector=[e.point,n.point],l.roadRank=1,this._tmpAdjNodeIds.push(e.Id),this._tmpAdjNodeIds.push(n.Id),l.Id=r?this._newTmpId():this._naviGraph.generateRoadId(),l.roadEntry=i,l.calcLength(),o&&this._attachedTempRoads.push(l);var d=this._zoneIdGraph.get(t);d.roadVector.push(l);var h,f,c,p,_,v=this._zoneIdSimpleDijkstraMap.get(t);return Z.default.NaviRoadEntry_BOTH==i&&(h={nodeId:n.Id,length:l.length},f=v._naviGraph.adjList.get(e.Id),f?f.push(h):(f=[],f.push(h),v._naviGraph.adjList.put(e.Id,f)),h={nodeId:e.Id,length:l.length},f=v._naviGraph.adjList.get(n.Id),f?f.push(h):(f=[],f.push(h),v._naviGraph.adjList.put(n.Id,f))),Z.default.NaviRoadEntry_FORWARD==i&&(c={nodeId:n.Id,length:l.length},_=v._naviGraph.adjList.get(e.Id),_?_.push(c):(_=[],_.push(c),v._naviGraph.adjList(e.Id,_))),Z.default.NaviRoadEntry_BACK==i&&(p={nodeId:e.Id,length:l.length},_=v._naviGraph.adjList.get(n.Id),_?_.push(p):(_=[],_.push(p),v._naviGraph.adjList.put(n.Id,_))),l}},{key:"_isPointInPNTModel",value:function(t){var e=this._calcZoneIdByCoord(t),n=this._zonePNTModelsMap.get(e);if(n)for(var i=0;i<n.length;i++){var r=n[i];if(C.default.pointInPolygon2d(r.points,t,r.points.length))return r}return null}},{key:"_newTmpId",value:function(){return this._tmpId--}},{key:"assignedPts",set:function(t){this._assignedPts=t},get:function(){return this._assignedPts}}]),e}(),f=h;e.default=f},function(t,e,n){"use strict";var i=n(1),r=n(0);r(e,"__esModule",{value:!0}),e.default=void 0;var o=i(n(2)),a=i(n(3)),s=function(){function t(){(0,o.default)(this,t)}return(0,a.default)(t,null,[{key:"printRoads",value:function(){}}]),t}(),u=s;e.default=u},function(t,e,n){"use strict";var i=n(1),r=n(0);r(e,"__esModule",{value:!0}),e.default=void 0;var o=i(n(2)),a=i(n(3)),l=i(n(262)),s=function(){function t(){(0,o.default)(this,t),this._dijkCollection=[]}return(0,a.default)(t,[{key:"loadGraphs",value:function(t){var s=0,u=this;t.each(function(t,e){for(var n=e.obstructExtents,i=0;i<n.length;i++){var r=n[i].Id,o=e.getGraphByEid(r),a=new l.default(s++,o);a.gid=t,u._dijkCollection.push(a)}})}},{key:"each",value:function(t){for(var e=0;e<this._dijkCollection.length;e++)t(this._dijkCollection[e])}},{key:"len",value:function(){return this._dijkCollection.length}},{key:"get",value:function(t){return this._dijkCollection[t]}},{key:"getDijkByPoint",value:function(t,e){var n,i=this._dijkCollection;for(n in i){var r=i[n];if(t==r.gid&&r.containsPt(e))return r}return null}},{key:"getDijkById",value:function(t){var e,n=this._dijkCollection;for(e in n){var i=n[e];if(i.Id==t)return i}return null}}]),t}(),u=s;e.default=u},function(t,e,n){"use strict";var i=n(1),r=n(0);r(e,"__esModule",{value:!0}),e.default=void 0,n(50),n(32),n(17),n(67),n(143);var B=i(n(15)),w=i(n(29));n(21),n(16);var o=i(n(2)),a=i(n(3)),C=i(n(12)),Z=i(n(33)),s=i(n(41)),l=i(n(144)),H=i(n(42)),Y=i(n(96)),d=i(n(49)),u=i(n(98)),q=i(n(97)),D=i(n(48)),h=i(n(146)),f=i(n(264)),c=n(147),p=function(){function n(t,e){(0,o.default)(this,n),this.Id=t,this._startModel=null,this._endModel=null,this._naviGraph=e,this._zoneMap=new d.default,this._zoneIdGraph=new d.default,this._originDijkstra=null,this._zoneIdDijkstras=new d.default,this._resultVector=[],this._startZoneId=Number.INT_MIN,this._endZoneId=Number.INT_MIN,this._tmpId=-1,this._startNode=null,this._endNode=null,this._mode=s.default.MODULE_SHORTEST,this._zonePNTModelsMap=new d.default,this._zoneNPModelsMap=new d.default,this._modelIdRoadsMap=new d.default,this._variableModelPairs=[],this._unattachedTempRoads=[],this._attachedTempRoads=[],this._unattachedTempRoadTrees=[],this._kScaleVariable=100,this._kRemainedZoneId=-1,this._kMinModelAngle=15,this._kDoorToler=.1,this._tmp_adj_node_ids=[],this._failedInsertPts=[],this._transitNodes=[],this._segmentByZones(),this._assemblePassNotThroughModels(),this._assembleNotPassModels(),this._fitVariableRoadsToModel(),this._adjustNPModelRoads(),this._KeyNodes=new f.default(["num","id","idx","node"]),this._NtoNRoutesGraph=new d.default,this._next=new c.SmallQueue,this._visited=!1,this._lifts=[]}return(0,a.default)(n,[{key:"setWayPoints",value:function(t){this._wayPts=null==t?[]:t,this._insertWayPoints()}},{key:"setStart",value:function(t){var e;t instanceof H.default?(this._startNode=t,this._KeyNodes.append({num:this._KeyNodes.size(),id:t.Id,idx:this._naviGraph.getIdxByNodeId(t.Id),node:t})):(e=new H.default,this._insertPoint(t,e)||this._failedInsertPts.push(t),this._startNode=e,this._KeyNodes.append({num:this._KeyNodes.size(),id:e.Id,idx:this._naviGraph.getIdxByNodeId(e.Id),node:e}))}},{key:"setEnd",value:function(t){var e;t instanceof H.default?(this._endNode=t,this._KeyNodes.append({num:this._KeyNodes.size(),id:t.Id,idx:this._naviGraph.getIdxByNodeId(t.Id),node:t})):(e=new H.default,this._insertPoint(t,e)||this._failedInsertPts.push(t),this._endNode=e,this._KeyNodes.append({num:this._KeyNodes.size(),id:e.Id,idx:this._naviGraph.getIdxByNodeId(e.Id),node:e}))}},{key:"predictLift",value:function(){function t(t,e){for(var n=0,i=0;i<e.length;i++){var r=(t.x-e[i][0])*(t.x-e[i][0])+(t.y-e[i][1])*(t.y-e[i][1]);n+=Math.sqrt(r)}return n}for(var e=this._naviGraph.getAllLifts(),n=0;n<e.length;n++)e[n].dist=t(e[n].point,this.getNext()._wayPts),e[n].dist+=t(e[n].point,this._wayPts),e[n].dist=e[n].dist/(0==this.getNext()._wayPts.length?1:this.getNext()._wayPts.length),e[n].liftType==Z.default.NaviLiftType_Escalator&&(e[n].dist-=25),e[n].liftType==Z.default.NaviLiftType_Lift&&(e[n].dist-=25);for(e.sort(function(t,e){return t.dist-e.dist}),n=0;n<e.length;n++){var i=e[n];if(-1!=i.liftFloors.indexOf(this.getNext().gid)&&this.getNext().getLiftByFlag(i.liftFlag))return i}return null}},{key:"hasRelationTo",value:function(t){for(var e=this._naviGraph.getAllLifts(),n=t.gid,i=this.gid,r=0;r<e.length;r++){var o=e[r];if((Z.default.NaviLiftType_Stair==o.liftType||-1!=o.liftFloors.indexOf(n))&&null!=t.getLiftByFlag(o.liftFlag))if(o.liftEntry!=Z.default.NaviLiftEntry_UP){if(o.liftEntry!=Z.default.NaviLiftEntry_DOWN){if(o.liftEntry==Z.default.NaviLiftEntry_BOTH)return{related:!0,dist:Math.abs(i-n)}}else if(n<i)return{related:!0,dist:Math.abs(i-n)}}else if(i<n)return{related:!0,dist:Math.abs(i-n)}}return{related:!1,dist:1/0}}},{key:"getLiftByFlag",value:function(t){0==this._lifts.length&&(this._lifts=this._naviGraph.getAllLifts());for(var e=0;e<this._lifts.length;e++)if(this._lifts[e].liftFlag==t)return this._lifts[e];return null}},{key:"containsPt",value:function(t){var e=this._naviGraph.obstructExtents[0].points;return!!C.default.pointInPolygon2d(e,t,e.length)}},{key:"getRouteCalculateResult",value:function(){return this._resultVector}},{key:"dispose",value:function(){this._startModel=null,this._endModel=null,this._naviGraph.dispose(),this._naviGraph=null,this._zoneMap.clear(),this._zoneMap=null,this._zoneIdGraph.each(function(t,e){e.dispose()}),this._zoneIdGraph.clear(),this._zoneIdGraph=null,null!=this._originDijkstra&&(this._originDijkstra.dispose(),this._originDijkstra=null),this._zoneIdDijkstras.each(function(t,e){e.dispose()}),this._zoneIdDijkstras.clear(),this._zoneIdDijkstras=null,this._resultVector=[],this._startNode=null,this._endNode=null,this._zonePNTModelsMap.clear(),this._zonePNTModelsMap=null,this._zoneNPModelsMap.clear(),this._zoneNPModelsMap=null,this._modelIdRoadsMap.clear(),this._zoneNPModelsMap=null,this._variableModelPairs=[],this._unattachedTempRoads=[],this._attachedTempRoads=[],this._unattachedTempRoadTrees=[]}},{key:"reset",value:function(){this._resultVector=[],this._clearTempPoint(this._startZoneId),this._startZoneId=Number.INT_MIN,this._clearTempPoint(this._endZoneId),this._endZoneId=Number.INT_MIN,this._clearTempAdjList(),this._tmp_adj_node_ids=[],this._tmpId=-1;for(var t=0;t<this._variableModelPairs.length;t++){var e=this._variableModelPairs[t];this._switchVariableHinderTo(e.zoneId,e.model,Z.default.NaviRoadHinderType_HINDER_HIGH)}this._variableModelPairs=[],this._unattachedTempRoads=[],this._attachedTempRoads=[],this._unattachedTempRoadTrees=[]}},{key:"pushNext",value:function(t){this._next.enqueue(t)}},{key:"getNext",value:function(){return this._next.peek()}},{key:"popNext",value:function(){return this._next.dequeue()}},{key:"_createGraph",value:function(){function s(t){for(var e=0,n=0;n<t.length-1;n++){var i=t[n].point.x-t[n+1].point.x,r=t[n].point.y-t[n+1].point.y;e+=Math.sqrt(i*i+r*r)}return e}this.keyGraph=[];var u=this;this._KeyNodes.foreach(function(t){var e=t.get("node"),n=u._KeyNodes.clone();n.dropLines({node:e});var i=[];n.foreach(function(t){i.push(t.get("id"))}),u._zoneIdDijkstras.get(-1).routeMultiDestinations(e.Id,i,u._mode);var r=[];u._zoneIdDijkstras.get(-1).getMultiRoute(r);for(var o=0;o<r.length;o++){var a=r[o];u.keyGraph.push([e.Id,a[a.length-1].Id,s(a),a])}})}},{key:"computeKeyRoutes",value:function(){if(this.getNext()){var t=this.predictLift();if(!t)return!1;this.setEnd(t)}var e=[];if(this._visited){var n=this._KeyNodes.query("node",this._endNode),i=this._KeyNodes.query("node",this._startNode);this._KeyNodes.clear(),this._KeyNodes.append(n),this._KeyNodes.append(i)}else for(var r=0;r<this._transitNodes.length;r++)e.push(this._transitNodes[r].Id);this._createGraph();var o=new h.default(this.keyGraph);return o.setSId(this._startNode.Id).setEId(this._endNode.Id).setWayNodes(e),o.route(),this._route=o.getResult(),this.convertRoute(),this.getNext()&&this.getNext().setStart(this.getNext()._naviGraph.getNodeByFlag(t.liftFlag)),this._KeyNodes=new f.default(["num","id","idx","node"]),this._visited=!0,!0}},{key:"convertRoute",value:function(){this._result=[];for(var t=function(t,e){for(var n=0;n<this.length;n++)if(this[n][0]==t&&this[n][1]==e)return this[n]},e=0;e<this._route.route.length-1;e++)for(var n=this._route.route[e],i=this._route.route[e+1],r=t.apply(this.keyGraph,[n,i]),o=0;o<r[3].length;o++)this._result.push(r[3][o])}},{key:"getResult",value:function(){return this._result}},{key:"_calcPointReachable",value:function(t){var e=this._naviGraph.queryContainExtentId(t);if(-1==e)return null;var n=this._calcZoneIdByCoord(t),i=-0,r=this._zoneIdGraph.get(n).findModel(t,i);if(null==r)return{extentId:e,model:null};if(r.pass==Z.default.NaviModelPassType_PASS_THROUGH||r.pass==Z.default.NaviModelPassType_PASS_NOT_THROUGH){if(0<r.doors.length)return{extentId:e,model:r};for(var o={},a=[],s=[],u=this._zoneIdGraph.get(n),l=u.roadVector,d=!0,h=r.points.length,f=0;f<h-1;f++)for(var c=r.points[f],p=r.points[f+1],_=0;_<l.length;_++){var v=l[_];if(1==C.default.calcCrossPoint(c,p,v.startPoint,v.endPoint,o)){if(d=!1,Z.default.NaviRoadEntry_FORBID==v.roadEntry)continue;var y=new Object;y.x=o.x,y.y=o.y,a.push(y),s.push(l[_])}}if(d)return{extentId:e,model:r};if(0==a.length)return null;r.doors=[],r.doorEntrys=[],r.doorTypes=[];for(var g=0;g<a.length;g++){var I=a[g],T=s[g],N=this._insertNodeToRoad(n,I,T);N.nodeType=Z.default.NaviNodeType_COMMON,T.roadEntry==Z.default.NaviRoadEntry_BOTH?N.entranceType=Z.default.NaviEntranceType_ACCESS:C.default.pointInPolygon2d(r.points,T.startPoint,r.points.length-1)?(T.roadEntry==Z.default.NaviRoadEntry_FORWARD&&(N.entranceType=Z.default.NaviEntranceType_EXIT),T.roadEntry==Z.default.NaviRoadEntry_BACK&&(N.entranceType=Z.default.NaviEntranceType_ENTRANCE)):(T.roadEntry==Z.default.NaviRoadEntry_FORWARD&&(N.entranceType=Z.default.NaviEntranceType_ENTRANCE),T.roadEntry==Z.default.NaviRoadEntry_BACK&&(N.entranceType=Z.default.NaviEntranceType_EXIT)),r.doors.push(N),r.doorEntrys.push(N.entranceType),r.doorTypes.push(N.nodeType)}}return r.pass!=Z.default.NaviModelPassType_NOT_PASS?{extentId:e,model:r}:null}},{key:"_processStartPoint",value:function(o,t){var a=this;this._startNode=this._insertTmpIsolatedNode(this._startZoneId,o);var e=null,i=!0,e=null!=this._startModel&&this._startModel.pass==Z.default.NaviModelPassType_PASS_THROUGH&&0==this._startModel.doors.length?this._seekNearRoads(this._startZoneId,o,t,30,this._startModel):this._seekNearRoads(this._startZoneId,o,t);if(null==this._startModel&&(i=!1),0<e.size()){i=!1,e.each(function(t,e,n){for(n=0;n<e.length;n++)0!=e[n].road.roadEntry&&(i=!0)});var s=0,u=!1,l=[];if(e.each(function(t,e){var n,i=e[0].road,r=a._exploreUprightLikelyJoints(a._startZoneId,o,i,e,a._startModel);0==r.length?s++:Math.abs(r[0].rotateAngle)>C.default.epsilon()?l.push.apply(l,(0,w.default)(r)):(u=!0,n=a._insertTempNodeToRoad(a._startZoneId,r[0].cross,r[0].road),a._joinTwoNodes(a._startZoneId,a._startNode,n))}),u||l.forEach(function(t){var e=a._insertTempNodeToRoad(a._startZoneId,t.cross,t.road);a._joinTwoNodes(a._startZoneId,a._startNode,e)}),s==e.size())return D.default.ROUTE_FAILED_NO_DATA_START}if(i){for(var n=null,r=!1,d=0;d<this._startModel.doors.length;d++){n=this._startModel.doors[d];var h=this._startModel.doorEntrys[d];h!=Z.default.NaviEntranceType_EXIT&&h!=Z.default.NaviEntranceType_ACCESS||(this._joinTwoNodes(this._startZoneId,this._startNode,n),r=!0)}if(!r)return D.default.ROUTE_FAILED_NO_DATA_START}}},{key:"_processEndPoint",value:function(o,t){var a=this;this._endNode=this._insertTmpIsolatedNode(this._endZoneId,o);var e=null,i=!0,e=null!=this._endModel&&this._endModel.pass==Z.default.NaviModelPassType_PASS_THROUGH&&0==this._endModel.doors.length?this._seekNearRoads(this._endZoneId,o,t,30,this._endModel):this._seekNearRoads(this._endZoneId,o,t);if(null==this._endModel&&(i=!1),0<e.size()){i=!1,e.each(function(t,e,n){for(n=0;n<e.length;n++)0!=e[n].road.roadEntry&&(i=!0)});var s=0,u=!1,l=[];if(e.each(function(t,e){var n,i=e[0].road,r=a._exploreUprightLikelyJoints(a._endZoneId,o,i,e,a._endModel);0==r.length?s++:Math.abs(r[0].rotateAngle)>C.default.epsilon()?l.push.apply(l,(0,w.default)(r)):(u=!0,n=a._insertTempNodeToRoad(a._endZoneId,r[0].cross,r[0].road),a._joinTwoNodes(a._endZoneId,a._endNode,n))}),u||l.forEach(function(t){var e=a._insertTempNodeToRoad(a._endZoneId,t.cross,t.road);a._joinTwoNodes(a._endZoneId,a._endNode,e)}),s==e.size())return D.default.ROUTE_FAILED_NO_DATA_END}if(i){for(var n=null,r=!1,d=0;d<this._endModel.doors.length;d++){n=this._endModel.doors[d];var h=this._endModel.doorEntrys[d];h!=Z.default.NaviEntranceType_EXIT&&h!=Z.default.NaviEntranceType_ACCESS||(this._joinTwoNodes(this._endZoneId,this._endNode,n),r=!0)}if(!r)return D.default.ROUTE_FAILED_NO_DATA_END}}},{key:"_insertPoint",value:function(o,a){var s=this;o instanceof Array&&2==o.length&&(o={x:o[0],y:o[1]});var t=null,i=!0,e={x:0,y:0},u=this._naviGraph.getModelByPoint(o),l=this._naviGraph.getZoneIdByPoint(o),n=this._insertTmpIsolatedNode(l,o);if((0,B.default)(a,n),t=null!=u&&u.pass==Z.default.NaviModelPassType_PASS_THROUGH&&0==u.doors.length?this._seekNearRoads(l,o,e,30,u):this._seekNearRoads(l,o,e),null==u&&(i=!1),0<t.size()){i=!1,t.each(function(t,e,n){for(n=0;n<e.length;n++)0!=e[n].road.roadEntry&&(i=!0)});var d=0,h=!1,f=[];if(t.each(function(t,e){var n,i=e[0].road,r=s._exploreUprightLikelyJoints(l,o,i,e,u);0==r.length?d++:Math.abs(r[0].rotateAngle)>C.default.epsilon()?f.push.apply(f,(0,w.default)(r)):(h=!0,n=s._insertTempNodeToRoad(l,r[0].cross,r[0].road),s._joinTwoNodes(l,a,n))}),h||f.forEach(function(t){var e=s._insertTempNodeToRoad(l,t.cross,t.road);s._joinTwoNodes(l,a,e)}),d==t.size())return!1}if(i){for(var r=null,c=!1,p=0;p<u.doors.length;p++){r=u.doors[p];var _=u.doorEntrys[p];_!=Z.default.NaviEntranceType_EXIT&&_!=Z.default.NaviEntranceType_ACCESS||(this._joinTwoNodes(l,a,r),c=!0)}if(!c)return!1}return!0}},{key:"_routeCalculate",value:function(){var t=this._isPointInPNTModel(this._startNode.point);t&&(this._switchVariableHinderTo(this._startZoneId,t,Z.default.NaviRoadHinderType_HINDER_GENERAL),this._variableModelPairs.push({zoneId:this._startZoneId,model:t}));var e=this._isPointInPNTModel(this._endNode.point);if(e&&(this._switchVariableHinderTo(this._endZoneId,e,Z.default.NaviRoadHinderType_HINDER_GENERAL),this._variableModelPairs.push({zoneId:this._endZoneId,model:e})),this._resultVector=[],this._startZoneId==this._endZoneId){var n,i=this._zoneIdDijkstras.get(this._startZoneId),r=i.routeCalculate(this._startNode,this._endNode,this._mode);if(r!=D.default.ROUTE_SUCCESS)return r;var o=i.getRouteCalculateResult();this._resultVector=[],o.reverse(),(n=this._resultVector).push.apply(n,(0,w.default)(o))}else{if(-1!=this._startZoneId&&-1==this._endZoneId){var a,s,u=this._findNearZoneDoor(this._startNode.point,this._startZoneId,Z.default.NaviEntranceType_EXIT),l=this._zoneIdDijkstras.get(this._startZoneId),d=l.routeCalculate(this._startNode,u,this._mode);if(d!=D.default.ROUTE_SUCCESS)return d;var h=l.getRouteCalculateResult(h),f=this._zoneIdDijkstras.get(-1),d=f.routeCalculate(u,this._endNode,this._mode);if(d!=D.default.ROUTE_SUCCESS)return d;var c=f.getRouteCalculateResult();h.reverse(),c.reverse(),(a=this._resultVector).push.apply(a,(0,w.default)(h)),(s=this._resultVector).push.apply(s,(0,w.default)(c))}if(-1==this._startZoneId&&-1!=this._endZoneId){var p,_,v=this._findNearZoneDoor(this._endNode.point,this._endZoneId,Z.default.NaviEntranceType_ENTRANCE),y=this._zoneIdDijkstras.get(this._endZoneId),g=y.routeCalculate(v,this._endNode,this._mode);if(g!=D.default.ROUTE_SUCCESS)return g;var I=y.getRouteCalculateResult(),T=this._zoneIdDijkstras.get(-1),g=T.routeCalculate(this._startNode,v,this._mode);if(g!=D.default.ROUTE_SUCCESS)return g;var N=T.getRouteCalculateResult();N.reverse(),I.reverse(),(p=this._resultVector).push.apply(p,(0,w.default)(N)),(_=this._resultVector).push.apply(_,(0,w.default)(I))}if(-1!=this._startZoneId&&-1!=this._endZoneId){var x,m,R,E=this._findNearZoneDoor(this._startNode.point,this._startZoneId,Z.default.NaviEntranceType_EXIT),M=this._zoneIdDijkstras.get(this._startZoneId),k=M.routeCalculate(this._startNode,E,this._mode);if(k!=D.default.ROUTE_SUCCESS)return k;var P=M.getRouteCalculateResult(P),L=this._findNearZoneDoor(this._endNode.point,this._endZoneId,Z.default.NaviEntranceType_ENTRANCE),A=this._zoneIdDijkstras.get(this._endZoneId),k=A.routeCalculate(L,this._endNode,this._mode);if(k!=D.default.ROUTE_SUCCESS)return k;var O=A.getRouteCalculateResult(O),S=this._zoneIdDijkstras.get(-1);if(k=S.routeCalculate(E,L,this._mode),k!=D.default.ROUTE_SUCCESS)return k;var b=S.getRouteCalculateResult();P.reverse(),b.reverse(),O.reverse(),(x=this._resultVector).push.apply(x,(0,w.default)(P)),(m=this._resultVector).push.apply(m,(0,w.default)(b)),(R=this._resultVector).push.apply(R,(0,w.default)(O))}}return D.default.ROUTE_SUCCESS}},{key:"_getIndexFormID",value:function(t,e,n){for(var i=0;i<e;i++)if(null!=t[i]&&t[i].Id==n)return i;return-1}},{key:"_calcZoneIdByCoord",value:function(t){for(var e=this._naviGraph.zones,n=0;n<e.length;n++){var i=e[n];if(i.contain(t))return i.Id}return-1}},{key:"_segmentByZones",value:function(){for(var n=this,t=this._naviGraph.zones,e=0;e<t.length;e++){var i=t[e],r=this._sliceGraph(this._naviGraph,i);this._zoneIdGraph.put(i.Id,r)}this._zoneIdGraph.put(-1,this._naviGraph),this._zoneIdGraph.each(function(t,e){e.simplify(),n._zoneIdDijkstras.put(t,new u.default(e))}),this._zoneIdGraph.each(function(t,e){e.consoleNodeInfos(),e.consoleRoadInfos()})}},{key:"_sliceGraph",value:function(t,e){var n;if(t&&e){for(var i,r=0,o=0,a=t.roadVector.length,s=t.nodeVector.length,u=t.roadVector,l=t.nodeVector,d=0,h=new Int8Array(a),f=0;f<a;f++)u[f]&&u[f].roadEntry!=Z.default.NaviRoadEntry_FORBID&&(i=u[f],r=e.contain(i.startPoint),o=e.contain(i.endPoint),0==r&&0==o||(d=!0),1==r&&1==o&&(h[f]=1),1==r&&0==o&&(h[f]=2),0==r&&1==o&&(h[f]=3),0==r&&0==o&&(h[f]=4),2==r&&0==o&&(h[f]=6),2==r&&1==o&&(h[f]=7),0==r&&2==o&&(h[f]=8),1==r&&2==o&&(h[f]=9));if(0==d)return null;for(var c,p,_,v,y,g,I,T,N,x,m,R,E,M=new Array(s),k=new Array(a),P=0,L=new Int8Array(s),A=h.length,O=0,S=A;O<S;O++)0!=h[O]&&6!=h[O]&&8!=h[O]&&1!=h[O]&&u[O]&&(c=u[O],p=c.roadEntry,_=[c.Id],2==h[O]||9==h[O]?(v=null,v=2==h[O]?e.calcCrossPoint(c.startPoint,c.endPoint):(0,B.default)({},c.endPoint),y=new H.default,y.Id=this._naviGraph.generateNodeId(),y.nodeType=Z.default.NaviNodeType_COMMON,y.liftType=Z.default.NaviLiftType_NULL,y.entranceType=Z.default.NaviEntranceType_ACCESS,y.point=(0,B.default)({},v),g=new Y.default,g.setRoad(c),g.Id=this._naviGraph.generateRoadId(),_.push(g.Id),y.segLinks=_,I=new H.default,I.setNode(y),p==Z.default.NaviRoadEntry_FORWARD?I.entranceType=Z.default.NaviEntranceType_EXIT:p==Z.default.NaviRoadEntry_BACK&&(I.entranceType=Z.default.NaviEntranceType_ENTRANCE),e._linkAccessNodes.push(I),P=this._getIndexFormID(l,s,g.endId),g.endPoint=(0,B.default)({},I.point),g.pointVector[1]=(0,B.default)({},I.point),g.endId=I.Id,g.calcLength(),k[O]=g,M[P]=I,P=this._getIndexFormID(l,s,g.startId),M[P]=l[P],M[P].segLinks.splice(M[P].segLinks.indexOf(c.Id),1,g.Id),T=new H.default,T.setNode(y),c.startId=T.Id,c.startPoint=(0,B.default)({},T.point),c.pointVector[0]=(0,B.default)({},T.point),c.calcLength(),l[P].segLinks.splice(l[P].segLinks.indexOf(c.Id),1),l.push(T),L[P]=2):3!=h[O]&&7!=h[O]||(N=null,N=3==h[O]?e.calcCrossPoint(c.startPoint,c.endPoint):(0,B.default)({},c.startPoint),x=new H.default,x.Id=this._naviGraph.generateNodeId(),x.nodeType=Z.default.NaviNodeType_COMMON,x.liftType=Z.default.NaviLiftType_NULL,x.entranceType=Z.default.NaviEntranceType_ACCESS,x.point=(0,B.default)({},N),m=new Y.default,m.setRoad(c),m.Id=this._naviGraph.generateRoadId(),_.push(m.Id),x.segLinks=_,R=new H.default,R.setNode(x),p==Z.default.NaviRoadEntry_FORWARD?R.entranceType=Z.default.NaviEntranceType_ENTRANCE:p==Z.default.NaviRoadEntry_BACK&&(R.entranceType=Z.default.NaviEntranceType_EXIT),e._linkAccessNodes.push(R),P=this._getIndexFormID(l,s,m.startId),m.startPoint=(0,B.default)({},R.point),m.pointVector[0]=(0,B.default)({},R.point),m.startId=R.Id,m.calcLength(),k[O]=m,M[P]=R,P=this._getIndexFormID(l,s,m.endId),M[P]=l[P],M[P].segLinks.splice(M[P].segLinks.indexOf(c.Id),1,m.Id),E=new H.default,E.setNode(x),c.endId=E.Id,c.endPoint=(0,B.default)({},E.point),c.pointVector[1]=(0,B.default)({},E.point),c.calcLength(),l[P].segLinks.splice(l[P].segLinks.indexOf(c.Id),1),l.push(E),L[P]=2));for(var b,w=0,C=A;w<C;w++)1==h[w]&&(b=u[w],b&&(k[w]=b,P=this._getIndexFormID(l,s,b.startId),2!=L[P]&&(M[P]=l[P],L[P]=1),P=this._getIndexFormID(l,s,b.endId),2!=L[P]&&(M[P]=l[P],L[P]=1),u[w]=null));for(var D=0;D<s;D++)1==L[D]&&(l[D]=null);for(var F=new q.default(M,k,!0,1),z=[],V=t.obstructModels,j=0;j<V.length;j++){var G,U=V[j];U&&(G=this._modelInZone(U,e),G&&z.push(U))}return(n=F.obstructModels).push.apply(n,z),F}}},{key:"_assemblePassNotThroughModels",value:function(){var a=this;this._zoneIdGraph.each(function(t,e){for(var n=e.obstructModels,i=0;i<n.length;i++){var r,o=n[i];Z.default.NaviModelPassType_PASS_NOT_THROUGH==o.pass&&(r=a._zonePNTModelsMap.get(t),r||(r=[],a._zonePNTModelsMap.put(t,r)),r.push(o))}}),this._zonePNTModelsMap.each(function(t,e){for(var n=0;n<e.length;n++)e[n].fid})}},{key:"_assembleNotPassModels",value:function(){var a=this;this._zoneIdGraph.each(function(t,e){for(var n=e.obstructModels,i=0;i<n.length;i++){var r,o=n[i];Z.default.NaviModelPassType_NOT_PASS==o.pass&&(r=a._zoneNPModelsMap.get(t),r||(r=[],a._zoneNPModelsMap.put(t,r)),r.push(o))}}),this._zoneNPModelsMap.each(function(t,e){for(var n=0;n<e.length;n++)e[n].fid})}},{key:"_fitVariableRoadsToModel",value:function(){var u=this;this._zonePNTModelsMap.each(function(t,e){for(var n=u._zoneIdGraph.get(t).roadVector,i=0;i<e.length;i++){for(var r=e[i],o=0;o<n.length;o++){var a,s=n[o].calcMiddlePoint();C.default.pointInPolygon2d(r.points,s,r.pointCount)&&(n[o].length=n[o].length*u._kScaleVariable,a=u._modelIdRoadsMap.get(r.Id),a||(a=[],u._modelIdRoadsMap.put(r.Id,a)),a.push(n[o]))}u._switchVariableHinderTo(t,r,Z.default.NaviRoadHinderType_HINDER_HIGH)}})}},{key:"_insertWayPoints",value:function(){for(var t=0;t<this._wayPts.length;t++){var e=new H.default;this._insertPoint(this._wayPts[t],e)?(this._transitNodes.push(e),this._KeyNodes.append({num:this._KeyNodes.size(),id:e.Id,idx:this._naviGraph.getIdxByNodeId(e.Id),node:e})):this._failedInsertPts.push(this._wayPts[t])}}},{key:"_adjustNPModelRoads",value:function(){var p=this;this._zoneNPModelsMap.each(function(t,e){for(var n=p._zoneIdGraph.get(t),i=n.roadVector,r=0;r<e.length;r++)for(var o=e[r],a=0;a<i.length;a++){var s=i[a],u=s.roadEntry,l=s.calcMiddlePoint();if(C.default.pointInPolygon2d(o.points,l,o.pointCount-1)){if(s.length=Number.MAX_VALUE,u==Z.default.NaviRoadEntry_BOTH||u==Z.default.NaviRoadEntry_FORWARD){var d=p._zoneIdGraph.get(t).adjList.get(s.startId);if(d)for(var h=0;h<d.length;h++)d[h].nodeId==s.endId&&(d[h].length=s.length)}if(s.roadEntry==Z.default.NaviRoadEntry_BOTH||s.roadEntry==Z.default.NaviRoadEntry_BACK){var f=p._zoneIdGraph.get(t).adjList.get(s.endId);if(f)for(var c=0;c<f.length;c++)f[c].nodeId==s.startId&&(f[c].length=s.length)}}}})}},{key:"_switchVariableHinderTo",value:function(t,e,n){var i=this._modelIdRoadsMap.get(e.Id);if(i){if(Z.default.NaviRoadHinderType_HINDER_HIGH==n)for(var r=0;r<i.length;r++){var o=i[r];if(o.calcLength(),o.length=i.length*this._kScaleVariable,o.roadEntry==Z.default.NaviRoadEntry_BOTH||o.roadEntry==Z.default.NaviRoadEntry_FORWARD){var a=this._zoneIdGraph.get(t).adjList.get(o.startId);if(a)for(var s=0;s<a.length;s++)a[s].nodeId==o.endId&&(a[s].length=o.length)}if(o.roadEntry==Z.default.NaviRoadEntry_BOTH||o.roadEntry==Z.default.NaviRoadEntry_BACK){var u=this._zoneIdGraph.get(t).adjList.get(o.endId);if(u)for(var l=0;l<u.length;l++)u[l].nodeId==o.startId&&(u[l].length=o.length)}}if(Z.default.NaviRoadHinderType_HINDER_GENERAL==n)for(var d=0;d<i.length;d++){var h=i[d];if(h.calcLength(),h.roadEntry==Z.default.NaviRoadEntry_BOTH||h.roadEntry==Z.default.NaviRoadEntry_FORWARD){var f=this._zoneIdGraph.get(t).adjList.get(h.startId);if(f)for(var c=0;c<f.length;c++)f[c].nodeId==h.endId&&(f[c].length=h.length)}if(h.roadEntry==Z.default.NaviRoadEntry_BOTH||h.roadEntry==Z.default.NaviRoadEntry_BACK){var p=this._zoneIdGraph.get(t).adjList.get(h.endId);if(p)for(var _=0;_<p.length;_++)p[_].nodeId==h.startId&&(p[_].length=h.length)}}}}},{key:"_findNearZoneDoor",value:function(t,e,n){var i=this._naviGraph.getZone(e);if(null==i)return null;for(var r=this._zoneIdGraph.get(e).findModel(t,o),o=r.area,a=Number.MAX_VALUE,s=null,u=0;u<i._linkAccessNodes.length;u++){var l=i._linkAccessNodes[u],d=C.default.distanceOfTwoPoints(l.point,t);if((l.entranceType==Z.default.NaviEntranceType_ACCESS||l.entranceType==n)&&d<a){var h=this._findMinAreaNearestObstructModel(e,l.point);if(h!=r){if(h.pass==Z.default.NaviModelPassType_PASS_NOT_THROUGH)continue;a=d,s=l}else a=d,s=l}}return s}},{key:"_findMinAreaNearestObstructModel",value:function(t,e){for(var n=null,i=this._zoneIdGraph.get(t),r=Number.MAX_VALUE,o=Number.MAX_VALUE,a=null,s=i.obstructModels,u=0;u<s.length;u++){var l,d=s[u],h=C.default.pointToPolygon2d(d.points,e,d.points.length-1);h<o&&(o=h,a=d),this._kDoorToler>h&&(l=d.area,l<r&&(r=l,n=d))}return null==n?a:n}},{key:"_modelInZone",value:function(t,e){if(t.bb.isSeparate(e.bb))return!1;var n=t.center;return!!C.default.pointInPolygon2d(e.points,n,e.pointCount)}},{key:"_insertTempNodeToRoad",value:function(t,e,n){var i=this._tmp_adj_node_ids.find(function(t){return t==n.startId}),r=this._tmp_adj_node_ids.find(function(t){return t==n.endId});null==i&&this._tmp_adj_node_ids.push(n.startId),null==r&&this._tmp_adj_node_ids.push(n.endId);for(var o=this._unattachedTempRoadTrees,a=null,s=0;s<o.length;s++)if(o[s]._wrappedRoad==n){a=o[s];break}if(null==a)a={},a._wrappedRoad=n,o.push(a);else for(;null!=a._fromChild;)var u=a._fromChild._wrappedRoad,a=C.default.pointIsInRect1(e,u.startPoint,u.endPoint)?a._fromChild:a._toChild;n=a._wrappedRoad;var l=new H.default;l.Id=this._newTmpId(),l.point=e;var d=new Y.default;d.Id=this._newTmpId(),d.startId=n.startId,d.startPoint=n.startPoint,d.endId=l.Id,d.endPoint=l.point,d.pointVector=[n.startPoint,l.point];var h=new Y.default;h.Id=this._newTmpId(),h.startId=l.Id,h.startPoint=l.point,h.endId=n.endId,h.endPoint=n.endPoint,h.pointVector=[l.point,n.endPoint],this._unattachedTempRoads.push(d),this._unattachedTempRoads.push(h);var f={};f._wrappedRoad=d;var c={};c._wrappedRoad=h,a._fromChild=f,a._toChild=c,l.tempType=1,d.tempType=1,h.tempType=1,d.calcLength(),h.calcLength(),d.roadEntry=n.roadEntry,h.roadEntry=n.roadEntry;var p=this._zoneIdGraph.get(t);p.nodeVector.push(l),p.roadVector.push(d),p.roadVector.push(h);var _,v,y,g=this._zoneIdDijkstras.get(t)._naviGraph;return g._nodeMap.put(l.Id,p.nodeVector.length-1),n.roadEntry==Z.default.NaviRoadEntry_BOTH&&(_=[],_.push({nodeId:n.startId,length:d.length}),_.push({nodeId:n.endId,length:h.length}),g.adjList.put(l.Id,_),_=g.adjList.get(n.startId),_||(_=[],g.adjList.put(n.startId,_)),_.push({nodeId:l.Id,length:d.length}),_=g.adjList.get(n.endId),_||(_=[],g.adjList.put(n.endId,_)),_.push({nodeId:l.Id,length:h.length})),n.roadEntry==Z.default.NaviRoadEntry_FORWARD&&(v=[],v.push({nodeId:n.endId,length:h.length}),g.adjList.put(l.Id,v),v=g.adjList.get(n.startId),v||(v=[],g.adjList.put(n.startId,v)),v.push({nodeId:l.Id,length:d.length})),n.roadEntry==Z.default.NaviRoadEntry_BACK&&(y=[],y.push({nodeId:n.startId,length:d.length}),g.adjList.put(l.Id,y),y=g.adjList.get(n.endId),y||(y=[],g.adjList.put(n.endId,y)),y.push({nodeId:l.Id,length:h.length})),l}},{key:"_insertItemToVector",value:function(t,e){for(var n=e.length-1;0<=n;n--)if(e[n].Id&&0<e[n].Id)return e.splice(n+1,0,t),n+1;return-1}},{key:"_insertNodeToRoad",value:function(t,e,n,i){if(i)return this._insertTempNodeToRoad(t,e,n);var r=this._zoneIdGraph.get(t),o=new H.default;o.Id=r.generateNodeId(),o.point=e;var a=new Y.default;a.Id=r.generateRoadId(),a.startId=n.startId,a.startPoint=n.startPoint,a.endId=o.Id,a.endPoint=o.point,a.pointVector=[n.startPoint,o.point];var s=new Y.default;s.Id=r.generateRoadId(),s.startId=o.Id,s.startPoint=o.point,s.endId=n.endId,s.endPoint=n.endPoint,s.pointVector=[o.point,n.endPoint];var u=[];u.push(a.Id),u.push(s.Id),o.segLinks=u,a.calcLength(),s.calcLength(),a.roadEntry=n.roadEntry,s.roadEntry=n.roadEntry;var l,d,h,f=r.nodeVector,c=r.roadVector,p=this._insertItemToVector(o,f);return this._insertItemToVector(a,c),this._insertItemToVector(s,c),r._nodeMap.put(o.Id,p),n.roadEntry==Z.default.NaviRoadEntry_BOTH&&(l=[],l.push({nodeId:n.startId,length:a.length}),l.push({nodeId:n.endId,length:s.length}),r.adjList.put(o.Id,l),l=r.adjList.get(n.startId),l||(l=[],r.adjList.put(n.startId,l)),l.push({nodeId:o.Id,length:a.length}),l=r.adjList.get(n.endId),l||(l=[],r.adjList.put(n.endId,l)),l.push({nodeId:o.Id,length:s.length})),n.roadEntry==Z.default.NaviRoadEntry_FORWARD&&(d=[],d.push({nodeId:n.endId,length:s.length}),r.adjList.put(o.Id,d),d=r.adjList.get(n.startId),d||(d=[],r.adjList.put(n.startId,d)),d.push({nodeId:o.Id,length:a.length})),n.roadEntry==Z.default.NaviRoadEntry_BACK&&(h=[],h.push({nodeId:n.startId,length:a.length}),r.adjList.put(o.Id,h),h=r.adjList.get(n.endId),h||(h=[],r.adjList.put(n.endId,h)),h.push({nodeId:o.Id,length:s.length})),o}},{key:"_clearTmpPoint",value:function(t){if(null!=t){for(var e=this._zoneIdGraph.get(t),n=e.nodeVector.length-1;0<=n;n--){var i=e.nodeVector[n];if(null==i||0<=i.Id)break;e.nodeVector.splice(n,1)}for(var r=e.roadVector.length-1;0<=r;r--){var o=e.roadVector[r];if(null==o||0<=o.Id)break;e.roadVector.splice(r,1)}}}},{key:"_deleteTmpConnectionEntirely",value:function(t,e){var n=t.get(e);if(n)for(var i=0;i<n.length;i++)n[i].nodeId<0&&(n.splice(i,1),i--)}},{key:"_removeConnection",value:function(t,e){for(var n=t.get(e),i=0;i<n.length;i++)this._deleteTmpConnectionEntirely(t,n[i].nodeId);t.remove(e)}},{key:"_calcAdherenceAtAngle",value:function(t,e,n,i,r,o){r.toDistance=Number.MAX_VALUE,r.stickToRoad=!1,r.rotateAngle=0;for(var a=Number.MAX_VALUE,s={},u=this._zoneIdGraph.get(t),l=0;l<u.roadVector.length;l++){var d,h,f=u.roadVector[l];null!=f&&(d=C.default.rayCrossSegment(e,n,f.startPoint,f.endPoint,s),d&&(h=C.default.distanceOfTwoPoints(e,s),h<a&&(a=h,r.cross=(0,B.default)({},s),r.distance=a,r.road=f,r.stickToRoad=!0)))}u=this._zoneIdGraph.get(-1);for(var c={},p=0;p<u.obstructModels.length;p++){var _=u.obstructModels[p];if(null!=_&&_!=o&&Z.default.NaviModelPassType_DECORATE!=_.pass&&(null==o||!C.default.pointInPolygon2d(_.points,o.center,_.points.length-1)))for(var v=_.points.length,y=0;y<v-1;y++){var g=C.default.rayCrossSegment(e,n,_.points[y],_.points[y+1],c);if(g){var I=C.default.distanceOfTwoPoints(e,c);if(I<a)return a=I,r.model=_,r.distance=Number.MAX_VALUE,r.stickToRoad=!1,r.obstructType=Z.default.NaviObstructType_MODEL,!1}}}for(var T={},N=u.obstructExtents,x=0;x<N.length;x++){for(var m=N[x],R=N[x].holes,E=0;E<R.length;E++)for(var M=R[E],k=0;k<M.length-1;k++){var P=C.default.rayCrossSegment(e,n,M[k],M[k+1],T);if(P){var L=C.default.distanceOfTwoPoints(e,T);if(L<a)return a=L,r.model=m,r.distance=Number.MAX_VALUE,r.stickToRoad=!1,r.obstructType=Z.default.NaviObstructType_EXTENT,!1}}for(var A=N[x].points,O=0;O<A.length-1;O++){var S=C.default.rayCrossSegment(e,n,A[O],A[O+1],T);if(S){var b=C.default.distanceOfTwoPoints(e,T);if(b<a)return a=b,r.model=m,r.distance=Number.MAX_VALUE,r.stickToRoad=!1,r.obstructType=Z.default.NaviObstructType_EXTENT,!1}}}return r.toDistance=C.default.distanceOfTwoPoints(r.cross,i),!0}},{key:"_adherenceCompare",value:function(t,e){return t.toDistance-e.toDistance}},{key:"_adherenceAngleCompare",value:function(t,e){return e.rotateAngle-t.rotateAngle}},{key:"_clearTempPoint",value:function(t){var e=this._zoneIdGraph.get(t);if(e){for(var n=e.nodeVector,i=n.length-1;0<=i;i--){var r=n[i];if(null==r||0<=r.Id)break;n.splice(i,1)}for(var o=e.roadVector,a=o.length-1;0<=a;a--){var s=o[a];if(null==s||0<=s.Id)break;o.splice(a,1)}}}},{key:"_clearTempAdjList",value:function(){var s=this;this._zoneIdDijkstras.each(function(t,e){for(var n=[],i=e._naviGraph.adjList,r=0;r<i.keys.length;r++)i.keys[r]<0&&n.push(i.keys[r]);for(var o=0;o<n.length;o++)s._removeConnection(e._naviGraph.adjList,n[o]);for(var a=0;a<s._tmp_adj_node_ids.length;a++)s._deleteTmpConnectionEntirely(i,s._tmp_adj_node_ids[a])})}},{key:"_exploreUprightLikelyJoints",value:function(t,e,n,i,r){for(var o=[],a=0;a<i.length;a++)if(i[a].distance<C.default.epsilon())return o.push(i[a]),o;var s={x:0,y:0},u=C.default.calcFootOfUpright(e,n.startPoint,n.endPoint,s),l={};if(u&&this._isTwoPointsConnectedDirectly(e,s,l,r)){var d={};return d.cross=s,d.stickToRoad=!0,d.road=n,d.rotateAngle=0,d.dist=C.default.distanceOfTwoPoints(e,s),o.push(d),o}for(var h={x:s.x-e.x,y:s.y-e.y},f=0;f<i.length;f++){var c=i[f],p={x:c.cross.x-e.x,y:c.cross.y-e.y},_=C.default.calcRotateAngle(p,h),_=270<_?_-360:_;c.rotateAngle=_}i.sort(this._adherenceAngleCompare);var v=null,y=null;if(i[i.length-1].rotateAngle<0)return v=i[i.length-1],o.push(v),o;for(var g=0;g<i.length;g++)if(0<i[g].rotateAngle)return v=i[g],0==g?o.push(v):(y=i[g-1],C.default.distanceOfTwoPoints(v.cross,n.startPoint)>C.default.distanceOfTwoPoints(y.cross,n.startPoint)?(o.push(y),o.push(v)):(o.push(v),o.push(y))),o;return o}},{key:"_calcAllAdherance",value:function(t,e,n,i,r,o){for(var a=r||30,s=0;s<360;s+=a){var u=new l.default;this._calcAdherenceAtAngle(t,e,s,n,u,o),1==u.stickToRoad&&i.push(u)}i.sort(this._adherenceCompare)}},{key:"_seekNearRoads",value:function(t,e,n,i,r){var o=new d.default,a=[];for(this._calcAllAdherance(t,e,n,a,i,r);0!=a.length;){var s=a[0],u=o.get(s.road.Id);u?u.push(s):(u=[],u.push(s),o.put(s.road.Id,u)),a.splice(0,1)}return o}},{key:"_insertTmpIsolatedNode",value:function(t,e){var n=new H.default;n.Id=this._newTmpId(),n.point=(0,B.default)({},e);var i=this._zoneIdGraph.get(t);i.nodeVector.push(n);var r=this._zoneIdDijkstras.get(t);return r._naviGraph._nodeMap.put(n.Id,i.nodeVector.length-1),n}},{key:"_insertIsolatedNode",value:function(t,e,n){if(n)return this._insertTmpIsolatedNode(t,e);var i=new H.default;i.Id=this._naviGraph.generateNodeId(),i.point=(0,B.default)({},e);var r=this.zoneIdGraph.get(t),o=r.nodeVector,a=this._insertItemToVector(i,o);return r._nodeMap.put(i.Id,a),i}},{key:"_isTwoPointsConnectedDirectly",value:function(t,e,n,i){for(var r=this._zoneIdGraph.get(-1),o=null,a=0;a<r.obstructModels.length;a++)if(o=r.obstructModels[a],null!=o&&o!=i&&Z.default.NaviModelPassType_DECORATE!=o.pass)for(var s=o.points,u=0;u<s.length-1;u++)if(C.default.calcCrossPoint(t,e,s[u],s[u+1],n)){var l=C.default.distanceOfTwoPoints(t,n),d=C.default.distanceOfTwoPoints(e,n);if(!(l<=C.default.epsilon()||d<=C.default.epsilon()))return!1}for(var h=r.obstructExtents,f=0;f<h.length;f++){for(var c=h[f],p=c.holes,_=0;_<p.length;_++)for(var v=p[_],y=0;y<v.length-1;y++)if(C.default.calcCrossPoint(t,e,v[y],v[y+1],n))return!1;for(var g=c.points,I=0;I<g.length-1;I++)if(C.default.calcCrossPoint(t,e,g[I],g[I+1],n))return!1}return!0}},{key:"_joinTwoNodes",value:function(t,e,n,i,r,o){for(var a=0;a<this._attachedTempRoads.length;a++){var s=this._attachedTempRoads[a],u={};if(1==C.default.calcCrossPoint(s.startPoint,s.endPoint,e.point,n.point,u)&&C.default.distanceOfTwoPoints(e.point,u)>C.default.epsilon())return null}void 0===i&&(i=Z.default.NaviRoadEntry_BOTH),void 0===r&&(r=!0),void 0===o&&(o=!0);var l=new Y.default;l.startId=e.Id,l.startPoint=e.point,l.endId=n.Id,l.endPoint=n.point,l.pointVector=[e.point,n.point],this._tmp_adj_node_ids.push(e.Id),this._tmp_adj_node_ids.push(n.Id),l.Id=r?this._newTmpId():this._naviGraph.generateRoadId(),l.roadEntry=i,l.calcLength(),o&&this._attachedTempRoads.push(l);var d=this._zoneIdGraph.get(t);d.roadVector.push(l);var h,f,c,p,_,v=this._zoneIdDijkstras.get(t);return Z.default.NaviRoadEntry_BOTH==i&&(h={nodeId:n.Id,length:l.length},f=v._naviGraph.adjList.get(e.Id),f?f.push(h):(f=[],f.push(h),v._naviGraph.adjList.put(e.Id,f)),h={nodeId:e.Id,length:l.length},f=v._naviGraph.adjList.get(n.Id),f?f.push(h):(f=[],f.push(h),v._naviGraph.adjList.put(n.Id,f))),Z.default.NaviRoadEntry_FORWARD==i&&(c={nodeId:n.Id,length:l.length},_=v._naviGraph.adjList.get(e.Id),_?_.push(c):(_=[],_.push(c),v._naviGraph.adjList(e.Id,_))),Z.default.NaviRoadEntry_BACK==i&&(p={nodeId:e.Id,length:l.length},_=v._naviGraph.adjList.get(n.Id),_?_.push(p):(_=[],_.push(p),v._naviGraph.adjList.put(n.Id,_))),l}},{key:"_isPointInPNTModel",value:function(t){var e=this._calcZoneIdByCoord(t),n=this._zonePNTModelsMap.get(e);if(n)for(var i=0;i<n.length;i++){var r=n[i];if(C.default.pointInPolygon2d(r.points,t,r.points.length))return r}return null}},{key:"_newTmpId",value:function(){return this._tmpId--}},{key:"gid",get:function(){return this._gid},set:function(t){this._gid=t}},{key:"route",get:function(){this._route}}]),n}(),_=p;e.default=_},function(t,e,n){"use strict";var i=n(1),r=n(0);r(e,"__esModule",{value:!0}),e.default=void 0,n(50),n(32),n(17);var a=i(n(2)),s=i(n(3)),u=i(n(49)),l=function(){function e(t){(0,a.default)(this,e),this.adj=t||[]}return(0,s.default)(e,[{key:"has",value:function(t){for(var e in this.adj)if(t==e[0])return!0;return!1}},{key:"weight",value:function(t){if(null==t)return null;for(var e in this.adj)if(t==this.adj[e][0])return this.adj[e][1];return null}},{key:"append",value:function(t){this.adj.push(t)}}]),e}(),o=function(){function o(t){for(var e in(0,a.default)(this,o),this._adjTable=new u.default,t){var n=t[e][0];t[e][1],t[e][2],this._adjTable.has(n)||this._adjTable.put(n,new l);for(var i=[],r=1;r<t[e].length;r++)i.push(t[e][r]);this._adjTable.get(n).append(i)}}return(0,s.default)(o,[{key:"get",value:function(t){return this._adjTable.has(t)?this._adjTable.get(t):null}},{key:"lookup",value:function(t,e){if(this._adjTable.has(t)){var n=this._adjTable.get(t);return n.weight(e)}return null}},{key:"keys",value:function(){return this._adjTable.keys}},{key:"enhance",value:function(t,e,n){n=n||[];for(var i,r,o=this.keys(),a=1/0,s={dist:1/0,transit:null},u=0;u<o.length;u++)-1==n.indexOf(o[u])&&(i=this.lookup(t,o[u]),r=this.lookup(o[u],e),null!=i&&null!=r&&i+r<a&&(s={dist:i+r,transit:o[u]},a=i+r));return s}}]),o}(),d=o;e.default=d},function(t,e,n){"use strict";var i=n(1),r=n(0);r(e,"__esModule",{value:!0}),e.default=void 0,n(16);var o=i(n(2)),a=i(n(3)),s=function(){function n(t){if((0,o.default)(this,n),t instanceof Number){this._num=t,this._array=[];for(var e=0;e<t;e++)this._array.push(null)}if(t instanceof Array)for(this._names=t,this._array=[],e=0;e<t.length;e++)this._array.push(null)}return(0,a.default)(n,[{key:"size",value:function(){return this._array.length}},{key:"set",value:function(t,e){if(t<0||t>=this.size())throw"positon is out of bounder";this._array[t]=e}},{key:"get",value:function(t){var e=t;return"string"==typeof t&&(e=this._names.indexOf(t)),this._array[e]}},{key:"toArray",value:function(){for(var t=[],e=0;e<this._array.length;e++)t.push(this._array[e]);return t}},{key:"equals",value:function(t){if(this._array.length!=t._array.length)return!1;if(this._names.length!=t._names.length)return!1;for(var e=0;e<this._names.length;e++)if(this._names[e]!=t._names[e])return!1;return!0}},{key:"clone",value:function(){for(var t=0==this._names.length?new n(this._array.length):new n(this._names),e=0;e<this._array.length;e++)t._array[e]=this._array[e];return t}}]),n}(),u=function(){function n(t){(0,o.default)(this,n),this._names=t,this._table=[]}return(0,a.default)(n,[{key:"append",value:function(t){if(t instanceof s){var e=new s(t._names);if(!e.equals(t))throw"the appended item is not compatible to the TupleTable";this._table.push(t)}else{var n,i=new s(this._names);for(n in t){var r=this._names.indexOf(n);0<=r&&i.set(r,t[n])}this._table.push(i)}}},{key:"query",value:function(t,e){for(var n=0;n<this._table.length;n++){var i=this._table[n];if(i.get(t)==e)return i}return null}},{key:"foreach",value:function(t,e){e=e||-1;for(var n=0;n<this._table.length;n++)t(e<0?this._table[n]:this._table[n].get(e))}},{key:"size",value:function(){return this._table.length}},{key:"clone",value:function(){for(var t=new n(this._names),e=0;e<this._table.length;e++)t.append(this._table[e].clone());return t}},{key:"dropLines",value:function(t){for(var e=0;e<this._table.length;e++){var n,i=!0;for(n in t){var r=this._table[e].get(n);if(r!=t[n]){i=!1;break}}i&&(this._table.splice(e,1),e--)}}},{key:"clear",value:function(){this._table=[]}}]),n}(),l=u;e.default=l},function(t,e,n){"use strict";var i=n(1),r=n(0);r(e,"__esModule",{value:!0}),e.default=void 0;var h=i(n(47)),o=i(n(2)),a=i(n(3)),f=i(n(146)),c=i(n(266)),s=n(147),u=s.SmallQueue,l=function(){function r(t,e,n,i){(0,o.default)(this,r),this._startPt=t,this._endPt=e,this._passPts=n,this._dijkCollection=i,this._failedInsertedPts={}}return(0,a.default)(r,[{key:"_refreshPts",value:function(){var t,e={};for(t in this._passPts)for(var n=this._passPts[t],i=0;i<n.length;i++){var r,o=n[i],a=this._dijkCollection.getDijkByPoint(t,{x:o[0],y:o[1]});a?(e[a.Id]||(e[a.Id]=[]),e[a.Id].push(o)):(r=this._failedInsertedPts[t],null==r&&(this._failedInsertedPts[t]=[]),this._failedInsertedPts[t].push(o))}this._passPts=e}},{key:"_buildGraph",value:function(){this._graph=[];for(var t=0;t<this._dijkCollection.len();t++)for(var e,n,i=this._dijkCollection.get(t),r=0;r<this._dijkCollection.len();r++)t!=r&&(e=this._dijkCollection.get(r),n=i.hasRelationTo(e),n.related&&this._graph.push([i.Id,e.Id,n.dist]))}},{key:"executeCalculation",value:function(){this.reset(),this._buildGraph(),this._refreshPts();var t,e=[];for(t in this._passPts)e.push((0,h.default)(t));var n=this._dijkCollection.getDijkByPoint(this._startPt.groupID,this._startPt).Id,i=this._dijkCollection.getDijkByPoint(this._endPt.groupID,this._endPt).Id,r=new f.default(this._graph);r.setSId(n),r.setEId(i);var o=e.indexOf(n);-1!=o&&e.splice(o,1),o=e.indexOf(i),-1!=o&&e.splice(o,1),r.setWayNodes(e),r.route();var a=r.getResult();if(2==a.route.length&&a.route[0]==a.route[1]&&(a.route=[a.route[0]]),a.dist!=1/0){for(var s=[],u=0;u<a.route.length;u++){var l=this._dijkCollection.getDijkById(a.route[u]);if(l.setWayPoints(this._passPts[a.route[u]]),s.push(l),0<l._failedInsertPts.length){var d=this._failedInsertedPts[l.fid];for(null==d&&(this._failedInsertedPts[l.fid]=[]),u=0;u<l._failedInsertPts.length;u++)this._failedInsertedPts[l.fid].push(l._failedInsertPts[u])}}this._dijkList=new c.default,this._dijkList.load(s),this._dijkList.compute(this._startPt,this._endPt),this._routes=this._dijkList.routes}}},{key:"reset",value:function(){this._dijkCollection.each(function(t){t._next=new u,t._startNode=null,t._endNode=null,t._visited=!1,t._transitNodes=[],t._failedInsertPts=[]})}},{key:"routes",get:function(){return this._routes},set:function(t){this._routes=t}},{key:"failInsertedPts",get:function(){return this._failedInsertedPts}}]),r}(),d=l;e.default=d},function(t,e,n){"use strict";var i=n(1),r=n(0);r(e,"__esModule",{value:!0}),e.default=void 0;var o=i(n(2)),a=i(n(3)),s=function(){function t(){(0,o.default)(this,t),this._head=null,this.routes=[]}return(0,a.default)(t,[{key:"load",value:function(t){if(0!=t.length){this._head=t[0];for(var e=this._head,n=1;n<t.length;n++)e.pushNext(t[n]),e=t[n];e.pushNext(null)}}},{key:"compute",value:function(t,e){var n=this._head;for(n.setStart(t);n.getNext();){if(n.Id,!n.computeKeyRoutes())return!1;this.routes.push({groupId:n.gid,result:n.getResult()}),n=n.popNext()}n.setEnd(e),n.computeKeyRoutes(),this.routes.push({groupId:n.gid,result:n.getResult()})}}]),t}(),u=s;e.default=u},function(t,e,n){t.exports=n(268)},function(t,e,n){n(269);var i=n(4).Object;t.exports=function(t,e){return i.defineProperties(t,e)}},function(t,e,n){var i=n(6);i(i.S+i.F*!n(14),"Object",{defineProperties:n(111)})},function(t,e,n){t.exports=n(271)},function(t,e,n){n(272),t.exports=Math.pow(2,-52)},function(t,e,n){var i=n(6);i(i.S,"Number",{EPSILON:Math.pow(2,-52)})},function(t,e,n){"use strict";var i=n(1),r=n(0);r(e,"__esModule",{value:!0}),e.Matrix4=v;var h,f,o,a,s,u,l,d,c,p=i(n(15)),_=n(148);function v(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}(0,p.default)(v.prototype,{isMatrix4:!0,set:function(t,e,n,i,r,o,a,s,u,l,d,h,f,c,p,_){var v=this.elements;return v[0]=t,v[4]=e,v[8]=n,v[12]=i,v[1]=r,v[5]=o,v[9]=a,v[13]=s,v[2]=u,v[6]=l,v[10]=d,v[14]=h,v[3]=f,v[7]=c,v[11]=p,v[15]=_,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new v).fromArray(this.elements)},copy:function(t){var e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],this},copyPosition:function(t){var e=this.elements,n=t.elements;return e[12]=n[12],e[13]=n[13],e[14]=n[14],this},extractBasis:function(t,e,n){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this},makeBasis:function(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this},extractRotation:(c=new _.Vector3,function(t){var e=this.elements,n=t.elements,i=1/c.setFromMatrixColumn(t,0).length(),r=1/c.setFromMatrixColumn(t,1).length(),o=1/c.setFromMatrixColumn(t,2).length();return e[0]=n[0]*i,e[1]=n[1]*i,e[2]=n[2]*i,e[3]=0,e[4]=n[4]*r,e[5]=n[5]*r,e[6]=n[6]*r,e[7]=0,e[8]=n[8]*o,e[9]=n[9]*o,e[10]=n[10]*o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}),makeRotationFromEuler:function(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var e,n,i,r,o,a,s,u,l,d,h,f,c=this.elements,p=t.x,_=t.y,v=t.z,y=Math.cos(p),g=Math.sin(p),I=Math.cos(_),T=Math.sin(_),N=Math.cos(v),x=Math.sin(v);return"XYZ"===t.order?(o=y*N,a=y*x,s=g*N,u=g*x,c[0]=I*N,c[4]=-I*x,c[8]=T,c[1]=a+s*T,c[5]=o-u*T,c[9]=-g*I,c[2]=u-o*T,c[6]=s+a*T,c[10]=y*I):"YXZ"===t.order?(e=I*N,n=I*x,i=T*N,r=T*x,c[0]=e+r*g,c[4]=i*g-n,c[8]=y*T,c[1]=y*x,c[5]=y*N,c[9]=-g,c[2]=n*g-i,c[6]=r+e*g,c[10]=y*I):"ZXY"===t.order?(e=I*N,n=I*x,i=T*N,r=T*x,c[0]=e-r*g,c[4]=-y*x,c[8]=i+n*g,c[1]=n+i*g,c[5]=y*N,c[9]=r-e*g,c[2]=-y*T,c[6]=g,c[10]=y*I):"ZYX"===t.order?(o=y*N,a=y*x,s=g*N,u=g*x,c[0]=I*N,c[4]=s*T-a,c[8]=o*T+u,c[1]=I*x,c[5]=u*T+o,c[9]=a*T-s,c[2]=-T,c[6]=g*I,c[10]=y*I):"YZX"===t.order?(l=y*I,d=y*T,h=g*I,f=g*T,c[0]=I*N,c[4]=f-l*x,c[8]=h*x+d,c[1]=x,c[5]=y*N,c[9]=-g*N,c[2]=-T*N,c[6]=d*x+h,c[10]=l-f*x):"XZY"===t.order&&(l=y*I,d=y*T,h=g*I,f=g*T,c[0]=I*N,c[4]=-x,c[8]=T*N,c[1]=l*x+f,c[5]=y*N,c[9]=d*x-h,c[2]=h*x-d,c[6]=g*N,c[10]=f*x+l),c[3]=0,c[7]=0,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,this},makeRotationFromQuaternion:(l=new _.Vector3(0,0,0),d=new _.Vector3(1,1,1),function(t){return this.compose(l,t,d)}),lookAt:(a=new _.Vector3,s=new _.Vector3,u=new _.Vector3,function(t,e,n){var i=this.elements;return u.subVectors(t,e),0===u.lengthSq()&&(u.z=1),u.normalize(),a.crossVectors(n,u),0===a.lengthSq()&&(1===Math.abs(n.z)?u.x+=1e-4:u.z+=1e-4,u.normalize(),a.crossVectors(n,u)),a.normalize(),s.crossVectors(u,a),i[0]=a.x,i[4]=s.x,i[8]=u.x,i[1]=a.y,i[5]=s.y,i[9]=u.y,i[2]=a.z,i[6]=s.z,i[10]=u.z,this}),multiply:function(t,e){return void 0!==e?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var n=t.elements,i=e.elements,r=this.elements,o=n[0],a=n[4],s=n[8],u=n[12],l=n[1],d=n[5],h=n[9],f=n[13],c=n[2],p=n[6],_=n[10],v=n[14],y=n[3],g=n[7],I=n[11],T=n[15],N=i[0],x=i[4],m=i[8],R=i[12],E=i[1],M=i[5],k=i[9],P=i[13],L=i[2],A=i[6],O=i[10],S=i[14],b=i[3],w=i[7],C=i[11],D=i[15];return r[0]=o*N+a*E+s*L+u*b,r[4]=o*x+a*M+s*A+u*w,r[8]=o*m+a*k+s*O+u*C,r[12]=o*R+a*P+s*S+u*D,r[1]=l*N+d*E+h*L+f*b,r[5]=l*x+d*M+h*A+f*w,r[9]=l*m+d*k+h*O+f*C,r[13]=l*R+d*P+h*S+f*D,r[2]=c*N+p*E+_*L+v*b,r[6]=c*x+p*M+_*A+v*w,r[10]=c*m+p*k+_*O+v*C,r[14]=c*R+p*P+_*S+v*D,r[3]=y*N+g*E+I*L+T*b,r[7]=y*x+g*M+I*A+T*w,r[11]=y*m+g*k+I*O+T*C,r[15]=y*R+g*P+I*S+T*D,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this},applyToBufferAttribute:(o=new _.Vector3,function(t){for(var e=0,n=t.count;e<n;e++)o.x=t.getX(e),o.y=t.getY(e),o.z=t.getZ(e),o.applyMatrix4(this),t.setXYZ(e,o.x,o.y,o.z);return t}),determinant:function(){var t=this.elements,e=t[0],n=t[4],i=t[8],r=t[12],o=t[1],a=t[5],s=t[9],u=t[13],l=t[2],d=t[6],h=t[10],f=t[14],c=t[3],p=t[7],_=t[11],v=t[15];return c*(r*s*d-i*u*d-r*a*h+n*u*h+i*a*f-n*s*f)+p*(e*s*f-e*u*h+r*o*h-i*o*f+i*u*l-r*s*l)+_*(e*u*d-e*a*f-r*o*d+n*o*f+r*a*l-n*u*l)+v*(-i*a*l-e*s*d+e*a*h+i*o*d-n*o*h+n*s*l)},transpose:function(){var t=this.elements,e=t[1];return t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this},setPosition:function(t,e,n){var i=this.elements;return t.isVector3?(i[12]=t.x,i[13]=t.y,i[14]=t.z):(i[12]=t,i[13]=e,i[14]=n),this},getInverse:function(t,e){var n=this.elements,i=t.elements,r=i[0],o=i[1],a=i[2],s=i[3],u=i[4],l=i[5],d=i[6],h=i[7],f=i[8],c=i[9],p=i[10],_=i[11],v=i[12],y=i[13],g=i[14],I=i[15],T=c*g*h-y*p*h+y*d*_-l*g*_-c*d*I+l*p*I,N=v*p*h-f*g*h-v*d*_+u*g*_+f*d*I-u*p*I,x=f*y*h-v*c*h+v*l*_-u*y*_-f*l*I+u*c*I,m=v*c*d-f*y*d-v*l*p+u*y*p+f*l*g-u*c*g,R=r*T+o*N+a*x+s*m;if(0===R){var E="THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0";if(!0===e)throw new Error(E);return console.warn(E),this.identity()}var M=1/R;return n[0]=T*M,n[1]=(y*p*s-c*g*s-y*a*_+o*g*_+c*a*I-o*p*I)*M,n[2]=(l*g*s-y*d*s+y*a*h-o*g*h-l*a*I+o*d*I)*M,n[3]=(c*d*s-l*p*s-c*a*h+o*p*h+l*a*_-o*d*_)*M,n[4]=N*M,n[5]=(f*g*s-v*p*s+v*a*_-r*g*_-f*a*I+r*p*I)*M,n[6]=(v*d*s-u*g*s-v*a*h+r*g*h+u*a*I-r*d*I)*M,n[7]=(u*p*s-f*d*s+f*a*h-r*p*h-u*a*_+r*d*_)*M,n[8]=x*M,n[9]=(v*c*s-f*y*s-v*o*_+r*y*_+f*o*I-r*c*I)*M,n[10]=(u*y*s-v*l*s+v*o*h-r*y*h-u*o*I+r*l*I)*M,n[11]=(f*l*s-u*c*s-f*o*h+r*c*h+u*o*_-r*l*_)*M,n[12]=m*M,n[13]=(f*y*a-v*c*a+v*o*p-r*y*p-f*o*g+r*c*g)*M,n[14]=(v*l*a-u*y*a-v*o*d+r*y*d+u*o*g-r*l*g)*M,n[15]=(u*c*a-f*l*a+f*o*d-r*c*d-u*o*p+r*l*p)*M,this},scale:function(t){var e=this.elements,n=t.x,i=t.y,r=t.z;return e[0]*=n,e[4]*=i,e[8]*=r,e[1]*=n,e[5]*=i,e[9]*=r,e[2]*=n,e[6]*=i,e[10]*=r,e[3]*=n,e[7]*=i,e[11]*=r,this},getMaxScaleOnAxis:function(){var t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],i=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,n,i))},makeTranslation:function(t,e,n){return this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this},makeRotationX:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(1,0,0,0,0,e,-n,0,0,n,e,0,0,0,0,1),this},makeRotationY:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(e,0,n,0,0,1,0,0,-n,0,e,0,0,0,0,1),this},makeRotationZ:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,0,n,e,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,e){var n=Math.cos(e),i=Math.sin(e),r=1-n,o=t.x,a=t.y,s=t.z,u=r*o,l=r*a;return this.set(u*o+n,u*a-i*s,u*s+i*a,0,u*a+i*s,l*a+n,l*s-i*o,0,u*s-i*a,l*s+i*o,r*s*s+n,0,0,0,0,1),this},makeScale:function(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this},makeShear:function(t,e,n){return this.set(1,e,n,0,t,1,n,0,t,e,1,0,0,0,0,1),this},compose:function(t,e,n){var i=this.elements,r=e._x,o=e._y,a=e._z,s=e._w,u=r+r,l=o+o,d=a+a,h=r*u,f=r*l,c=r*d,p=o*l,_=o*d,v=a*d,y=s*u,g=s*l,I=s*d,T=n.x,N=n.y,x=n.z;return i[0]=(1-(p+v))*T,i[1]=(f+I)*T,i[2]=(c-g)*T,i[3]=0,i[4]=(f-I)*N,i[5]=(1-(h+v))*N,i[6]=(_+y)*N,i[7]=0,i[8]=(c+g)*x,i[9]=(_-y)*x,i[10]=(1-(h+p))*x,i[11]=0,i[12]=t.x,i[13]=t.y,i[14]=t.z,i[15]=1,this},decompose:(h=new _.Vector3,f=new v,function(t,e,n){var i=this.elements,r=h.set(i[0],i[1],i[2]).length(),o=h.set(i[4],i[5],i[6]).length(),a=h.set(i[8],i[9],i[10]).length(),s=this.determinant();s<0&&(r=-r),t.x=i[12],t.y=i[13],t.z=i[14],f.copy(this);var u=1/r,l=1/o,d=1/a;return f.elements[0]*=u,f.elements[1]*=u,f.elements[2]*=u,f.elements[4]*=l,f.elements[5]*=l,f.elements[6]*=l,f.elements[8]*=d,f.elements[9]*=d,f.elements[10]*=d,e.setFromRotationMatrix(f),n.x=r,n.y=o,n.z=a,this}),makePerspective:function(t,e,n,i,r,o){void 0===o&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var a=this.elements,s=2*r/(e-t),u=2*r/(n-i),l=(e+t)/(e-t),d=(n+i)/(n-i),h=-(o+r)/(o-r),f=-2*o*r/(o-r);return a[0]=s,a[4]=0,a[8]=l,a[12]=0,a[1]=0,a[5]=u,a[9]=d,a[13]=0,a[2]=0,a[6]=0,a[10]=h,a[14]=f,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this},makeOrthographic:function(t,e,n,i,r,o){var a=this.elements,s=1/(e-t),u=1/(n-i),l=1/(o-r),d=(e+t)*s,h=(n+i)*u,f=(o+r)*l;return a[0]=2*s,a[4]=0,a[8]=0,a[12]=-d,a[1]=0,a[5]=2*u,a[9]=0,a[13]=-h,a[2]=0,a[6]=0,a[10]=-2*l,a[14]=-f,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this},equals:function(t){for(var e=this.elements,n=t.elements,i=0;i<16;i++)if(e[i]!==n[i])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var n=0;n<16;n++)this.elements[n]=t[n+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t}})},function(t,e,n){"use strict";var i=n(1),r=n(0);r(e,"__esModule",{value:!0}),e.default=void 0,n(16);var o=i(n(275)),g=o.default;function a(t,e){e=e||1;for(var n=Number.MAX_VALUE,i=Number.MAX_VALUE,r=Number.MIN_VALUE,o=Number.MIN_VALUE,a=0;a<t[0].length;a++){var s=t[0][a];s[0]<n&&(n=s[0]),s[1]<i&&(i=s[1]),s[0]>r&&(r=s[0]),s[1]>o&&(o=s[1])}var u=r-n,l=o-i,d=Math.min(u,l),h=d/2;if(0===d)return[n,i];for(var f=new g(void 0,I),c=n;c<r;c+=d)for(var p=i;p<o;p+=d)f.push(new T(c+h,p+h,h,t));var _=N(t),v=new T(n+u/2,i+l/2,0,t);for(v.d>_.d&&(_=v),f.length;0<f.length;){var y=f.pop();y.d>_.d&&(_=y),y.max-_.d<=e||(h=y.h/2,f.push(new T(y.x-h,y.y-h,h,t)),f.push(new T(y.x+h,y.y-h,h,t)),f.push(new T(y.x-h,y.y+h,h,t)),f.push(new T(y.x+h,y.y+h,h,t)))}return[_.x,_.y]}function I(t,e){return e.max-t.max}function T(t,e,n,i){this.x=t,this.y=e,this.h=n,this.d=s(t,e,i),this.max=this.d+this.h*Math.SQRT2}function s(t,e,n){for(var i=!1,r=1/0,o=0;o<n.length;o++)for(var a=n[o],s=0,u=a.length,l=u-1;s<u;l=s++){var d=a[s],h=a[l];d[1]>e!=h[1]>e&&t<(h[0]-d[0])*(e-d[1])/(h[1]-d[1])+d[0]&&(i=!i),r=Math.min(r,f(t,e,d,h))}return(i?1:-1)*Math.sqrt(r)}function N(t){for(var e=0,n=0,i=0,r=t[0],o=0,a=r.length,s=a-1;o<a;s=o++){var u=r[o],l=r[s],d=u[0]*l[1]-l[0]*u[1];n+=(u[0]+l[0])*d,i+=(u[1]+l[1])*d,e+=3*d}return 0===e?new T(r[0][0],r[0][1],0,t):new T(n/e,i/e,0,t)}function f(t,e,n,i){var r,o=n[0],a=n[1],s=i[0]-o,u=i[1]-a,l=o,d=a;return 0===s&&0===u||(r=((t-o)*s+(e-a)*u)/(s*s+u*u),1<r?(l=i[0],d=i[1]):0<r&&(l+=s*r,d+=u*r)),s=t-l,u=e-d,s*s+u*u}var u=a;e.default=u},function(t,e,n){"use strict";var i=n(1),r=n(0);r(e,"__esModule",{value:!0}),e.default=void 0;var a=i(n(2)),s=i(n(3)),o=function(){function o(t,e){var n=0<arguments.length&&void 0!==t?arguments[0]:[],i=1<arguments.length&&void 0!==e?arguments[1]:u;if((0,a.default)(this,o),this.data=n,this.length=this.data.length,this.compare=i,0<this.length)for(var r=(this.length>>1)-1;0<=r;r--)this._down(r)}return(0,s.default)(o,[{key:"push",value:function(t){this.data.push(t),this.length++,this._up(this.length-1)}},{key:"pop",value:function(){if(0!==this.length){var t=this.data[0],e=this.data.pop();return this.length--,0<this.length&&(this.data[0]=e,this._down(0)),t}}},{key:"peek",value:function(){return this.data[0]}},{key:"_up",value:function(t){for(var e=this.data,n=this.compare,i=e[t];0<t;){var r=t-1>>1,o=e[r];if(0<=n(i,o))break;e[t]=o,t=r}e[t]=i}},{key:"_down",value:function(t){for(var e=this.data,n=this.compare,i=this.length>>1,r=e[t];t<i;){var o=1+(t<<1),a=e[o],s=o+1;if(s<this.length&&n(e[s],a)<0&&(o=s,a=e[s]),0<=n(a,r))break;e[t]=a,t=o}e[t]=r}}]),o}();function u(t,e){return t<e?-1:e<t?1:0}var l=o;e.default=l}],i={},r.m=n,r.c=i,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=150).default;function r(t){if(i[t])return i[t].exports;var e=i[t]={i:t,l:!1,exports:{}};return n[t].call(e.exports,e,e.exports,r),e.l=!0,e.exports}var n,i});