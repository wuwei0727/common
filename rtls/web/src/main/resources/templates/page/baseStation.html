<!DOCTYPE html>
<html xmlns:shiro="http://www.pollix.at/thymeleaf/shiro">
<head>
    <meta charset="UTF-8">
    <title>蓝牙信标</title>
    <link rel="stylesheet" href="../css/common/common.css"/>
    <link rel="stylesheet" href="../css/list.css"/>
    <link rel="stylesheet" href="../css/permiss.css"/>
    <script src="../js/common/jquery-1.8.0.min.js"></script>
    <script src="../js/common/url.js"></script>
    <script src="../js/common/common.js"></script>
    <script src="../js/common/page.js"></script>
    <script src="../fMap/2/fengmap.core.min.js"></script>
    <script src="../fMap/2/fengmap.control.min.js"></script>
    <script src="../js/common/initFmap3.js"></script>
    <script src="../js/baseStation.js"></script>
</head>
<body>
    <div class="contentTop">
        <span class="contentTitle">蓝牙信标</span>
        <div class="search">
            <div class="searchItem">
                设备编号：<input type="text" onkeyup="this.value=this.value.replace(/\s/g,'')" name="num" id="num"
                    class="searchInp" autocomplete="off" placeholder="请输入编号ID" style="width: 112px;" />
            </div>

            <div class="searchItem seleBox">
                关联地图：
                <div class="batchBox mapWidth" onclick="switchSele(event)">
                    <div name="map" class="batchTxt" data-val="">--请选择关联地图--</div>
                    <div class="batchList" id="mapSelect1">
                        <div onclick="seleBatch(this,'')">--请选择关联地图--</div>
                    </div>
                </div>
            </div>

        <div class="searchItem seleBox">
            网络状态：
            <div class="batchBox" onclick="switchSele(event)">
                <div name="networkstate" class="batchTxt" data-val="">全部</div>
                <div class="batchList">
                    <div onclick="seleBatch(this,'')">全部</div>
                    <div onclick="seleBatch(this,'0')">离线</div>
                    <div onclick="seleBatch(this,'1')">在线</div>
                        <!-- <div onclick="seleBatch(this,'2')">低电量</div> -->
                    </div>
                </div>
            </div>

            <div class="searchItem seleBox">
                电量：
                <div class="batchBox" onclick="switchSele(event)">
                    <div name="power" class="batchTxt" data-val="">全部</div>
                    <div class="batchList">
                        <div onclick="seleBatch(this,'')">全部</div>
                        <div onclick="seleBatch(this,'100')">100%</div>
                        <div onclick="seleBatch(this,'50')">100%-50%</div>
                        <div onclick="seleBatch(this,'30')">50%-30%</div>
                        <div onclick="seleBatch(this,'10')">30%-0%</div>
                </div>
            </div>
        </div>

            <div class="searchItem seleBox">
                类型：
                <div class="batchBox" onclick="switchSele(event)">
                    <div name="typeName" class="batchTxt" data-val="">全部</div>
                    <div class="batchList">
                        <div onclick="seleBatch(this,'')">全部</div>
                        <div onclick="seleBatch(this,'1')">信标</div>
                        <div onclick="seleBatch(this,'7')">道钉</div>
                    </div>
                </div>
            </div>

            <div class="searchItem seleBox">
                巡检筛选：
                <div class="batchBox" onclick="switchSele(event)">
                    <div name="day" class="batchTxt" data-val="-1">全部</div>
                    <div class="batchList">
                        <div onclick="seleBatch(this,'')">全部</div>
                        <!--					<div onclick="seleBatch(this,'-1')">正常</div>-->
                        <div onclick="seleBatch(this,'7')">7天之前异常</div>
                        <div onclick="seleBatch(this,'30')">30天之前异常</div>
                        <div onclick="seleBatch(this,'180')">180天之前异常</div>
                    </div>
                </div>
            </div>

            <div class="searchItem">
                楼层：<input type="text" onkeyup="this.value=this.value.replace(/\s/g,'')" name="floorName" id="floorName"
                    class="searchInp" autocomplete="off" placeholder="请输入楼层" style="width: 112px;" />
            </div>

            <span class="searchBtn" onclick="search()">搜索</span>
            <span class="searchBtn resetBtn" onclick="resetSearch()">重置</span>
            <shiro:haspermission name="sub:ubl">
                <span class="searchBtn resetBtn" onclick="updateLife()">更新使用寿命</span>
            </shiro:haspermission>
            <span class="searchBtn resetBtn" onclick="bluetooth()">蓝牙信标重置</span>

<!--        <span class="searchBtn resetBtn">-->
<!--            <input type="file" onchange="importSub(this)" id="impId" name="impId" accept=".xls,.xlsx" class="importInput"/>导入-->
<!--        </span>-->
			<span class="searchBtn resetBtn" onclick="exportShow()">导出</span>
    </div>
</div>
<!-- 信息 -->
<div class="wrap">
    <table class="tab" id="tab">
        <thead>
        <tr>
            <td name="line" class="line">序号</td>
            <td name="num">
                设备编号
                <span class="tabSort" onclick="tabSort(this,'num')"></span>
            </td>
            <td name="power">
                电量
                <span class="tabSort" onclick="tabSort(this,'power')"></span>
            </td>
            <td name="mapName">关联地图</td>
			<td name="floorName">楼层</td>
            <td name="networkName">网络状态</td>
            <td name="batteryVolt">
                电压
                <span class="tabSort" onclick="tabSort(this,'batteryVolt')"></span>
            </td>
            <td name="addTime">
                创建时间
                <span class="tabSort" onclick="tabSort1(this,'addTime')"></span>
            </td>
            <td name="updateTime">
                更新时间
                <span class="tabSort" onclick="tabSort1(this,'updateTime')"></span>
            </td>
            <td name="batteryTime">
                电压检测时间
                <span class="tabSort" onclick="tabSort1(this,'batteryTime')"></span>
            </td>
                    <td name="typeName">类型</td>
            <td name="operating">操作</td>
        </tr>
        </thead>
        <tbody></tbody>
    </table>
    <div class="listFooter clearfix">
        <label class="seleLabel">
            <input id="allCheck" onclick="allCheck(this)" type="checkbox" class="tabCheck" name="tabCheck">
            <span class="seleIcon"></span>全选
        </label>

        <shiro:hasPermission name="sub:del">
            <span class="deleBtn" onclick="showAllDele()">删除</span>
        </shiro:hasPermission>

        <div class="page">
            <span id="total" class="total"></span>
            <span class="turnPage prev" onclick="prevPage()"></span>
            <ul class="pageList"></ul>
            <span class="turnPage next" onclick="nextPage(this)"></span>
            跳至<input type="text" value="1" class="jumpPage" onkeyup="jumpCurPage(this,event)"/>页
        </div>
    </div>
</div>
<!-- 提示 -->
<div class="tips" id="tip"></div>
<!-- 遮罩 -->
<div class="mask" id="mask"></div>
<!-- 确认提示框 -->
<div class="confimPop" id="delePop">
    <div class="confimPopTop">
        <span class="popClose" onclick="hidePop('#delePop')"></span>
    </div>
    <div class="confimPopInfo">
        <p class="confimPopTitle">是否删除？</p>
        <p class="txtOverFlow">蓝牙信标：<span id="deleTxt"></span></p>
    </div>
    <div class="confimPopFooter">
        <span class="confimPopEnt" onclick="entDele()">确定</span><span class="confimPopCancel"
                                                                      onclick="hidePop('#delePop')">取消</span>
    </div>
</div>

    <!-- 蓝牙信标 -->
    <div class="permissPop main" id="permissPop">
        <div class="popTop">
            蓝牙信标<span id="saveTxt"></span>
            <span class="popClose" onclick="closePop('#permissPop')"></span>
        </div>
        <!-- 占位显示（虚化） -->
        <div style="height: 1px"></div>
        <div class="popCen">
            <div class="mainItemB">
                <span class="itemTxt"><span class="require">*</span>地图:</span>
                <div class="searchItem seleBoxmap">
                    <div class="batchBox" onclick="switchSele(event)" style="width: 220px;">
                        <div name="map" class="batchTxt" data-val="">--请选择--</div>
                        <div class="batchList" id="mapSelect">
                            <div onclick="seleBatch(this,'')">--请选择--</div>
                        </div>
                    </div>
                </div>
            </div>
            <shiro:haspermission name="sub:ubl">
            <div class="managBtnCen" id="exportText" onclick="save()">保存</div>
            </shiro:haspermission>

        </div>
    </div>

    <div class="permissPop main" id="permissPop2">
        <div class="popTop">
            蓝牙信标<span id="saveTxt"></span>
            <span class="popClose" onclick="closePop('#permissPop2')"></span>
        </div>
        <!-- 占位显示（虚化） -->
        <div style="height: 1px"></div>
        <div class="popCen2">
            <div class="mainItemB">
                <span class="itemTxt"><span class="require">*</span>地图:</span>
                <div class="searchItem seleBoxmap">
                    <div class="batchBox" onclick="switchSele(event)" style="width: 220px;">
                        <div name="map" class="batchTxt" data-val="">--请选择--</div>
                        <div class="batchList" id="mapSelect2">
                            <div onclick="seleBatch(this,'')">--请选择--</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="mainItemB">
                <span class="itemTxt"><span class="require">*</span>类型:</span>
                <div class="searchItem seleBoxmap">
                    <div class="batchBox" onclick="switchSele(event)" style="width: 220px;">
                        <div name="type" class="batchTxt" data-val="">--请选择--</div>
                        <div class="batchList">
                            <div onclick="seleBatch(this,'1')">信标</div>
                            <div onclick="seleBatch(this,'7')">道钉</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="mainItemB">
                <span class="itemTxt"><span class="require">*</span>使用寿命(月):</span>
                <input class="itemInput" type="number" name="lifetimeMonths" style="width: 220px;" placeholder="请输入" />
            </div>

            <div class="managBtnCen" id="exportText" onclick="save2()" style="margin-bottom: 20px;">保存</div>

        </div>
    </div>

    <!-- 蓝牙信标所在位置 -->
    <div class="mapPop" id="mapPop">
        <div class="mapPopTop">
            蓝牙信标所在位置
            <div class="close" onclick="hidePop('#mapPop')"></div>
        </div>
        <div class="fengmap" id="fengmap">
            <!--设备控件，2D/3D切换-->
            <div class="viewMode3">
                <div class="viewMode" onclick="changeMode(this)"></div>
            </div>
            <!--加载logo-->
            <div class="layer1Img">
                <img src="../image/common/PARKHome2.png" class="imgs1">
            </div>
        </div>
    </div>

<div id="operating" class="hidden">
        <shiro:hasAnyPermissions name="sub:see,sub:edit">
            <span class="tabOper" id="editBtn">详情</span>
        </shiro:hasAnyPermissions>

        <shiro:hasPermission name="sub:del">
            <span class="tabOper deleOpa" id="deleteBtn">删除</span>
        </shiro:hasPermission>
</div>
<iframe id="editFrame" class="frameClass"></iframe>
</body>
<script>
    //回车搜索
    $("#num").keydown(function (event) {
        if (event.keyCode === 13) {
            search(); //搜索
        }
    });
</script>
</html>