/**Released Version v3.1.3,BUILD 653,Time 1691032746675. Fengmap Javascript SDK , see: https://www.fengmap.com for details**/
!function(t,i){"object"==typeof exports&&"object"==typeof module?module.exports=i():"function"==typeof define&&define.amd?define([],i):"object"==typeof exports?exports.fengmap=i():t.fengmap=i()}(this,function(){return n=[function(A,F,L){"use strict";L.r(F);var L={MODULE_SHORTEST:1,MODULE_BEST:2},Y={PRIORITY_DEFAULT:1,PRIORITY_LIFTFIRST:2,PRIORITY_ESCALATORFIRST:3,PRIORITY_STAIRFIRST:4,PRIORITY_LIFTONLY:5,PRIORITY_ESCALATORONLY:6,PRIORITY_STAIRONLY:7,PRIORITY_ACCESSIBLEONLY:8,PRIORITY_LIFTFIRST1:9,PRIORITY_ESCALATORFIRST1:10,PRIORITY_STAIRFIRST1:11},V={ZH:"zh",EN:"en"};function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Z(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==r(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===r(t)?t:String(t)}(e.key),e)}}function z(t,i,n){return i&&Z(t.prototype,i),n&&Z(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}var t=z(function t(){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function")}),B=(Object.assign(t.prototype,{h:function(t,i){void 0===this.u&&(this.u={});var n=this.u;void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(i)&&n[t].push(i)},v:function(t,i){var n;return void 0!==this.u&&void 0!==(n=this.u)[t]&&-1!==n[t].indexOf(i)},M:function(t,i){var n;void 0!==this.u&&void 0!==(t=this.u[t])&&-1!==(n=t.indexOf(i))&&t.splice(n,1)},k:function(t){if(void 0!==this.u){var i=this.u[t.type];if(void 0!==i)for(var n=i.slice(0),e=0,r=n.length;e<r;e++)n[e].call(this,t)}}}),t);function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function U(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==s(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==s(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===s(t)?t:String(t)}(e.key),e)}}var X=function(){function i(t){if(!(this instanceof i))throw new TypeError("Cannot call a class as a function");this.autoStart=void 0===t||t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}var t,n,e;return t=i,(n=[{key:"start",value:function(){this.startTime=H(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}},{key:"stop",value:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}},{key:"getElapsedTime",value:function(){return this.getDelta(),this.elapsedTime}},{key:"getDelta",value:function(){var t,i=0;return this.autoStart&&!this.running?(this.start(),0):(this.running&&(i=((t=H())-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=i),i)}}])&&U(t.prototype,n),e&&U(t,e),Object.defineProperty(t,"prototype",{writable:!1}),i}();function H(){return("undefined"==typeof performance?Date:performance).now()}for(var o=[],i=0;i<256;i++)o[i]=(i<16?"0":"")+i.toString(16);var n=1234567,e={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var t=4294967295*Math.random()|0,i=4294967295*Math.random()|0,n=4294967295*Math.random()|0,e=4294967295*Math.random()|0;return(o[255&t]+o[t>>8&255]+o[t>>16&255]+o[t>>24&255]+"-"+o[255&i]+o[i>>8&255]+"-"+o[i>>16&15|64]+o[i>>24&255]+"-"+o[63&n|128]+o[n>>8&255]+"-"+o[n>>16&255]+o[n>>24&255]+o[255&e]+o[e>>8&255]+o[e>>16&255]+o[e>>24&255]).toUpperCase()},clamp:function(t,i,n){return Math.max(i,Math.min(n,t))},euclideanModulo:function(t,i){return(t%i+i)%i},mapLinear:function(t,i,n,e,r){return e+(t-i)*(r-e)/(n-i)},lerp:function(t,i,n){return(1-n)*t+n*i},smoothstep:function(t,i,n){return t<=i?0:n<=t?1:(t=(t-i)/(n-i))*t*(3-2*t)},smootherstep:function(t,i,n){return t<=i?0:n<=t?1:(t=(t-i)/(n-i))*t*t*(t*(6*t-15)+10)},randInt:function(t,i){return t+Math.floor(Math.random()*(i-t+1))},randFloat:function(t,i){return t+Math.random()*(i-t)},randFloatSpread:function(t){return t*(.5-Math.random())},seededRandom:function(t){return((n=16807*(n=void 0!==t?t%2147483647:n)%2147483647)-1)/2147483646},degToRad:function(t){return t*e.DEG2RAD},radToDeg:function(t){return t*e.RAD2DEG},isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},setQuaternionFromProperEuler:function(t,i,n,e,r){var s=Math.cos,o=Math.sin,h=s(n/2),u=o(n/2),a=s((i+e)/2),f=o((i+e)/2),c=s((i-e)/2),l=o((i-e)/2),v=s((e-i)/2),y=o((e-i)/2);switch(r){case"XYX":t.set(h*f,u*c,u*l,h*a);break;case"YZY":t.set(u*l,h*f,u*c,h*a);break;case"ZXZ":t.set(u*c,u*l,h*f,h*a);break;case"XZX":t.set(h*f,u*y,u*v,h*a);break;case"YXY":t.set(u*v,h*f,u*y,h*a);break;case"ZYZ":t.set(u*y,u*v,h*f,h*a);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}};function h(t){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Q(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==h(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==h(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===h(t)?t:String(t)}(e.key),e)}}t=function(){function o(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,e=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1,r=this,s=o;if(!(r instanceof s))throw new TypeError("Cannot call a class as a function");Object.defineProperty(this,"isQuaternion",{value:!0}),this.g=t,this.S=i,this.j=n,this._=e}var t,i,n;return t=o,n=[{key:"slerp",value:function(t,i,n,e){return n.copy(t).slerp(i,e)}},{key:"slerpFlat",value:function(t,i,n,e,r,s,o){var h,u,a,f=n[e+0],c=n[e+1],l=n[e+2],n=n[e+3],e=r[s+0],v=r[s+1],y=r[s+2],r=r[s+3];n===r&&f===e&&c===v&&l===y||(s=1-o,h=0<=(u=f*e+c*v+l*y+n*r)?1:-1,(a=1-u*u)>Number.EPSILON&&(a=Math.sqrt(a),u=Math.atan2(a,u*h),s=Math.sin(s*u)/a,o=Math.sin(o*u)/a),f=f*s+e*(u=o*h),c=c*s+v*u,l=l*s+y*u,n=n*s+r*u,s===1-o&&(f*=a=1/Math.sqrt(f*f+c*c+l*l+n*n),c*=a,l*=a,n*=a)),t[i]=f,t[i+1]=c,t[i+2]=l,t[i+3]=n}},{key:"multiplyQuaternionsFlat",value:function(t,i,n,e,r,s){var o=n[e],h=n[e+1],u=n[e+2],n=n[e+3],e=r[s],a=r[s+1],f=r[s+2],r=r[s+3];return t[i]=o*r+n*e+h*f-u*a,t[i+1]=h*r+n*a+u*e-o*f,t[i+2]=u*r+n*f+o*a-h*e,t[i+3]=n*r-o*e-h*a-u*f,t}}],(i=[{key:"x",get:function(){return this.g},set:function(t){this.g=t,this.O()}},{key:"y",get:function(){return this.S},set:function(t){this.S=t,this.O()}},{key:"z",get:function(){return this.j},set:function(t){this.j=t,this.O()}},{key:"w",get:function(){return this._},set:function(t){this._=t,this.O()}},{key:"set",value:function(t,i,n,e){return this.g=t,this.S=i,this.j=n,this._=e,this.O(),this}},{key:"clone",value:function(){return new this.constructor(this.g,this.S,this.j,this._)}},{key:"copy",value:function(t){return this.g=t.x,this.S=t.y,this.j=t.z,this._=t.w,this.O(),this}},{key:"setFromEuler",value:function(t,i){if(!t||!t.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var n=t.g,e=t.S,r=t.j,s=t._order,t=Math.cos,o=Math.sin,h=t(n/2),u=t(e/2),a=t(r/2),f=o(n/2),c=o(e/2),l=o(r/2);switch(s){case"XYZ":this.g=f*u*a+h*c*l,this.S=h*c*a-f*u*l,this.j=h*u*l+f*c*a,this._=h*u*a-f*c*l;break;case"YXZ":this.g=f*u*a+h*c*l,this.S=h*c*a-f*u*l,this.j=h*u*l-f*c*a,this._=h*u*a+f*c*l;break;case"ZXY":this.g=f*u*a-h*c*l,this.S=h*c*a+f*u*l,this.j=h*u*l+f*c*a,this._=h*u*a-f*c*l;break;case"ZYX":this.g=f*u*a-h*c*l,this.S=h*c*a+f*u*l,this.j=h*u*l-f*c*a,this._=h*u*a+f*c*l;break;case"YZX":this.g=f*u*a+h*c*l,this.S=h*c*a+f*u*l,this.j=h*u*l-f*c*a,this._=h*u*a-f*c*l;break;case"XZY":this.g=f*u*a-h*c*l,this.S=h*c*a-f*u*l,this.j=h*u*l+f*c*a,this._=h*u*a+f*c*l;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+s)}return!1!==i&&this.O(),this}},{key:"setFromAxisAngle",value:function(t,i){var i=i/2,n=Math.sin(i);return this.g=t.x*n,this.S=t.y*n,this.j=t.z*n,this._=Math.cos(i),this.O(),this}},{key:"setFromRotationMatrix",value:function(t){var t=t.elements,i=t[0],n=t[4],e=t[8],r=t[1],s=t[5],o=t[9],h=t[2],u=t[6],t=t[10],a=i+s+t;return 0<a?(a=.5/Math.sqrt(a+1),this._=.25/a,this.g=(u-o)*a,this.S=(e-h)*a,this.j=(r-n)*a):s<i&&t<i?(a=2*Math.sqrt(1+i-s-t),this._=(u-o)/a,this.g=.25*a,this.S=(n+r)/a,this.j=(e+h)/a):t<s?(a=2*Math.sqrt(1+s-i-t),this._=(e-h)/a,this.g=(n+r)/a,this.S=.25*a,this.j=(o+u)/a):(a=2*Math.sqrt(1+t-i-s),this._=(r-n)/a,this.g=(e+h)/a,this.S=(o+u)/a,this.j=.25*a),this.O(),this}},{key:"setFromUnitVectors",value:function(t,i){var n=t.dot(i)+1;return n<1e-6?(n=0,Math.abs(t.x)>Math.abs(t.z)?(this.g=-t.y,this.S=t.x,this.j=0):(this.g=0,this.S=-t.z,this.j=t.y)):(this.g=t.y*i.z-t.z*i.y,this.S=t.z*i.x-t.x*i.z,this.j=t.x*i.y-t.y*i.x),this._=n,this.normalize()}},{key:"angleTo",value:function(t){return 2*Math.acos(Math.abs(e.clamp(this.dot(t),-1,1)))}},{key:"rotateTowards",value:function(t,i){var n=this.angleTo(t);return 0!==n&&(i=Math.min(1,i/n),this.slerp(t,i)),this}},{key:"identity",value:function(){return this.set(0,0,0,1)}},{key:"invert",value:function(){return this.conjugate()}},{key:"conjugate",value:function(){return this.g*=-1,this.S*=-1,this.j*=-1,this.O(),this}},{key:"dot",value:function(t){return this.g*t.g+this.S*t.S+this.j*t.j+this._*t._}},{key:"lengthSq",value:function(){return this.g*this.g+this.S*this.S+this.j*this.j+this._*this._}},{key:"length",value:function(){return Math.sqrt(this.g*this.g+this.S*this.S+this.j*this.j+this._*this._)}},{key:"normalize",value:function(){var t=this.length();return 0===t?(this.g=0,this.S=0,this.j=0,this._=1):(this.g=this.g*(t=1/t),this.S=this.S*t,this.j=this.j*t,this._=this._*t),this.O(),this}},{key:"multiply",value:function(t,i){return void 0!==i?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,i)):this.multiplyQuaternions(this,t)}},{key:"premultiply",value:function(t){return this.multiplyQuaternions(t,this)}},{key:"multiplyQuaternions",value:function(t,i){var n=t.g,e=t.S,r=t.j,t=t._,s=i.g,o=i.S,h=i.j,i=i._;return this.g=n*i+t*s+e*h-r*o,this.S=e*i+t*o+r*s-n*h,this.j=r*i+t*h+n*o-e*s,this._=t*i-n*s-e*o-r*h,this.O(),this}},{key:"slerp",value:function(t,i){if(0!==i){if(1===i)return this.copy(t);var n,e=this.g,r=this.S,s=this.j,o=this._,h=o*t._+e*t.g+r*t.S+s*t.j;h<0?(this._=-t._,this.g=-t.g,this.S=-t.S,this.j=-t.j,h=-h):this.copy(t),1<=h?(this._=o,this.g=e,this.S=r,this.j=s):((t=1-h*h)<=Number.EPSILON?(this._=(n=1-i)*o+i*this._,this.g=n*e+i*this.g,this.S=n*r+i*this.S,this.j=n*s+i*this.j,this.normalize()):(n=Math.sqrt(t),t=Math.atan2(n,h),h=Math.sin((1-i)*t)/n,i=Math.sin(i*t)/n,this._=o*h+this._*i,this.g=e*h+this.g*i,this.S=r*h+this.S*i,this.j=s*h+this.j*i),this.O())}return this}},{key:"equals",value:function(t){return t.g===this.g&&t.S===this.S&&t.j===this.j&&t._===this._}},{key:"fromArray",value:function(t){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return this.g=t[i],this.S=t[i+1],this.j=t[i+2],this._=t[i+3],this.O(),this}},{key:"toArray",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return t[i]=this.g,t[i+1]=this.S,t[i+2]=this.j,t[i+3]=this._,t}},{key:"fromBufferAttribute",value:function(t,i){return this.g=t.getX(i),this.S=t.getY(i),this.j=t.getZ(i),this._=t.getW(i),this}},{key:"_onChange",value:function(t){return this.O=t,this}},{key:"_onChangeCallback",value:function(){}}])&&Q(t.prototype,i),n&&Q(t,n),Object.defineProperty(t,"prototype",{writable:!1}),o}();function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function q(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==u(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==u(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===u(t)?t:String(t)}(e.key),e)}}var c=function(){function s(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,e=this,r=s;if(!(e instanceof r))throw new TypeError("Cannot call a class as a function");Object.defineProperty(this,"isVector3",{value:!0}),this.x=t,this.y=i,this.z=n}var t,i,n;return t=s,(i=[{key:"set",value:function(t,i,n){return void 0===n&&(n=this.z),this.x=t,this.y=i,this.z=n,this}},{key:"setScalar",value:function(t){return this.x=t,this.y=t,this.z=t,this}},{key:"setX",value:function(t){return this.x=t,this}},{key:"setY",value:function(t){return this.y=t,this}},{key:"setZ",value:function(t){return this.z=t,this}},{key:"setComponent",value:function(t,i){switch(t){case 0:this.x=i;break;case 1:this.y=i;break;case 2:this.z=i;break;default:throw new Error("index is out of range: "+t)}return this}},{key:"getComponent",value:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}},{key:"clone",value:function(){return new this.constructor(this.x,this.y,this.z)}},{key:"copy",value:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}},{key:"add",value:function(t,i){return void 0!==i?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,i)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)}},{key:"addScalar",value:function(t){return this.x+=t,this.y+=t,this.z+=t,this}},{key:"addVectors",value:function(t,i){return this.x=t.x+i.x,this.y=t.y+i.y,this.z=t.z+i.z,this}},{key:"addScaledVector",value:function(t,i){return this.x+=t.x*i,this.y+=t.y*i,this.z+=t.z*i,this}},{key:"sub",value:function(t,i){return void 0!==i?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,i)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)}},{key:"subScalar",value:function(t){return this.x-=t,this.y-=t,this.z-=t,this}},{key:"subVectors",value:function(t,i){return this.x=t.x-i.x,this.y=t.y-i.y,this.z=t.z-i.z,this}},{key:"multiply",value:function(t,i){return void 0!==i?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,i)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)}},{key:"multiplyScalar",value:function(t){return this.x*=t,this.y*=t,this.z*=t,this}},{key:"multiplyVectors",value:function(t,i){return this.x=t.x*i.x,this.y=t.y*i.y,this.z=t.z*i.z,this}},{key:"applyEuler",value:function(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(G.setFromEuler(t))}},{key:"applyAxisAngle",value:function(t,i){return this.applyQuaternion(G.setFromAxisAngle(t,i))}},{key:"applyMatrix3",value:function(t){var i=this.x,n=this.y,e=this.z,t=t.elements;return this.x=t[0]*i+t[3]*n+t[6]*e,this.y=t[1]*i+t[4]*n+t[7]*e,this.z=t[2]*i+t[5]*n+t[8]*e,this}},{key:"applyNormalMatrix",value:function(t){return this.applyMatrix3(t).normalize()}},{key:"applyMatrix4",value:function(t){var i=this.x,n=this.y,e=this.z,t=t.elements,r=1/(t[3]*i+t[7]*n+t[11]*e+t[15]);return this.x=(t[0]*i+t[4]*n+t[8]*e+t[12])*r,this.y=(t[1]*i+t[5]*n+t[9]*e+t[13])*r,this.z=(t[2]*i+t[6]*n+t[10]*e+t[14])*r,this}},{key:"applyQuaternion",value:function(t){var i=this.x,n=this.y,e=this.z,r=t.x,s=t.y,o=t.z,t=t.w,h=t*i+s*e-o*n,u=t*n+o*i-r*e,a=t*e+r*n-s*i,i=-r*i-s*n-o*e;return this.x=h*t+i*-r+u*-o-a*-s,this.y=u*t+i*-s+a*-r-h*-o,this.z=a*t+i*-o+h*-s-u*-r,this}},{key:"project",value:function(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}},{key:"unproject",value:function(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}},{key:"transformDirection",value:function(t){var i=this.x,n=this.y,e=this.z,t=t.elements;return this.x=t[0]*i+t[4]*n+t[8]*e,this.y=t[1]*i+t[5]*n+t[9]*e,this.z=t[2]*i+t[6]*n+t[10]*e,this.normalize()}},{key:"divide",value:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}},{key:"divideScalar",value:function(t){return this.multiplyScalar(1/t)}},{key:"min",value:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}},{key:"max",value:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}},{key:"clamp",value:function(t,i){return this.x=Math.max(t.x,Math.min(i.x,this.x)),this.y=Math.max(t.y,Math.min(i.y,this.y)),this.z=Math.max(t.z,Math.min(i.z,this.z)),this}},{key:"clampScalar",value:function(t,i){return this.x=Math.max(t,Math.min(i,this.x)),this.y=Math.max(t,Math.min(i,this.y)),this.z=Math.max(t,Math.min(i,this.z)),this}},{key:"clampLength",value:function(t,i){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(i,n)))}},{key:"floor",value:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}},{key:"ceil",value:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}},{key:"round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}},{key:"roundToZero",value:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}},{key:"negate",value:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}},{key:"dot",value:function(t){return this.x*t.x+this.y*t.y+this.z*t.z}},{key:"lengthSq",value:function(){return this.x*this.x+this.y*this.y+this.z*this.z}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}},{key:"manhattanLength",value:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}},{key:"normalize",value:function(){return this.divideScalar(this.length()||1)}},{key:"setLength",value:function(t){return this.normalize().multiplyScalar(t)}},{key:"lerp",value:function(t,i){return this.x+=(t.x-this.x)*i,this.y+=(t.y-this.y)*i,this.z+=(t.z-this.z)*i,this}},{key:"lerpVectors",value:function(t,i,n){return this.x=t.x+(i.x-t.x)*n,this.y=t.y+(i.y-t.y)*n,this.z=t.z+(i.z-t.z)*n,this}},{key:"cross",value:function(t,i){return void 0!==i?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,i)):this.crossVectors(this,t)}},{key:"crossVectors",value:function(t,i){var n=t.x,e=t.y,t=t.z,r=i.x,s=i.y,i=i.z;return this.x=e*i-t*s,this.y=t*r-n*i,this.z=n*s-e*r,this}},{key:"projectOnVector",value:function(t){var i=t.lengthSq();return 0===i?this.set(0,0,0):(i=t.dot(this)/i,this.copy(t).multiplyScalar(i))}},{key:"projectOnPlane",value:function(t){return a.copy(this).projectOnVector(t),this.sub(a)}},{key:"reflect",value:function(t){return this.sub(a.copy(t).multiplyScalar(2*this.dot(t)))}},{key:"angleTo",value:function(t){var i=Math.sqrt(this.lengthSq()*t.lengthSq());return 0===i?Math.PI/2:(t=this.dot(t)/i,Math.acos(e.clamp(t,-1,1)))}},{key:"distanceTo",value:function(t){return Math.sqrt(this.distanceToSquared(t))}},{key:"distanceToSquared",value:function(t){var i=this.x-t.x,n=this.y-t.y,t=this.z-t.z;return i*i+n*n+t*t}},{key:"manhattanDistanceTo",value:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}},{key:"setFromSpherical",value:function(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}},{key:"setFromSphericalCoords",value:function(t,i,n){var e=Math.sin(i)*t;return this.x=e*Math.sin(n),this.y=Math.cos(i)*t,this.z=e*Math.cos(n),this}},{key:"setFromCylindrical",value:function(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}},{key:"setFromCylindricalCoords",value:function(t,i,n){return this.x=t*Math.sin(i),this.y=n,this.z=t*Math.cos(i),this}},{key:"setFromMatrixPosition",value:function(t){t=t.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}},{key:"setFromMatrixScale",value:function(t){var i=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),t=this.setFromMatrixColumn(t,2).length();return this.x=i,this.y=n,this.z=t,this}},{key:"setFromMatrixColumn",value:function(t,i){return this.fromArray(t.elements,4*i)}},{key:"setFromMatrix3Column",value:function(t,i){return this.fromArray(t.elements,3*i)}},{key:"equals",value:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}},{key:"fromArray",value:function(t){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return this.x=t[i],this.y=t[i+1],this.z=t[i+2],this}},{key:"toArray",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return t[i]=this.x,t[i+1]=this.y,t[i+2]=this.z,t}},{key:"fromBufferAttribute",value:function(t,i,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(i),this.y=t.getY(i),this.z=t.getZ(i),this}},{key:"random",value:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}}])&&q(t.prototype,i),n&&q(t,n),Object.defineProperty(t,"prototype",{writable:!1}),s}(),a=new c,G=new t;function f(t){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function W(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==f(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==f(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===f(t)?t:String(t)}(e.key),e)}}var t=function(){function t(){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.T={x:Number.MAX_VALUE,y:Number.MAX_VALUE},this.R={x:-Number.MAX_VALUE,y:-Number.MAX_VALUE}}var i,n,e;return i=t,(n=[{key:"min",get:function(){return this.T}},{key:"max",get:function(){return this.R}},{key:"center",get:function(){var t={x:Number.NaN,y:Number.NaN};return this.valid()&&(t.x=(this.min.x+this.max.x)/2,t.y=(this.min.y+this.max.y)/2),t}},{key:"size",get:function(){var t={x:Number.NaN,y:Number.NaN};return this.valid()&&(t.x=this.max.x-this.min.x,t.y=this.max.y-this.min.y),t}},{key:"copy",value:function(t){return this.R.x=t.max.x,this.R.y=t.max.y,this.T.x=t.min.x,this.T.y=t.min.y,this}},{key:"clone",value:function(){return(new t).copy(this)}},{key:"reset",value:function(){this.T={x:Number.MAX_VALUE,y:Number.MAX_VALUE},this.R={x:-Number.MAX_VALUE,y:-Number.MAX_VALUE}}},{key:"toObject",value:function(){return{min:this.min,max:this.max,center:this.center,size:this.size}}},{key:"expand",value:function(t){this.I(t)}},{key:"expandByCoords",value:function(t){this.P(t)}},{key:"valid",value:function(){return this.C()}},{key:"isCross",value:function(t){var i=!0;return t.max.x<this.min.x&&(i=!1),t.min.x>this.max.x&&(i=!1),t.max.y<this.min.y&&(i=!1),i=t.min.y>this.max.y?!1:i}}])&&W(i.prototype,n),e&&W(i,e),Object.defineProperty(i,"prototype",{writable:!1}),t}(),$=(Object.assign(t.prototype,{C:function(){return!(this.min.x>this.max.x||this.min.y>this.max.y)},I:function(t){t&&t.valid()&&(t.min.x<this.min.x&&(this.min.x=t.min.x),t.min.y<this.min.y&&(this.min.y=t.min.y),t.max.x>this.max.x&&(this.max.x=t.max.x),t.max.y>this.max.y)&&(this.max.y=t.max.y)},P:function(t){var i=this;t&&0!=t.length&&t.forEach(function(t){t.x<i.min.x&&(i.min.x=t.x),t.y<i.min.y&&(i.min.y=t.y),t.x>i.max.x&&(i.max.x=t.x),t.y>i.max.y&&(i.max.y=t.y)})}}),t),J=function(t,i,n){n=n||2;var e,r,s,o,h,u=i&&i.length,a=u?i[0]*n:t.length,f=K(t,0,a,n,!0),c=[];if(f&&f.next!==f.prev){if(u&&(f=function(t,i,n,e){var r,s,o,h,u=[];for(r=0,s=i.length;r<s;r++)h=i[r]*e,o=r<s-1?i[r+1]*e:t.length,(h=K(t,h,o,e,!1))===h.next&&(h.steiner=!0),u.push(function(t){var i=t,n=t;for(;(i.x<n.x||i.x===n.x&&i.y<n.y)&&(n=i),i=i.next,i!==t;);return n}(h));for(u.sort(tt),r=0;r<u.length;r++)!function(t,i){(i=function(t,i){var n,e=i,r=t.x,s=t.y,o=-1/0;do{if(s<=e.y&&s>=e.next.y&&e.next.y!==e.y){var h=e.x+(s-e.y)*(e.next.x-e.x)/(e.next.y-e.y);if(h<=r&&o<h){if((o=h)===r){if(s===e.y)return e;if(s===e.next.y)return e.next}n=e.x<e.next.x?e:e.next}}}while(e=e.next,e!==i);if(!n)return null;if(r!==o){var u,a=n,f=n.x,c=n.y,l=1/0;for(e=n;r>=e.x&&e.x>=f&&r!==e.x&&T(s<c?r:o,s,f,c,s<c?o:r,s,e.x,e.y)&&(u=Math.abs(s-e.y)/(r-e.x),E(e,t))&&(u<l||u===l&&(e.x>n.x||e.x===n.x&&function(t,i){return x(t.prev,t,i.prev)<0&&x(i.next,t,t.next)<0}(n,e)))&&(n=e,l=u),(e=e.next)!==a;);}return n}(t,i))&&(t=et(i,t),_(i,i.next),_(t,t.next))}(u[r],n),n=_(n,n.next);return n}(t,i,f,n)),t.length>80*n){for(var l=e=t[0],v=r=t[1],y=n;y<a;y+=n)(s=t[y])<l&&(l=s),(o=t[y+1])<v&&(v=o),e<s&&(e=s),r<o&&(r=o);h=0!==(h=Math.max(e-l,r-v))?1/h:0}O(f,c,n,l,v,h)}return c};function K(t,i,n,e,r){var s,o;if(r===0<function(t,i,n,e){for(var r=0,s=i,o=n-e;s<n;s+=e)r+=(t[o]-t[s])*(t[s+1]+t[o+1]),o=s;return r}(t,i,n,e))for(s=i;s<n;s+=e)o=rt(s,t[s],t[s+1],o);else for(s=n-e;i<=s;s-=e)o=rt(s,t[s],t[s+1],o);return o&&R(o,o.next)&&(I(o),o=o.next),o}function _(t,i){if(!t)return t;i=i||t;var n,e=t;do{if(n=!1,e.steiner||!R(e,e.next)&&0!==x(e.prev,e,e.next))e=e.next;else{if(I(e),(e=i=e.prev)===e.next)break;n=!0}}while(n||e!==i);return i}function O(t,i,n,e,r,s,o){if(t){if(!o&&s){for(var h=t,u=e,a=r,f=s,c=h;null===c.z&&(c.z=it(c.x,c.y,u,a,f)),c.prevZ=c.prev,c.nextZ=c.next,(c=c.next)!==h;);c.prevZ.nextZ=null,c.prevZ=null;var l,v,y,d,b,m,p,M,k=c,g=1;do{for(v=k,b=k=null,m=0;v;){for(m++,y=v,l=p=0;l<g&&(p++,y=y.nextZ);l++);for(M=g;0<p||0<M&&y;)0!==p&&(0===M||!y||v.z<=y.z)?(v=(d=v).nextZ,p--):(y=(d=y).nextZ,M--),b?b.nextZ=d:k=d,d.prevZ=b,b=d;v=y}}while(b.nextZ=null,g*=2,1<m)}for(var w,S,j=t;t.prev!==t.next;)if(w=t.prev,S=t.next,s?function(t,i,n,e){var r=t.prev,s=t,o=t.next;if(0<=x(r,s,o))return;var h=(r.x<s.x?r.x<o.x?r:o:s.x<o.x?s:o).x,u=(r.y<s.y?r.y<o.y?r:o:s.y<o.y?s:o).y,a=(r.x>s.x?r.x>o.x?r:o:s.x>o.x?s:o).x,f=(r.y>s.y?r.y>o.y?r:o:s.y>o.y?s:o).y,c=it(h,u,i,n,e),l=it(a,f,i,n,e),v=t.prevZ,y=t.nextZ;for(;v&&v.z>=c&&y&&y.z<=l;){if(v!==t.prev&&v!==t.next&&T(r.x,r.y,s.x,s.y,o.x,o.y,v.x,v.y)&&0<=x(v.prev,v,v.next))return;if(v=v.prevZ,y!==t.prev&&y!==t.next&&T(r.x,r.y,s.x,s.y,o.x,o.y,y.x,y.y)&&0<=x(y.prev,y,y.next))return;y=y.nextZ}for(;v&&v.z>=c;){if(v!==t.prev&&v!==t.next&&T(r.x,r.y,s.x,s.y,o.x,o.y,v.x,v.y)&&0<=x(v.prev,v,v.next))return;v=v.prevZ}for(;y&&y.z<=l;){if(y!==t.prev&&y!==t.next&&T(r.x,r.y,s.x,s.y,o.x,o.y,y.x,y.y)&&0<=x(y.prev,y,y.next))return;y=y.nextZ}return 1}(t,e,r,s):function(t){var i=t.prev,n=t,e=t.next;if(0<=x(i,n,e))return;var r=t.next.next;for(;r!==t.prev;){if(T(i.x,i.y,n.x,n.y,e.x,e.y,r.x,r.y)&&0<=x(r.prev,r,r.next))return;r=r.next}return 1}(t))i.push(w.i/n),i.push(t.i/n),i.push(S.i/n),I(t),t=S.next,j=S.next;else if((t=S)===j){o?1===o?O(t=function(t,i,n){var e=t;do{var r=e.prev,s=e.next.next}while(!R(r,s)&&nt(r,e,e.next,s)&&E(r,s)&&E(s,r)&&(i.push(r.i/n),i.push(e.i/n),i.push(s.i/n),I(e),I(e.next),e=t=s),e=e.next,e!==t);return _(e)}(_(t),i,n),i,n,e,r,s,2):2===o&&function(t,i,n,e,r,s){var o=t;do{for(var h,u=o.next.next;u!==o.prev;){if(o.i!==u.i&&function(t,i){return t.next.i!==i.i&&t.prev.i!==i.i&&!function(t,i){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==i.i&&n.next.i!==i.i&&nt(n,n.next,t,i))return 1}while(n=n.next,n!==t);return}(t,i)&&(E(t,i)&&E(i,t)&&function(t,i){var n=t,e=!1,r=(t.x+i.x)/2,s=(t.y+i.y)/2;for(;n.y>s!=n.next.y>s&&n.next.y!==n.y&&r<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(e=!e),n=n.next,n!==t;);return e}(t,i)&&(x(t.prev,t,i.prev)||x(t,i.prev,i))||R(t,i)&&0<x(t.prev,t,t.next)&&0<x(i.prev,i,i.next))}(o,u))return h=et(o,u),o=_(o,o.next),h=_(h,h.next),O(o,i,n,e,r,s),O(h,i,n,e,r,s);u=u.next}}while(o=o.next,o!==t)}(t,i,n,e,r,s):O(_(t),i,n,e,r,s,1);break}}}function tt(t,i){return t.x-i.x}function it(t,i,n,e,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*r)|t<<8))|t<<4))|t<<2))|t<<1))|(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=32767*(i-e)*r)|i<<8))|i<<4))|i<<2))|i<<1))<<1}function T(t,i,n,e,r,s,o,h){return 0<=(r-o)*(i-h)-(t-o)*(s-h)&&0<=(t-o)*(e-h)-(n-o)*(i-h)&&0<=(n-o)*(s-h)-(r-o)*(e-h)}function x(t,i,n){return(i.y-t.y)*(n.x-i.x)-(i.x-t.x)*(n.y-i.y)}function R(t,i){return t.x===i.x&&t.y===i.y}function nt(t,i,n,e){var r=v(x(t,i,n)),s=v(x(t,i,e)),o=v(x(n,e,t)),h=v(x(n,e,i));return r!==s&&o!==h||0===r&&l(t,n,i)||0===s&&l(t,e,i)||0===o&&l(n,t,e)||!(0!==h||!l(n,i,e))}function l(t,i,n){return i.x<=Math.max(t.x,n.x)&&i.x>=Math.min(t.x,n.x)&&i.y<=Math.max(t.y,n.y)&&i.y>=Math.min(t.y,n.y)}function v(t){return 0<t?1:t<0?-1:0}function E(t,i){return x(t.prev,t,t.next)<0?0<=x(t,i,t.next)&&0<=x(t,t.prev,i):x(t,i,t.prev)<0||x(t,t.next,i)<0}function et(t,i){var n=new st(t.i,t.x,t.y),e=new st(i.i,i.x,i.y),r=t.next,s=i.prev;return(t.next=i).prev=t,(n.next=r).prev=n,(e.next=n).prev=e,(s.next=e).prev=s,e}function rt(t,i,n,e){t=new st(t,i,n);return e?(t.next=e.next,(t.prev=e).next.prev=t,e.next=t):(t.prev=t).next=t,t}function I(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function st(t,i,n){this.i=t,this.x=i,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function ot(t){return function(t){if(Array.isArray(t))return ht(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,i){var n;if(t)return"string"==typeof t?ht(t,i):"Map"===(n="Object"===(n=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ht(t,i):void 0}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ht(t,i){(null==i||i>t.length)&&(i=t.length);for(var n=0,e=new Array(i);n<i;n++)e[n]=t[n];return e}var y={area:function(t){for(var i=t.length,n=0,e=i-1,r=0;r<i;e=r++)n+=t[e].x*t[r].y-t[r].x*t[e].y;return.5*n},isClockWise:function(t){return y.area(t)<0},triangulateShape:function(t,i){var n=[],e=[],r=[],s=(ut(t),at(n,t),t.length);i.forEach(ut);for(var o=0;o<i.length;o++)e.push(s),s+=i[o].length,at(n,i[o]);for(var h=J(n,e),u=0;u<h.length;u+=3)r.push(h.slice(u,u+3));return r},triangulate:function(t){(r=[]).push.apply(r,ot(t[0]));for(var i=[],n=1;n<t.length;n++){var e=[];e.push.apply(e,ot(t[n])),i.push(e)}if(!y.isClockWise(r))for(var r=r.reverse(),s=0,o=i.length;s<o;s++){var h=i[s];y.isClockWise(h)&&(i[s]=h.reverse())}return y.triangulateShape(r,i)}};function ut(t){var i,n=t.length;2<n&&(n=t[n-1],i=t[0],n.x===i.x)&&n.y===i.y&&t.pop()}function at(t,i){for(var n=0;n<i.length;n++)t.push(i[n].x),t.push(i[n].y)}function d(t){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ft(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==d(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==d(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===d(t)?t:String(t)}(e.key),e)}}function ct(t,i,n){return i&&ft(t.prototype,i),n&&ft(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}var b=1e-5,m=.001,lt=Math.PI/180,vt=180/Math.PI,t=ct(function t(){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function")});Object.assign(t.prototype,{N:function(){return b},D:function(){return lt},A:function(){return vt},F:function(t){return t<b&&-b<t},L:function(t){return b<t},Y:function(t){return t<-b},V:function(t,i,n){i=(t.x-n.x)*(i.y-n.y)-(i.x-n.x)*(t.y-n.y);return Math.abs(i)<b?0:i},distanceOfTwoPoints:function(t,i){return t&&i?Math.sqrt((t.x-i.x)*(t.x-i.x)+(t.y-i.y)*(t.y-i.y)):Number.NaN},distance:function(t,i){return Math.sqrt(Math.pow(i.x-t.x,2)+Math.pow(i.y-t.y,2))},isPolygonContainPoint:function(t,i){for(var n=0,e=0;e<t.length;e++){var r=t[e].x,s=t[e].y,o=0,h=0,h=(e<t.length-1?(o=t[e+1].x,t[e+1]):(o=t[0].x,t[0])).y;if(r===i.x&&s===i.y||o===i.x&&h===i.y)return!0;if(h!==s){var u=r+(i.y-s)*(o-r)/(h-s);if(u===i.x)return!0;r!==o?u<=Math.max(r,o)&&u>=Math.min(r,o)&&u>i.x&&u!==r&&(u===o&&0<(s-i.y)*(h-i.y)?n+=2:n++):u<=Math.max(r,o)&&u>=Math.min(r,o)&&u>i.x&&(u===o&&0<(s-i.y)*(h-i.y)?n+=2:n++)}}return 0<n%2},Z:function(t,i,n,e){return!(Math.max(t.x,i.x)<Math.min(n.x,e.x)||Math.max(t.y,i.y)<Math.min(n.y,e.y)||Math.max(n.x,e.x)<Math.min(t.x,i.x)||Math.max(n.y,e.y)<Math.min(t.y,i.y))},B:function(t,i,n,e){return!(Math.max(t.x,i.x)<Math.min(n.x,e.x)||Math.max(t.y,i.y)<Math.min(n.y,e.y)||Math.max(n.x,e.x)<Math.min(t.x,i.x)||Math.max(n.y,e.y)<Math.min(t.y,i.y)||0===this.V(n,i,t)&&0===this.V(i,e,t)||this.V(n,i,t)*this.V(i,e,t)<0||this.V(t,e,n)*this.V(e,i,n)<0)},U:function(t,i,n){return!(t.x<i.x||t.y<i.y||t.x>n.x||t.y>n.y)},X:function(t,i,n){var e=Math.min(i.x,n.x),r=Math.max(i.x,n.x),s=Math.min(i.y,n.y),i=Math.max(i.y,n.y);return!(t.x<e||t.x>r||t.y<s||t.y>i)},H:function(t,i,n){var e=Math.min(n.x,i.x),r=Math.max(n.x,i.x),s=Math.min(n.y,i.y),n=Math.max(n.y,i.y);return!(t.x<e||t.x>r||t.y<s||t.y>n)},q:function(t,i,n){for(var e,r,s=!1,o=0;o<n;o++)e=i[o],r=i[(o+1)%n],(e.y<t.y&&r.y>=t.y||r.y<t.y&&e.y>=t.y)&&(e.x<=t.x||r.x<=t.x)&&e.x+(t.y-e.y)/(r.y-e.y)*(r.x-e.x)<t.x&&(s=!s);return s},G:function(t,i,n){return(t.x-i.x)*(n.y-i.y)==(n.x-i.x)*(t.y-i.y)&&Math.min(i.x,n.x)<=t.x&&t.x<=Math.max(i.x,n.x)&&Math.min(i.y,n.y)<=t.y&&t.y<=Math.max(i.y,n.y)},W:function(t,i){return Math.sqrt((t.x-i.x)*(t.x-i.x)+(t.y-i.y)*(t.y-i.y))},$:function(t,i){return(t.x-i.x)*(t.x-i.x)+(t.y-i.y)*(t.y-i.y)},J:function(t,i,n){var e=i.x,i=i.y,r=n.x,n=n.y,s=t.x,t=t.y,o=r-e,h=n-i,u=o*o+h*h,a=s-e,f=t-i,c=a*a+f*f;return this.F(u)?this.F(c)?0:c:(u=Math.sqrt(u),f=this.L(h=(o=o/u)*a+(a=h/u)*f)?this.Y(h-u)?(f=s-(e+h*o))*f+(u=t-(i+h*a))*u:(e=s-r)*e+(o=t-n)*o:c,this.F(f)?0:f)},K:function(t,i,n,e){var r,s=i.x,o=i.y,h=n.x,u=n.y,a=t.x,t=t.y,f=h-s,c=u-o,l=Math.sqrt(f*f+c*c),v=a-s,y=t-o,d=Math.sqrt(v*v+y*y);return this.F(l)?(e.x=i.x,e.y=i.y,this.F(r=d)?0:r):(r=this.L(c=(f=f/l)*v+(v=c/l)*y)?this.Y(c-l)?(l=a-(y=s+c*f),f=t-(s=o+c*v),o=Math.sqrt(l*l+f*f),e.x=y,e.y=s,o):(c=a-h,v=t-u,l=Math.sqrt(c*c+v*v),e.x=n.x,e.y=n.y,l):(e.x=i.x,e.y=i.y,d),this.F(r)?0:r)},tt:function(t,i){for(var n=0,e=0,r=0,s=0;s<i;s++){var o=t[s],h=t[(s+1)%i],u=(o.x*h.y-o.y*h.x)/2;n+=u,e+=u*(o.x+h.x)/3,r+=u*(o.y+h.y)/3}return{x:e/=n,y:r/=n}},it:function(t){for(var i=y.triangulate([t]),n=0,e=0,r=0,s=0;s<i.length;s++){var o=t[i[s][0]],h=t[i[s][1]],u=t[i[s][2]],a=h.x-o.x,f=h.y-o.y,c=u.x-o.x,a=(a*(u.y-o.y)-c*f)/2;n+=a,e+=(o.x+h.x+u.x)/3*a,r+=(o.y+h.y+u.y)/3*a}return{x:e/n,y:r/n}},nt:function(t,i){if(i<3)return 0;for(var n=0,e=0;e<i;++e){var r=t[e],s=t[(e+1)%i];n+=r.x*s.y-r.y*s.x}return Math.abs(n/2)},et:function(t,i,n,e,r){var s,o;return this.B(t,i,n,e)?(s=(e.x-n.x)*(t.y-i.y)-(i.x-t.x)*(n.y-e.y),o=(t.y-n.y)*(i.x-t.x)*(e.x-n.x)+n.x*(e.y-n.y)*(i.x-t.x)-t.x*(i.y-t.y)*(e.x-n.x),r.x=o/s,s=(t.x-i.x)*(e.y-n.y)-(i.y-t.y)*(n.x-e.x),o=i.y*(t.x-i.x)*(e.y-n.y)+(e.x-i.x)*(e.y-n.y)*(t.y-i.y)-e.y*(n.x-e.x)*(i.y-t.y),r.y=o/s,1):0},rt:function(t,i,n,e,r){var s=Math.min(n.x,e.x),o=Math.max(n.x,e.x),h=Math.min(n.y,e.y),u=Math.max(n.y,e.y),a=t.x,f=t.y,c=n.x,l=n.y,v=e.x,y=e.y;if(90==i)return!(t.x<s||t.x>o||(Math.abs(o-s<m)?t.y>=l&&t.y<=y||t.y>=y&&t.y<=l?(r.x=t.x,r.y=t.y,0):l<y&&t.x<l?(r.x=c,r.y=l,0):!(y<l&&t.x<y)||(r.x=v,r.y=y,0):(r.y=d=(y-l)/(v-c)*(a-c)+l,r.x=a,d<f||!this.H(r,n,e))));if(270==i)return!(t.x<s||t.x>o||(Math.abs(o-s<m)?t.y>=l&&t.y<=y||t.y>=y&&t.y<=l?(r.x=t.x,r.y=t.y,0):l<y&&t.y>y?(r.x=v,r.y=y,0):!(y<l&&t.y>l)||(r.x=c,r.y=l,0):(r.y=d=(y-l)/(v-c)*(a-c)+l,r.x=a,f<d||!this.H(r,n,e))));if(270!=i&&90!=i&&Math.abs(o-s<m)){var t=s,d=Math.tan(i/180*Math.PI)*(t-a)+f;if(r.y=d,r.x=t,this.H(r,n,e))return o=d-f,0<(s=t-a)/Math.sqrt(s*s+o*o)*Math.cos(i/180*Math.PI)}return Math.abs(u-h<=m)?(d=h,t=1/Math.tan(i/180*Math.PI)*(d-f)+a,r.x=t,r.y=d,!!this.H(r,n,e)&&(s=d-f,0<(o=t-a)/Math.sqrt(o*o+s*s)*Math.cos(i/180*Math.PI))):(t=f+(u=Math.tan(i/180*Math.PI))*((d=(l-f-((h=(y-l)/(v-c))*c-u*a))/(u-h))-a),r.x=d,r.y=t,!!this.H(r,n,e)&&(o=d-a,s=t-f,Math.abs(o)<=m&&Math.abs(s)<=m||0<o/Math.sqrt(o*o+s*s)*Math.cos(i/180*Math.PI)))},st:function(t,i){return Math.abs(t.x-i.x)<b&&Math.abs(t.y-i.y)<b},ot:function(t,i,n,e){var r,s,o,h,u=t.x,a=t.y,f=i.x,c=i.y,l=n.x,v=n.y;return this.st(t,i)||this.st(t,n)?(e.x=u,e.y=a,!0):(o=Math.min(i.x,n.x),h=Math.max(i.x,n.x),r=Math.min(i.y,n.y),s=Math.max(i.y,n.y),Math.abs(f-l)<1e-5?(e.x=f,r<=(e.y=a)&&a<=s):Math.abs(c-v)<1e-5?(e.x=u,e.y=c,o<=u&&u<=h):(h=a+(r=-1/((v-c)/(l-f)))*((o=(c-a-((s=(v-c)/(l-f))*f-r*u))/(r-s))-u),e.x=o,e.y=h,!!this.H(e,i,n)||!(!this.st(t,i)&&!this.st(t,n))))},ht:function(t,i){return{x:t.y*i.z-t.z*i.y,y:t.z*i.x-t.x*i.z,z:t.x*i.y-t.y*i.x}},ut:function(t,i){return t.x*i.x+t.y*i.y+t.z*i.z},ft:function(t){return Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z)},ct:function(t,i){return t.x*i.x+t.y*i.y},lt:function(t,i){return t.x*i.y-t.y*i.x},vt:function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},yt:function(t,i){var n,e;return 0==t.x&&0==t.y||0==i.x&&0==i.y?0:(n={x:t.x,y:t.y,z:0},e={x:i.x,y:i.y,z:0},n=this.ht(n,e),e=this.ct(t,i),e=Math.acos(e/(this.vt(t)*this.vt(i))),0<n.z?e/Math.PI*180:360-e/Math.PI*180)},dt:function(t,i,n,e){for(var r=0;r<n.length;r++){var s=n[r],o=n[(r+1)%n.length];if(1==this.et(t,i,s,o,e))return!0}return!1},bt:function(t,i,n,e,r){var s=Math.min(t.x,n.x,e.x),o=Math.max(t.x,n.x,e.x),h=Math.min(t.y,n.y,e.y),u=Math.max(t.y,n.y,e.y),o=Math.sqrt((o-s)*(o-s)+(u-h)*(u-h)),s=i/180*Math.PI,u=o*Math.cos(s)+t.x,h=o*Math.sin(s)+t.y;return 1==this.et(t,{x:u,y:h},n,e,r)},Mt:function(t){for(var i={x:null,y:null},n=0,e=0,r=0;r<t.length;r++)n+=t[r].x,e+=t[r].y;return i.x=n/t.length,i.y=e/t.length,i},kt:function(t,i,n,e){var r=[],s=t.x-i,o=t.x+i,h=t.y-i,u=t.y+i,a=Math.min(n.x,e.x),f=Math.max(n.x,e.x),c=Math.min(n.y,e.y),l=Math.max(n.y,e.y);return f<s||o<a||l<h||u<c||(s=e.x-n.x,o=e.y-n.y,(h=(t=(s*(h=t.x-n.x)+o*(u=t.y-n.y))/(e=s*s+o*o))*t-(h*h+u*u-i*i)/e)<0)||(u=Math.sqrt(h),e={x:n.x-s*(i=-t+u),y:n.y-o*i},s={x:n.x-s*(h=-t-u),y:n.y-o*h},i!==h&&(a<=e.x&&e.x<=f&&c<=e.y&&e.y<=l&&r.push(e),a<=s.x)&&s.x<=f&&c<=s.y&&s.y<=l&&r.push(s)),r},gt:function(t,i,n){var e,r={};if(t.x!=i.x)return e=i=(i.y-t.y)/(i.x-t.x),i=t.y-i*t.x,r.x=(+n.x- -1*e*n.y-e*i)/(e*e+1),r.y=(e*e*n.y- -1*e*n.x- -1*i)/(e*e+1),r;r.x=t.x,r.y=n.y},wt:function(t,i,n,e){var r,s,o,h,u={point:null,isintersect:!1};return t==n||t==e?(u.isintersect=!0,u.point=t):i==n||i==e?(u.isintersect=!0,u.point=i):(r={x:i.x-t.x,y:i.y-t.y},s={x:e.x-n.x,y:e.y-n.y},o={x:n.x-t.x,y:n.y-t.y},e={x:e.x-t.x,y:e.y-t.y},i={x:i.x-n.x,y:i.y-n.y},n={x:-o.x,y:-o.y},h=this.lt(s,r),Math.abs(h)<=4e-9||this.lt(o,r)*this.lt(e,r)<=4e-9&&this.lt(n,s)*this.lt(i,s)<4e-9&&(e=this.lt(s,o)/h,u.point=t+r*e,u.isintersect=!0)),u}});var w=new t,p={Drive:1,Walk:0};function yt(t,i){var n,e,r,s,o="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(o)return e=!(n=!0),{s:function(){o=o.call(t)},n:function(){var t=o.next();return n=t.done,t},e:function(t){e=!0,r=t},f:function(){try{n||null==o.return||o.return()}finally{if(e)throw r}}};if(Array.isArray(t)||(o=bt(t))||i&&t&&"number"==typeof t.length)return o&&(t=o),s=0,{s:i=function(){},n:function(){return s>=t.length?{done:!0}:{done:!1,value:t[s++]}},e:function(t){throw t},f:i};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function M(t){return(M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function dt(t){return function(t){if(Array.isArray(t))return mt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||bt(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function bt(t,i){var n;if(t)return"string"==typeof t?mt(t,i):"Map"===(n="Object"===(n=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?mt(t,i):void 0}function mt(t,i){(null==i||i>t.length)&&(i=t.length);for(var n=0,e=new Array(i);n<i;n++)e[n]=t[n];return e}function pt(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==M(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==M(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===M(t)?t:String(t)}(e.key),e)}}var t=function(){function i(t){if(!(this instanceof i))throw new TypeError("Cannot call a class as a function");this.St=t.type,this.stepLength=.7,this.jt=180/Math.PI,this._t=[295829355.45,147914677.73,73957338.86,36978669.43,18489334.72,9244667.36,4622333.68,2311166.84,1155583.42,577791.71,288895.85,144447.93,72223.96,36111.98,18056,9028,4514,2257,1128,564,282,141,70,35,17,8,4,2,1],this.Ot=null,this.Tt=null,this.xt=5,this.Rt=!0,this.Et=.2,this.It=!1,this.Pt=!0,this.Ct=!1,this.Nt=1.2,this.Dt=80,this.At=30,this.Ft=21,this.Lt=!0,this.Yt=22,this.Vt=1.3,this.Zt="",this.zt=100,this.Bt=3,this.Ut=1,this.Xt=6,this.Ht=10,this.Qt=5,this.qt=0,this.Gt=!1,this.Wt=!1,this.$t=!1,this.Jt=!1,this.Kt=0,this.ti=0,this.ii=0,this.ni=0,this.ei=null,this.ri=null,this.si=!1,this.oi=null,this.hi=null,this.ui=!1,this.ai=!1,this.fi=null,this.ci=0,this.li=fengmap.FMLanguageType.ZH,this.vi=fengmap.FMNaviMode.MODULE_SHORTEST,this.yi=fengmap.FMNaviPriority.PRIORITY_DEFAULT,this.di=!1,this.bi=!0,this.mi=[],this.pi=!1,this.Mi=new Map,this.ki=!0,this.crossCircles,this.gi={radius:.5,dash:{size:4,gap:2}},this.wi="#002FA7",this.Si=!0,this.ji=0,this._i=new X,this.Oi=new B,this.on=this.on.bind(this),this.Ti(t),this.xi()}var t,n,e;return t=i,(n=[{key:"locationMarker",get:function(){return this.Ri},set:function(t){this.Ri=t}},{key:"naviResult",get:function(){return this.Ei}},{key:"followPosition",get:function(){return this.Rt},set:function(t){this.Rt=t}},{key:"on",value:function(t,i){this.Oi.h(t,i)}},{key:"off",value:function(t,i){this.Oi.M(t,i)}},{key:"dispose",value:function(){this.stop(),this.Ot=null,this.Tt&&(this.Tt.dispose(),this.Tt=null)}},{key:"setLanguage",value:function(t){this.li!=t&&(this.li=t,this.Ii())}},{key:"setObstructions",value:function(t){this.Tt.setObstructions(t)}},{key:"setStartPoint",value:function(t,i){this.Pi=Object.assign({},this.Pi,t,{x:t.x,y:t.y,level:t.level,buildingID:t.buildingID,height:"number"==typeof t.height?t.height:this.Xt});var n=null;return n=t.url&&!i?this.Ci(this.Pi,!0):n}},{key:"setDestPoint",value:function(t,i){this.Ni=Object.assign({},this.Ni,t,{x:t.x,y:t.y,level:t.level,buildingID:t.buildingID,height:"number"==typeof t.height?t.height:this.Xt});var n=null;return n=t.url&&!i?this.Ci(this.Ni,!1):n}},{key:"route",value:function(t,i,n){this.Ti(t),this.Di(),this.Ai({mode:this.vi,priority:this.yi,toDoors:this.di,obstruct:this.bi,viapoints:this.mi,barrierFree:this.pi},i,n)}},{key:"naviConstraint",value:function(t){if(this.Pi&&this.Ni){null==this.Fi&&this.Li(),t.buildingID=void 0!==t.buildingID?t.buildingID:null;for(var i={},n=[],e=Number.MAX_VALUE,r=0,s={index:-1,coords:{level:t.level,buildingID:t.buildingID},angle:null,distance:Number.MAX_VALUE,distanceToNext:Number.MAX_VALUE,remain:this.Yi,relDirection:1,time:null,dots:[],insertIndex:-1,toNext:null,buildingIndex:-1},o=0;o<this.Fi.length;o++){if(this.Fi[o].bid!==t.buildingID);else for(var h=this.Fi[o].naviPoints,u=1;u<h.length;u++){var a,f,c=h[u-1],l=h[u],v=c.index-r,v=this.Vi[o].result.naviDescriptionsData[v].endPoint;c.level===t.level&&l.level===t.level&&(a=w.K(t,c,l,i))<e&&(1===u||this.Zi&&this.Zi.insertIndex<=u)&&(null!=this.zi&&(f=(t.x-this.zi.x)*(l.x-c.x)+(t.y-this.zi.y)*(l.y-c.y),0===Math.abs(f)&&null!=this.Zi?s.relDirection=this.Zi.relDirection:f<0&&(s.relDirection=-1)),s.distance=a,Object.assign(s.coords,i),s.angle=this.Bi(c,l),s.index=c.index,s.distanceToNext=w.W(i,v),s.insertIndex=u,s.toNext=w.W(i,l),s.buildingIndex=o,n.push(s),e=a)}r+=this.Vi[o].result.naviDescriptionsData.length}var y=s,d=this.Ui(n,e);return d&&(this.Xi(y=d),y.time=t.time),this.zi=t,this.Zi=y}}},{key:"pathConstraint",value:function(t,i){return this.Tt?this.Tt.pathConstraint(t,i):null}},{key:"locate",value:function(t,i){this.Wt&&this.stop(),this.Hi(t,i),this.zi=t}},{key:"locateNoConstraint",value:function(t,i){this.Wt&&this.stop(),this.Qi(t,i),this.zi=t}},{key:"clearLocationMarker",value:function(){this.Ri&&(this.Ri.remove(),this.Ri=null)}},{key:"clearMarkers",value:function(){this.qi&&(this.qi.remove(),this.qi=null,this.Pi=null),this.Gi&&(this.Gi.remove(),this.Gi=null,this.Ni=null)}},{key:"drawNaviLine",value:function(t){if(this.Pi&&this.Ni)return this.Wi=this.$i(this.Ji,t),this.Wi}},{key:"clearNaviLine",value:function(){this.Wi&&(this.Wi.remove(),this.Wi=null)}},{key:"clearAll",value:function(){this.clearMarkers(),this.clearNaviLine(),this.clearLocationMarker()}},{key:"overview",value:function(t,i){var n=this;if(0!==this.Ji.length){for(var e=new $,r=[],s=0;s<this.Ji.length;s++)!function(){var i=[Number.MAX_VALUE,-Number.MAX_VALUE];n.Ji[s].resultbuild.forEach(function(t){i[0]=Math.min(i[0],t.level),i[1]=Math.max(i[1],t.level),e.P(t.pointList)}),r.push({bid:n.Ji[s].bid,levelRange:i})}();this.Ki(t,e,r,i)}}},{key:"focusNaviLineSegment",value:function(t,i,n){if(0!=this.Vi.length){for(var e,r,s,o=null,h=null,u=0;u<this.Vi.length;u++){var a=this.Vi[u].result.naviDescriptionsData;if(t-a.length<0){o=a[t],h=this.Vi[u].bid;break}t-=a.length}h&&o&&((e=new $).P([o.startPoint,o.endPoint]),r=[Math.min(o.startLevel,o.endLevel),Math.max(o.startLevel,o.endLevel)],s=this.Ot.getBuilding(h),this.Ki(i,e,r,s,n))}}},{key:"simulate",value:function(t){var i,n,e=this;this.Pi&&this.Ni&&0!==this.Ji.length&&(this.Wt&&this.stop(),this.Wt=!0,this.Ti(t),i={},this.si=!1,this.oi=this.Ot.getRotation(),n=i.Nt||this.Nt,i.Ft=i.Ft||this.Ft||0,this.tn(),this.Ri.rotateTo({heading:-this.oi}),this.Rt?this.nn(this.Pi.level,this.Pi.buildingID,n,function(){e.Wt&&e.en(e.Pi,n,function(){var t;e.Wt&&(t=i.Ft>e.Yt?e.Yt:i.Ft,e.Lt?e.rn(e.Dt,n,function(){e.Wt&&e.sn(t,n,function(){e.Wt&&e.hn()})}):e.sn(t,n,function(){e.Wt&&e.hn()}))})}):this.Wt&&this.hn())}},{key:"pause",value:function(){this.Jt=!0}},{key:"resume",value:function(){this.Jt=!1}},{key:"stop",value:function(){this.Gt=!0,this._i.stop(),this.un&&this.Ot.off("update",this.un),this.Jt=!1,this.ri=null,this.hi=null,this.ii=0,this.si=!1,this.fi=null,this.ci=0,this.ui=!1,this.ai=!1,this.un=null,this.Wt=!1,this.$t=!1,this.Kt=0,this.ti=0,this.ei=null}},{key:"getSpeed",value:function(){return this.xt}},{key:"setSpeed",value:function(t){this.xt=t}},{key:"addZoomCircle",value:function(t){if(0!=t.length){var i,n=null==t[0].buildingID?null:t[0].buildingID;this.Mi.has(n)?i=this.Mi.get(n):(i=new Map,this.Mi.set(n,i));for(var e,r=0;r<t.length;r++)i.has(t[r].level)||i.set(t[r].level,[]),(e=i.get(t[r].level)).push.apply(e,dt(t[r].circle))}}},{key:"stopZoomCircle",value:function(){this.ki=!1}},{key:"constraintTrack",value:function(t){return this.Tt.constraintTrack(t)}}])&&pt(t.prototype,n),e&&pt(t,e),Object.defineProperty(t,"prototype",{writable:!1}),i}(),Mt=(Object.assign(t.prototype,{Ti:function(t){t&&(void 0!==t.map&&(this.Ot=t.map),void 0!==t.analyser&&(this.Tt=t.analyser),void 0!==t.speed&&(this.xt=t.speed),void 0!==t.followSpeed&&(this.Et=t.followSpeed),void 0!==t.followPosition&&(this.Rt=t.followPosition),void 0!==t.followAngle&&(this.It=t.followAngle),void 0!==t.locationMarkerFollowAngle&&(this.Pt=t.locationMarkerFollowAngle),void 0!==t.isMultiLevels&&(this.Ct=t.isMultiLevels),void 0!==t.inTime&&(this.Nt=t.inTime),void 0!==t.tiltAngle&&(this.Dt=t.tiltAngle),void 0!==t.changeFloorTiltAngle&&(this.At=t.changeFloorTiltAngle),void 0!==t.changeTiltAngle&&(this.Lt=t.changeTiltAngle),void 0!==t.zoom&&(this.Ft=t.zoom),void 0!==t.maxZoom&&(this.Yt=t.maxZoom),void 0!==t.extendScale&&(this.Vt=t.extendScale),void 0!==t.locationMarkerUrl&&(this.Zt=t.locationMarkerUrl),void 0!==t.locationMarkerSize&&(this.zt=t.locationMarkerSize),void 0!==t.locationMarkerHeight&&(this.Bt=t.locationMarkerHeight),void 0!==t.lineMarkerHeight&&(this.Ut=t.lineMarkerHeight),void 0!==t.imageMarkerHeight&&(this.Xt=t.imageMarkerHeight),void 0!==t.directionAssert&&(this.Ht=t.directionAssert),void 0!==t.combineAsset&&(this.Qt=t.combineAsset),void 0!==t.completeDistance&&(this.qt=t.completeDistance),void 0!==t.li&&(this.Ht=t.directionAssert),void 0!==t.mode&&(this.vi=t.mode),void 0!==t.priority&&(this.yi=t.priority),void 0!==t.toDoors&&(this.di=t.toDoors),void 0!==t.obstruct&&(this.bi=t.obstruct),void 0!==t.viapoints&&(this.mi=t.viapoints),void 0!==t.barrierFree&&(this.pi=t.barrierFree),void 0!==t.lineStyle&&Object.assign(this.gi,t.lineStyle),void 0!==t.linePassed)&&(this.Si=t.linePassed)},xi:function(){1===this.St?this.an=void 0!==fengmap.FMNaviDriveAnalyser&&this.Tt instanceof fengmap.FMNaviDriveAnalyser:this.an=void 0!==fengmap.FMNaviAnalyser&&(this.Tt instanceof fengmap.FMNaviAnalyser||this.Tt instanceof fengmap.FMNaviWalkAnalyser),this.Pi=null,this.Ni=null,this.qi=null,this.Gi=null,this.Ri=null,this.un=null,this.Di()},tn:function(){this.Ri instanceof fengmap.FMLocationMarker?this.Ri.moveTo({buildingID:this.Pi.buildingID,level:this.Pi.level,x:this.Pi.x,y:this.Pi.y}):this.Ri=new fengmap.FMLocationMarker({id:"location",buildingID:this.Pi.buildingID,level:this.Pi.level,x:this.Pi.x,y:this.Pi.y,url:this.Zt||"",size:this.zt,height:this.Bt}),this.Ri.addTo(this.Ot)},fn:function(t){for(var i,n=arguments.length<=1?0:arguments.length-1,e=0;e<n;e++){var r=e+1<1||arguments.length<=e+1?void 0:arguments[e+1];if(t[r])return t[r]}return(i=(arguments.length<=1?0:arguments.length-1)-1+1)<1||arguments.length<=i?void 0:arguments[i]},cn:function(t){if(this.Pi&&this.Ni)return t==this.Pi.level||t==this._detData.level},Di:function(){this.Ei=null,this.ln=[],this.vn=[],this.Ji=[],this.yn=[],this.Vi=[],this.Fi=[],this.dn=[],this.bn=[],this.Yi=0,this.mn=[],this.Zi=null,this.zi=null},Ci:function(t,i){if(t.level){var n=t.url||(i?"image/small/marker/nav_location_start.png":"image/small/marker/nav_location_dest.png"),e=i?this.qi:this.Gi,r=(e&&e.remove(),(null!=t.buildingID?this.Ot.getBuilding(t.buildingID):this.Ot).getFloor(t.level));if(r)return(e=new fengmap.FMImageMarker(Object.assign({map:this.Ot,url:n,callback:function(){t.callback&&t.callback(e)},anchor:fengmap.FMMarkerAnchor.BOTTOM,depth:!1,collision:!1},t))).addTo(r),i?this.qi=e:this.Gi=e,e}},Ai:function(t,i,n){var e=this;this.Pi&&this.Ni&&(t=Object.assign({start:Object.assign({},this.Pi),dest:Object.assign({},this.Ni)},t),this.pn(t,function(t){e.Ei=t,e.Mn(),e.crossCircles=e.kn(e.Ji,e.Mi),e.gn(),e.wn(),e.Sn(),e.Li(),i&&i(t)},function(t){n&&n(t)}))},Mn:function(){if(this.Ei&&this.Ei.subs&&0!=this.Ei.subs.length){for(var t=this.Ei.subs[0].buildingID,i=[],n=[],e=[],r=0;r<this.Ei.subs.length;r++){var s=this.Ei.subs[r];s.buildingID!==t&&(e.push({bid:t,result:i}),i=[],t=s.buildingID),i.push(s),r==this.Ei.subs.length-1&&e.push({bid:t,result:i})}for(var o=0;o<e.length;o++){var h=this.jn(e[o].result);n.push({bid:e[o].bid,resultbuild:h})}this.ln=e,this.Ji=n}},jn:function(t){for(var i=[],n=Number.NaN,e=null,r=0;r<t.length;r++){var s,o=t[r];n!=o.levels[0]&&((e={length:0,level:o.levels[0],pointList:[]}).pointList.push(o.waypoint.points[0]),i.push(e),n=o.levels[0]),o.levels[0]==o.levels[1]?((s=e.pointList).push.apply(s,dt(o.waypoint.points.slice(1))),e.length+=o.distance):(e={length:0,level:o.levels[0],pointList:[o.waypoint.points[0]]},i.push(e),e={length:0,level:o.levels[1],pointList:[o.waypoint.points[1]]},i.push(e))}return i},gn:function(){for(var t=0;t<this.Ji.length;t++){var i=this.Ji[t].resultbuild;this._n(i)}},_n:function(t){for(var i=0;i<t.length-1;i++){var n,e,r=t[i];r.length&&(n=r.pointList[r.pointList.length-1],e=t[i+1].pointList[0],.2<w.W(n,e))&&r.pointList.push(Object.assign({},e))}},wn:function(){for(var t=0;t<this.Ji.length;t++){var i=this.Ji[t].resultbuild,i=this.On(i);this.yn.push({bid:this.Ji[t].bid,groupsPoints:i})}},On:function(t){for(var i=[],n=null,e=null,r=0;r<t.length;r++){var s=t[r],o=n==s.level;0==s.length&&0!=r&&r!=t.length-1||(o||(n=s.level,e&&i.push(e),e={level:s.level,pointList:[]}),e.pointList=e.pointList.concat(s.pointList))}return e&&i.push(e),i},Sn:function(){if(this.Ei)for(var t=0;t<this.ln.length;t++){var i=this.ln[t].bid,n=this.ln[t].result,n=this.Ii(n);this.Vi.push({bid:i,result:n}),this.Yi+=n.naviDistance}},Ii:function(t){if(t){for(var i=[],n=[],e=[],r=0,s=this.li,o=t,h=0,u=null,a=0;a<o.length;a++){var f=o[a],c=f.waypoint.points,l=f.waypoint.direction[s],l=(i.push(f.instruction[s]),{startDirection:l[0],startIndex:void 0,startLevel:f.levels[0],startPoint:c[0],endDirection:l[1],endIndex:void 0,endLevel:f.levels[1],endPoint:c.slice(-1)[0],distance:f.distance});f.levels[0]==f.levels[1]?(l.startIndex=h,h+=c.length-1,l.endIndex=h):h=0,n.push(l),null!=u&&f.levels[0]==f.levels[1]||(u={level:f.levels[1],distance:0},e.push(u)),u.distance+=f.distance,r+=f.distance}return{naviDescriptions:i,naviDescriptionsData:n,naviFloorsDistance:e,naviDistance:r}}},Li:function(){if(this.ln){for(var t=0,i=[],n=0;n<this.ln.length;n++){for(var e=this.ln[n].result,r=this.ln[n].bid,s=this.Tn(e),o=this.xn(e),h=0;h<s.length;h++)s[h].index+=t;for(var u=0;u<o.length;u++)o[u].index+=t;var a=this.Vi[n].result.naviDistance;t+=e.length,i.push({bid:r,distance:a,naviPoints:s,naviSubPoints:o})}this.Fi=i}},Tn:function(t){if(!t)return[];for(var i=[],n=t,e=0;e<n.length;e++){var r=n[e];if(r.levels[0]==r.levels[1])for(var s=e+1==n.length?null:n[e+1],o=r.waypoint.points,h=null==s||s.levels[0]!=s.levels[1]?o.length:o.length-1,u=0;u<h;u++){var a={x:o[u].x,y:o[u].y,z:0,level:r.levels[0],index:e};i.push(a)}}return i},xn:function(t){if(!t)return[];for(var i=[],n=t,e=0;e<n.length;e++){var r=n[e].waypoint.points,s={x:r[0].x,y:r[0].y,level:r[0].level,index:e};i.push(s),e==n.length-1&&(s={x:r.slice(-1)[0].x,y:r.slice(-1)[0].y,level:r.slice(-1)[0].level,index:n.length},i.push(s))}return i},Ui:function(t,i){var n=null;if(0!=t.length){for(var e=[],r=0;r<t.length;)t[r].distance==i&&e.push(t[r]),r+=1;if(1<e.length){for(var s=0;s<e.length;s++)if(0<=e[s].relDirection){n=e[s];break}n=n||e[0]}else 1==e.length&&(n=e[0])}return n},Xi:function(t){if(-1!=t.buildingIndex&&-1!==t.insertIndex){for(var i,n,e=t.buildingIndex,r=this.Fi[e].naviPoints,s=0,o=r.length-1;o>t.insertIndex;o--)o-1>=t.insertIndex&&(i=r[o],n=r[o-1],i.level===n.level)&&(s+=w.W(i,n));r[t.insertIndex]&&r[t.insertIndex].level===t.coords.level&&(s+=w.W(r[t.insertIndex],t.coords));for(var h=e+1;h<this.Fi.length;h++)s+=this.Fi[h].distance;t.remain=s}},$i:function(t,i){if(0===t.length)return null;1!==this.St||this.gi.hasOwnProperty("color")||(this.gi.color=this.wi);for(var n=Object.assign({},this.gi),r=(i&&i.style&&Object.assign(n,i.style),i&&i.height?i.height:this.Ut),s=[],e=0;e<t.length;e++)for(var o=t[e].bid,h=t[e].resultbuild,u=0;u<h.length;u++)(function(){var t=h[u],i=t.pointList;if(0===i.length)return;var t=t.level,n=[],e=(i.forEach(function(t){var i=parseFloat(""+t.x),t=parseFloat(""+t.y);n.push({x:i,y:t,z:r})}),i.length<2&&(e=parseFloat(""+i[0].x),i=parseFloat(""+i[0].y),n.push({x:e,y:i,z:r})),new fengmap.FMSegment);e.level=t,e.points=n,e.buildingID=o,s.push(e)})();n=new fengmap.FMLineMarker(Object.assign({segments:s},n));return n.passed=i&&null!=i.passed?i.passed:this.Si,n.addTo(this.Ot),n},pn:function(t,i,n){var e=this;this.Tt.route(t,function(t){e.di&&t.door&&(e.Ni.x=t.door.x,e.Ni.y=t.door.y),i&&i(t)},function(t){n&&n(t)})},en:function(t,i,n){this.Ot.setCenter({x:t.x,y:t.y,animate:"number"==typeof i,duration:"number"==typeof i?i:0,finish:n})},rn:function(t,i,n){this.Ot.setTilt({tilt:t,animate:"number"==typeof i,duration:"number"==typeof i?i:0,finish:n})},Rn:function(t,i,n){this.Ot.setRotation({rotation:t,animate:"number"==typeof i,duration:"number"==typeof i?i:0,finish:n})},sn:function(t,i,n){this.Ot.setZoom({zoom:t,animate:"number"==typeof i,duration:"number"==typeof i?i:0,finish:n},!0)},nn:function(t,i,n,e){var r,i=null==i?((r=this.Ot).setVisibleLevels([t]),r.getLevel()):((r=this.Ot.getBuilding(i)).setVisibleLevels([t]),r.level);return i==t?(e&&e(),null):r.setLevel({level:t,animate:"number"==typeof n,duration:"number"==typeof n?n:0,finish:e})},En:function(t){var i=this.vn;if(0===i.length)return[];for(var n=[],e=0,r=0;r<i.length;r++){var s=i[r];if(!(s.pointList.length<=1))for(var o=s.level,h=0;h<s.pointList.length;h++){for(var u=s.pointList[h],u=new c(u.x,0,u.y),a=(u.level=o,-1),f=1;f<t.length;f++)if(e<t[f].In){a=t[f-1].Pn;break}u.Pn=-1!==a?a:t[t.length-1].Pn,n.push(u),e++}}return n},Cn:function(t,i){if(0===i)return t[0];for(var n,e,r=0,s=0,o=t[0],h=1;h<t.length;h++)if((n=t[h]).bid!==o.bid)o=n;else if(n.level!==o.level)o=n;else{if(i<=(r+=(e=n.clone().sub(o)).length()))return e.normalize(),(e=o.clone().add(e.clone().multiplyScalar(i-s))).level=n.level,e.index=n.Pn!=o.index?o.index:n.Pn,e.bid=(n.bid!=o.bid?o:n).bid,e;(o=n.clone()).level=n.level,o.index=n.Pn,o.bid=n.bid,s=r}var u=t[t.length-1];return u.index=u.Pn,u.bid=u.bid,u},Nn:function(t){var e,r,s,i,n;return t&&0!==t.length?(r=0,s=e=-1,t=t.map(function(t,i){var n=new c(t.startPoint.x,0,t.startPoint.y);return n.level=t.startLevel,n.Pn=i,e=i,t.startLevel!==t.endLevel?(r+=s,n.In=r,r++):n.In=t.startIndex+r,s=t.endIndex,n}),i=this._naviDescriptionsData[this._naviDescriptionsData.length-1],(n=new c(i.endPoint.x,0,i.endPoint.y)).level=i.endLevel,n.Pn=e+1,n.In=i.endIndex+r,t.push(n),t):[]},Dn:function(t){var i,n,e,r,s=this;this.Ri&&(this.ai?(e={x:t.x,y:t.y,height:this.Ri.height,level:t.level,buildingID:t.bid},this.Ri.moveTo(e),this.ai=!1):(i=(e={}).Nt||this.Nt,e.Ft=e.Ft||this.Ft||0,n=e.Ft>this.Yt?this.Yt:e.Ft,this.Ct||(e={x:this.Ri.x,y:this.Ri.y,height:this.Ri.height,level:t.level,buildingID:t.bid},(r=this.yn[this.Kt].groupsPoints[this.ti])&&r.pointList&&0<r.pointList.length&&(e=Object.assign(e,r.pointList[0])),this.Ri.moveTo(e),this.Ri.visible=!0),this.Lt&&this.rn(this.Dt,i,null),this.en(t,i,function(){s.sn(n,i,function(){s.ui=!1})})))},An:function(t){var i;this.Ri&&(t={x:this.Ri.x,y:this.Ri.y,height:this.Ri.height,level:t.level,buildingID:t.bid},(i=this.yn[this.Kt].groupsPoints[this.ti])&&i.pointList&&0<i.pointList.length&&(t=Object.assign(t,i.pointList[0])),this.Ri.moveTo(t),this.ai=!1)},Bi:function(t,i){var n=new c(0,0,1),t=new c(t.x,0,t.y),i=new c(i.x,0,i.y).clone().sub(t).normalize(),t=i.angleTo(n)*w.A();return 0<i.clone().cross(n).y?360-t:t},Fn:function(t,i,n){return t===i?t:(180<Math.abs(i-t)&&(t<i?t+=360:i+=360),(t*(1-n)+i*n)%360)},Ln:function(t,i){var n=this._t,e=Math.floor(t),r=n[e-1]*(1-t%1)+n[e]*(t%1);for(r*=i,e=0;r<n[e];)e++;return e+1-(r-n[e])/(n[e-1]-n[e])},Yn:function(t){var i,n,e;this.Gt||requestAnimationFrame(this.Yn.bind(this,t)),this.$t||(t.cnt++,t.cnt!==t.step)||(t.cnt=0,i=this._i.getDelta(),this.ai)||this.ui||this.Jt||(this.ii+=this.xt*i,this.ii<=0)||(i=Object.assign({},this.Cn(t.ps,this.ii)),n=this.Yi-this.ii,e=i.y,i.y=i.z,i.z=e,this.ei={distance:0,remain:n<this.ni?this.ni:n,walk:this.ii,point:i,level:i.level,buildingID:i.bid,index:i.index-1},null!=this.ri&&(this.hi=this.Bi(this.ri,i)),this.ri=Object.assign({},i),!i||n<this.ni&&this.si?this.$t=!0:(n<this.ni&&!this.si&&(this.si=!0),this.ci||(this.ci=t.ps[0].level),null==this.fi&&(this.fi=t.ps[0].bid||"outdoor"),this.Wt&&(e=i.bid||"outdoor",this.fi!==e?(this.ai=!0,this.fi=e,this.Kt++,this.ti=0,this.ci=i.level,this.Vn(1,i),this.Oi.k({type:"transit",level:i.level,buildingID:i.bid})):this.ci!==i.level&&(this.ci=i.level,this.ti++,this.Vn(0,i),this.Oi.k({type:"transit",level:i.level,buildingID:i.bid})))))},Vn:function(t,i){var n=this;if(this.Rt){var e={},r=e.Nt||this.Nt,s=(e.Ft=e.Ft||this.Ft||0,e.Ft>this.Yt?this.Yt:e.Ft);if(1===t)return this.Zn(i.level,i.bid,function(){n.nn(i.level,i.bid,r,function(){n.Dn(i)})});this.ui=!0,this.Lt&&this.rn(this.At,r,null),this.Ct||(this.Ri.visible=!1),this.Zn(i.level,i.bid,function(){n.nn(i.level,i.bid,r,function(){n.sn(s,r,function(){n.en(i,r,function(){n.Lt?n.rn(n.Dt,r,function(){n.Dn(i)}):n.Dn(i)})})})})}else if(1===t)return this.Zn(i.level,i.bid,function(){n.Dn(i)})},zn:function(){this.Gt=!1;for(var t=[],i=0;i<this.Fi.length;i++){for(var n=this.Fi[i].naviPoints,e=[],r=0;r<n.length;r++){var s=new c(n[r].x,0,n[r].y);s.Pn=n[r].index,s.level=n[r].level,s.bid=this.Fi[i].bid,e.push(s)}t.push.apply(t,e)}this._i.start(),this.$t=!1,this.Kt=0,this.ti=0,this.Yn({step:2,cnt:0,ps:t})},Bn:function(){if(!(this.ui||this.ai||this.Jt)){if(this.ri){var t,i,n=new c(this.Ri.x,this.Ri.y,0).lerp(this.ri,this.si?1:this.Et),e=(n.level=this.ri.level,n.buildingID=this.ri.bid,this.naviConstraint(n));if(e.index<0)return;if(this.Ri.moveTo({x:n.x,y:n.y,height:this.Bt,level:n.level,buildingID:n.buildingID}),this.Wi&&(this.Wi.passed?this.Wi.moveProportion(1-e.remain/this.Yi):this.Wi.moveProportion(0)),this.ki)for(var r=0;r<this.crossCircles.length;r++)e.coords.buildingID==this.crossCircles[r].bid&&e.coords.level==this.crossCircles[r].level&&e.remain<=this.crossCircles[r].point.remain&&e.remain>=this.crossCircles[r].remain&&(t=!0,i=this.crossCircles[r].point);if(this.St===p.Drive?this.Oi.k(Object.assign({},this.ei,{type:"driving",distance:e.distance,remain:e.remain,walk:this.Yi-e.remain,distanceToNext:e.distanceToNext,angle:e.angle,point:e.coords,level:e.coords.level,buildingID:e.coords.buildindID,index:e.index,enterCircle:t,intersect:i})):this.Oi.k(Object.assign({},this.ei,{type:"walking",distance:e.distance,remain:e.remain,walk:this.Yi-e.remain,distanceToNext:e.distanceToNext,angle:e.angle,point:e.coords,level:e.coords.level,buildingID:e.coords.buildindID,index:e.index,enterCircle:t,intersect:i})),t=!1,i=null,this.Rt?this.en(n):this.Ot.updateCountDown_=0,this.$t)return this.stop(),void this.Oi.k({type:"complete"})}null!=this.hi&&(n=this.Fn(this.oi,this.hi,this.Et),this.oi=n,this.Ri.rotateTo({heading:-n}),this.It)&&this.Rn(n)}},hn:function(){this.zn(),this.un=this.Bn.bind(this),this.Ot.on("update",this.un)},Hi:function(t,i){var n=this.naviConstraint(t);if(this.Wi&&(this.Wi.passed?this.Wi.moveProportion(1-n.remain/this.Yi):this.Wi.moveProportion(0)),this.ki)for(var e=0;e<this.crossCircles.length;e++)n.coords.buildingID==this.crossCircles[e].bid&&n.coords.leve==this.crossCircles[e].level&&n.remain<=this.crossCircles[e].point.remain&&n.remain>=this.crossCircles[e].remain&&(r=!0,s=this.crossCircles[e].point);var t=null,t=this.St===p.Drive?{type:"driving",distance:n.distance,remain:n.remain,drive:this.Yi-n.remain,distanceToNext:n.distanceToNext,angle:n.angle,point:n.coords,level:n.coords.level,buildingID:n.coords.buildingID,index:n.index,enterCircle:r,intersect:s}:{type:"walking",distance:n.distance,remain:n.remain,walk:this.Yi-n.remain,distanceToNext:n.distanceToNext,angle:n.angle,point:n.coords,level:n.coords.level,buildingID:n.coords.buildingID,index:n.index,enterCircle:r,intersect:s},r=!1,s=null;this.Oi.k(t),this.Ri&&(n.coords.height=this.Bt,this.Ri.moveTo(n.coords),void 0!==i?this.Ri.rotateTo({heading:i}):this.Ri.rotateTo({heading:-n.angle}))},Qi:function(t,i){var n,e,r=this.naviConstraint(t);if(this.ki)for(var s=0;s<this.crossCircles.length;s++)r.coords.buildingID==this.crossCircles[s].bid&&r.coords.leve==this.crossCircles[s].level&&r.remain<=this.crossCircles[s].point.remain&&r.remain>=this.crossCircles[s].remain&&(n=!0,e=this.crossCircles[s].point);this.St===p.Drive?this.Oi.k({type:"driving",distance:r.distance,remain:r.remain,drive:this.Yi-r.remain,distanceToNext:r.distanceToNext,angle:r.angle,point:r.coords,level:r.coords.level,buildingID:r.coords.buildingID,index:r.index,enterCircle:n,intersect:e}):this.Oi.k({type:"walking",distance:r.distance,remain:r.remain,walk:this.Yi-r.remain,distanceToNext:r.distanceToNext,angle:r.angle,point:r.coords,level:r.coords.level,buildingID:r.coords.buildingID,index:r.index,enterCircle:n,intersect:e}),n=!1,e=null,this.Ri&&(t.height=this.Bt,this.Ri.moveTo(t),void 0!==i?this.Ri.rotateTo({heading:i}):this.Ri.rotateTo({heading:-r.angle}))},Un:function(t,i){for(var n=[{x:t.min.x,y:t.min.y},{x:t.min.x,y:t.max.y},{x:t.max.x,y:t.max.y},{x:t.max.x,y:t.min.y}],e=new $,r=0;r<i.length;r++)for(var s=i[r].levelRange,o=0;o<s.length;o++)for(var h=0,h=o===s.length-1?this.Ut+2*this.gi.radius:this.Ut,u=0;u<n.length;u++){var a=fengmap.FMUtil.coordsMapToScreen(this.Ot,{x:n[u].x,y:n[u].y,buildingID:i[r].bid,level:s[o],height:h});a&&e.P([a])}return e},Xn:function(t,i){var t=this.Un(t,i).size,i=this.Ot.getContainer().clientHeight,n=this.Ot.getContainer().clientWidth;return n/i>t.x/t.y?t.y/i:t.x/n},Hn:function(t,i,n,e,r,s){var o=this,h=this.Xn(t,i),u=this.Ot.getZoom();h?(u=this.Ln(this.Ot.getZoom(),h*(n||1)),r=e-1):u-=1,this.Ot.setZoom({zoom:u,animate:!1,finish:function(){++r===e?s&&s({zoom:u}):o.Hn(t,i,n,e,r,s)}})},Qn:function(t,i){for(var n=this.Un(t,i),e=[],r=0;r<i.length;r++)for(var s=i[r].levelRange,o=i[r].bid||this.Ot.getMapOptions().buildingID,h=0;h<s.length;h++){var u=this.Ot.getBuilding(o).getFloor(s[h]).height;e.push(fengmap.FMUtil.coordsScreenToMap(this.Ot,{x:(n.max.x+n.min.x)/2,y:(n.max.y+n.min.y)/2,z:u+2*this.gi.radius}))}for(var a=new c,f=0;f<e.length;f++)a.add(e[f]);return a.divideScalar(e.length),a},qn:function(n,e,r,s,o,h){var u=this;this.Hn(n,e,r,10,0,function(t){var i=u.Qn(n,e);u.Ot.setCenter({animate:!1,x:i.x,y:i.y,finish:function(){++o===s?h&&h({zoom:t.zoom,center:i}):u.qn(n,e,r,s,o,h)}})})},Ki:function(t,s,o,h){for(var u=this,a=t&&void 0!==t.ratio?t.ratio:1,i=t&&void 0!==t.rotation?t.rotation:0,n=t&&void 0!==t.tilt?t.tilt:30,f=!t||void 0===t.animate||t.animate,e=1,r=[1],c=0;c<o.length;c++){for(var l=o[c].levelRange,v=[],y=l[0];y<=l[1];)v.push(y),y++;null==o[c].bid?e=(r=v)[Math.floor((v.length-1)/2)]:this.Ot.getBuilding(o[c].bid).setVisibleLevels(v)}this.Ot.setVisibleLevels(r,function(){u.Ot.setLevel({level:e,animate:f,finish:function(){var t=r.length%2==0?u.Ot.getFloorSpace()/2:0;u.Ot.getInteracations().controls.panAdd({x:0,y:t,z:0}),u.Ot.setCenter({animate:f,x:s.center.x,y:s.center.y,finish:function(){u.Ot.setTilt({tilt:n,animate:f,finish:function(){u.Ot.setRotation({rotation:i,animate:f,finish:function(){var i=u.Ot.getInteracations(),t=u.Ot.copyCamera(),n=i.copyControls(t),e=i.controls,r=u.Ot.camera;i.controls=n,u.Ot.camera=t,u.Ot.getInteracations().controls.update(),u.qn(s,o,a,10,0,function(t){i.controls=e,u.Ot.camera=r,n.dispose(),n=null,u.Ot.enableUpdateRender(),u.Ot.setZoom({animate:f,zoom:t.zoom,duration:.5}),u.Ot.setCenter({animate:f,x:t.center.x,y:t.center.y,duration:.5,finish:function(){h&&h()}})})}})}})}})}})})},Zn:function(t,i,n){if(null==t||null==i)return n&&n(),null;for(var e=this.Ot.getBuilding(i).levelChart,r=this.Ot.getVisibleLevels(),s=null,o=0;o<e.length;o++)if(o%2==1&&e[o]===t&&(s=e[o-1],r.indexOf(s)<0)){this.Ot.setVisibleLevels([s]);break}return null==s||this.Ot.getLevel()===s?(n&&n(),null):this.Ot.setLevel({level:s,animate:"number"==typeof duration,duration:"number"==typeof duration?duration:0,finish:n})},kn:function(t,i){if(!i)return[];for(var n=0,e=0,r=[],s=0;s<t.length;s++)for(var o=t[s].resultbuild,h=0;h<o.length;h++)e+=o[h].length;for(var u=0;u<t.length;u++)for(var a=t[u].bid,f=t[u].resultbuild,c=0;c<f.length;c++){var l=f[c].level,v=f[c].pointList;if(0<c&&(n+=f[c-1].length),!(v.length<=1)&&(i.has(a)&&i.get(a).has(l)))for(var y=0,d=i.get(a).get(l),b=0;b<v.length;b++){0<b&&(y+=w.distance(v[b-1],v[b]));var m,p=yt(d);try{for(p.s();!(m=p.n()).done;){var M,k=m.value,g=this.Gn(v,k,b);g&&(g.remain=0==b?e-(n+y):e-(n+y-g.disIntersectToPoint),M=e-(n+y-g.disCenterToPoint),r.push({center:k.center,radius:k.radius,remain:M,point:g,level:l,bid:a}))}}catch(t){p.e(t)}finally{p.f()}}}return r},Gn:function(t,i,n){var e=0;if(0==n)return w.$(t[n],i.center)<=.001?Object.assign({disIntersectToCenter:disIntersectToCenter,disIntersectToPoint:e},t[n]):null;if(!(w.$(i.center,t[n-1])<=.001)&&w.J(i.center,t[n-1],t[n])<=.001){var r,s=yt(i.points);try{for(s.s();!(r=s.n()).done;){var o=r.value;if(!w.H(o,i.center,t[n]))for(var h=n;0<h;h--)if(w.H(o,t[h-1],t[h])&&w.J(o,t[h-1],t[h])<=.001){for(var u=[o],a=h;a<=n;a++)u.push(t[a]);for(var f=0;f<u.length-1;f++)e+=w.distance(u[f],u[f+1]);return o.disIntersectToPoint=e,o.disCenterToPoint=w.distance(i.center,t[n]),o}}}catch(t){s.e(t)}finally{s.f()}}return null}}),t);function k(t){return(k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function kt(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==k(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==k(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===k(t)?t:String(t)}(e.key),e)}}function gt(){return(gt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,i,n){var e=function(t,i){for(;!Object.prototype.hasOwnProperty.call(t,i)&&null!==(t=g(t)););return t}(t,i);if(e)return(e=Object.getOwnPropertyDescriptor(e,i)).get?e.get.call(arguments.length<3?t:n):e.value}).apply(this,arguments)}function wt(t,i){return(wt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t})(t,i)}function St(n){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,i=g(n),i=(t=e?(t=g(this).constructor,Reflect.construct(i,arguments,t)):i.apply(this,arguments),this);if(t&&("object"===k(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function g(t){return(g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function S(t){return(S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function jt(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==S(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==S(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===S(t)?t:String(t)}(e.key),e)}}function j(){return(j="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,i,n){var e=function(t,i){for(;!Object.prototype.hasOwnProperty.call(t,i)&&null!==(t=P(t)););return t}(t,i);if(e)return(e=Object.getOwnPropertyDescriptor(e,i)).get?e.get.call(arguments.length<3?t:n):e.value}).apply(this,arguments)}function _t(t,i){return(_t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t})(t,i)}function Ot(n){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,i=P(n),i=(t=e?(t=P(this).constructor,Reflect.construct(i,arguments,t)):i.apply(this,arguments),this);if(t&&("object"===S(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function P(t){return(P=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function C(t){return(C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Tt(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==C(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==C(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===C(t)?t:String(t)}(e.key),e)}}function N(){return(N="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,i,n){var e=function(t,i){for(;!Object.prototype.hasOwnProperty.call(t,i)&&null!==(t=D(t)););return t}(t,i);if(e)return(e=Object.getOwnPropertyDescriptor(e,i)).get?e.get.call(arguments.length<3?t:n):e.value}).apply(this,arguments)}function xt(t,i){return(xt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t})(t,i)}function Rt(n){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,i=D(n),i=(t=e?(t=D(this).constructor,Reflect.construct(i,arguments,t)):i.apply(this,arguments),this);if(t&&("object"===C(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function D(t){return(D=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Et,It={FMNaviMode:L,FMNaviPriority:Y,FMLanguageType:V,FMNavigation:function(){var t=r,i=Mt;if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),i&&wt(t,i);var n,e=St(r);function r(t,i,n){if(this instanceof r)return e.call(this,t,i,n);throw new TypeError("Cannot call a class as a function")}return t=r,(i=[{key:"on",value:function(t,i){gt(g(r.prototype),"on",this).call(this,t,i)}},{key:"off",value:function(t,i){gt(g(r.prototype),"off",this).call(this,t,i)}}])&&kt(t.prototype,i),n&&kt(t,n),Object.defineProperty(t,"prototype",{writable:!1}),r}(),FMNavigationDrive:function(){var t=r,i=Mt;if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),i&&_t(t,i);var n,e=Ot(r);function r(t,i,n){if(this instanceof r)return t.type=p.Drive,(t=e.call(this,t,i,n)).xt=7,t.Et=.2,t;throw new TypeError("Cannot call a class as a function")}return t=r,(i=[{key:"on",value:function(t,i){j(P(r.prototype),"on",this).call(this,t,i)}},{key:"off",value:function(t,i){j(P(r.prototype),"off",this).call(this,t,i)}},{key:"locate",value:function(t,i){j(P(r.prototype),"locate",this).call(this,t,i)}},{key:"route",value:function(t,i,n){j(P(r.prototype),"route",this).call(this,t,i,n)}},{key:"locateNoConstraint",value:function(t,i){j(P(r.prototype),"locateNoConstraint",this).call(this,t,i)}},{key:"simulate",value:function(t){j(P(r.prototype),"simulate",this).call(this,t)}},{key:"naviResult",get:function(){return this.Ei}}])&&jt(t.prototype,i),n&&jt(t,n),Object.defineProperty(t,"prototype",{writable:!1}),r}(),FMNavigationWalk:function(){var t=r,i=Mt;if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),i&&xt(t,i);var n,e=Rt(r);function r(t,i,n){if(this instanceof r)return t.type=p.Walk,e.call(this,t,i,n);throw new TypeError("Cannot call a class as a function")}return t=r,(i=[{key:"on",value:function(t,i){N(D(r.prototype),"on",this).call(this,t,i)}},{key:"off",value:function(t,i){N(D(r.prototype),"off",this).call(this,t,i)}},{key:"route",value:function(t,i,n){N(D(r.prototype),"route",this).call(this,t,i,n)}}])&&Tt(t.prototype,i),n&&Tt(t,n),Object.defineProperty(t,"prototype",{writable:!1}),r}()},Pt=window.fengmap||{};for(Et in It)Pt[Et]=It[Et];window.fengmap=Pt;F.default=Pt}],e={},r.m=n,r.c=e,r.d=function(t,i,n){r.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"Wn",{value:!0})},r.t=function(i,t){if(1&t&&(i=r(i)),8&t)return i;if(4&t&&"object"==typeof i&&i&&i.Wn)return i;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:i}),2&t&&"string"!=typeof i)for(var e in i)r.d(n,e,function(t){return i[t]}.bind(null,e));return n},r.n=function(t){var i=t&&t.Wn?function(){return t.default}:function(){return t};return r.d(i,"a",i),i},r.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},r.p="",r(r.s=0).default;function r(t){var i;return(e[t]||(i=e[t]={i:t,l:!1,exports:{}},n[t].call(i.exports,i,i.exports,r),i.l=!0,i)).exports}var n,e});