/**Released Version v3.1.4,BUILD 70,Time 1702529280247. Fengmap Javascript SDK , see: https://www.fengmap.com for details**/
!function(t,i){"object"==typeof exports&&"object"==typeof module?module.exports=i():"function"==typeof define&&define.amd?define([],i):"object"==typeof exports?exports.fengmap=i():t.fengmap=i()}(this,function(){return n=[function(V,t,i){"use strict";i.r(t);var o={LEFT_TOP:1,LEFT_BOTTOM:2,RIGHT_TOP:3,RIGHT_BOTTOM:4};function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==r(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===r(t)?t:String(t)}(e.key),e)}}i=function(){function i(t){if(!(this instanceof i))throw new TypeError("Cannot call a class as a function");t=t||{},this.u=null,this.h=t,void 0===this.h.position&&(this.h.position=o.LEFT_TOP),this.v=null,this.A=null}var t,n,e;return t=i,(n=[{key:"addTo",value:function(t){this.u=t,this.g()}},{key:"remove",value:function(){this.h.contain.removeChild(this.A)}},{key:"on",value:function(t,i){this.A.onclick=function(){i&&i()},this.A.addEventListener("touchend",function(){i&&i()},!1)}}])&&s(t.prototype,n),e&&s(t,e),Object.defineProperty(t,"prototype",{writable:!1}),i}(),Object.assign(i.prototype,{g:function(){var t=this,i=document.createElement("div"),n=(i.classList.add("fm-compass-container"),void 0!==this.h.backgroundImageSize&&(i.style.width=this.h.backgroundImageSize+"px",i.style.height=this.h.backgroundImageSize+"px"),void 0!==this.h.backgroundImageURL&&(i.style.backgroundImage="url('"+this.h.backgroundImageURL+"')"),void 0===this.h.position&&void 0===this.h.offset||this.S(this.h.position,this.h.offset,i),(this.h.contain||(this.h.contain=this.u.getContainer(),this.u.getContainer())).appendChild(i),-this.u.getRotation());this.v=document.createElement("div"),this.v.classList.add("fm-compass-element"),this.k(n),void 0!==this.h.pointerImageURL&&(this.v.style.backgroundImage="url('"+this.h.pointerImageURL+"')"),void 0!==this.h.pointerImageSize&&(this.v.style.width=this.h.pointerImageSize+"px",this.v.style.height=this.h.pointerImageSize+"px"),i.appendChild(this.v),this.A=i,this.u.on("update",function(){t.O()})},O:function(){var t=-this.u.getRotation();this.k(t)},k:function(t){this.v.style.transform="rotate("+t+"deg)",this.v.style.msTransform="rotate("+t+"deg)",this.v.style.mozTransform="rotate("+t+"deg)",this.v.style.webkitTransform="rotate("+t+"deg)",this.v.style.oTransform="rotate("+t+"deg)"},S:function(t,i,n){n.style.left="",n.style.right="",n.style.top="",n.style.bottom="",t===o.RIGHT_TOP?(n.style.right=-(i=i||{x:-10,y:10}).x+"px",n.style.top=i.y+"px",n.style.bottom="auto",n.style.left="auto"):t===o.LEFT_BOTTOM?(n.style.left=(i=i||{x:10,y:-10}).x+"px",n.style.bottom=-i.y+"px",n.style.top="auto",n.style.right="auto"):t===o.RIGHT_BOTTOM?(n.style.right=-(i=i||{x:-10,y:-10}).x+"px",n.style.bottom=-i.y+"px",n.style.top="auto",n.style.left="auto"):(n.style.left=(i=i||{x:10,y:10}).x+"px",n.style.top=i.y+"px",n.style.bottom="auto",n.style.right="auto")}});function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function h(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==u(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==u(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===u(t)?t:String(t)}(e.key),e)}}var n=function(){function i(t){if(!(this instanceof i))throw new TypeError("Cannot call a class as a function");this.M=t=t||{},this.j=40,void 0!==t.maxWidth&&(this.j=t.minWidth),this.T=100,void 0!==t.maxWidth&&(this.T=t.maxWidth),(this.C=void 0)!==t.height&&(this.C=t.height),(this.B=void 0)!==t.fontSize&&(this.B=t.fontSize),(this.I=void 0)!==t.position&&(this.I=t.position),this.u=null,this.R=null,this.P=[1e7,5e6,2e6,1e6,5e5,2e5,1e5,5e4,25e3,2e4,1e4,5e3,2e3,1e3,500,200,100,50,20,10,5,2,1,.5,.2,.1,.05,.02,.01],this.U=this.U.bind(this)}var t,n,e;return t=i,(n=[{key:"addTo",value:function(t){this.u=t,this.g()}},{key:"remove",value:function(){this.u.off("zoom",this.U),this.u.getContainer().removeChild(this.R)}}])&&h(t.prototype,n),e&&h(t,e),Object.defineProperty(t,"prototype",{writable:!1}),i}();Object.assign(n.prototype,{g:function(){this.R=document.createElement("div"),this.R.classList.add("fm-control-scale-bar-contain"),this.R.style.width=this.j+"px",void 0!==this.C&&(this.R.style.height=this.C+"px"),this.R.style.zIndex=20,void 0===this.I&&void 0===this.M.offset||this.S(this.I,this.M.offset,this.R),this.u.getContainer().appendChild(this.R);var t=document.createElement("div"),t=(t.setAttribute("id","ruleWord"),t.classList.add("fm-control-scale-bar-text"),void 0!==this.B&&(t.style.fontSize=this.B+"px"),this.R.appendChild(t),document.createElement("div")),t=(t.classList.add("fm-control-scale-bar-left1"),this.R.appendChild(t),document.createElement("div")),t=(t.classList.add("fm-control-scale-bar-left2"),this.R.appendChild(t),document.createElement("div")),t=(t.classList.add("fm-control-scale-bar-right1"),this.R.appendChild(t),document.createElement("div")),t=(t.classList.add("fm-control-scale-bar-right2"),this.R.appendChild(t),document.createElement("div")),t=(t.classList.add("fm-control-scale-bar-bottom1"),this.R.appendChild(t),document.createElement("div"));t.classList.add("fm-control-scale-bar-bottom2"),this.R.appendChild(t),this.U(),this.u.on("zoom",this.U)},S:function(t,i,n){switch(n.style.left="",n.style.right="",n.style.top="",n.style.bottom="",t){case o.LEFT_TOP:n.style.left=(i=i||{x:10,y:10}).x+"px",n.style.top=i.y+"px";break;case o.RIGHT_TOP:n.style.right=-(i=i||{x:-10,y:10}).x+"px",n.style.top=i.y+"px";break;case o.LEFT_BOTTOM:n.style.left=(i=i||{x:10,y:-10}).x+"px",n.style.bottom=-i.y+"px";break;case o.RIGHT_BOTTOM:n.style.right=-(i=i||{x:-10,y:-10}).x+"px",n.style.bottom=-i.y+"px";break;default:n.style.left=(i=i||{x:10,y:10}).x+"px",n.style.top=i.y+"px"}},U:function(t){var i={x:document.body.clientWidth/2,y:document.body.clientHeight/2},n={x:i.x+100,y:i.y},i=fengmap.FMUtil.coordsScreenToMap(this.u,i),n=fengmap.FMUtil.coordsScreenToMap(this.u,n),i=Math.sqrt((i.x-n.x)*(i.x-n.x)+(i.y-n.y)*(i.y-n.y))/100,n=this.P[Math.floor(this.u.getZoom())-1],i=(this.R.style.width=n/i+"px",""),i=n<1e3&&1<=n?n+"米":n<1?1e3*n+"毫米":n/1e3+"公里";document.getElementById("ruleWord").innerHTML=i}});function l(t){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==l(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==l(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===l(t)?t:String(t)}(e.key),e)}}var c=function(){function t(){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function")}var i,n,e;return i=t,e=[{key:"toColor",value:function(t){var i;return"number"==typeof t?t:3<=(i=t.split(",")).length?parseInt(i[0])<<16|parseInt(i[1])<<8|parseInt(i[2]):(console.error("color format error",t),0)}},{key:"bindEvent",value:function(t,r,i,s){t.addEventListener(i,function(t){var i,n=t||window.event,e=n.target||n.srcElement,o=n.currentTarget;for(Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(t){for(var i=(this.document||this.ownerDocument).querySelectorAll(t),n=i.length;0<=--n&&i.item(n)!==this;);return-1<n});e!==o;)e.matches(r)&&(i=e,s.call(i,n)),e=e.parentNode})}},{key:"scrollTopAnFun",value:function(){var f,d=!1;return function i(n){var e=n.el,t=n.to,o=n.form,r=(n.time,t<o?"up":"bottom"),s=10,u=(o<t?t-o:t==o?0:o-t)/s,h=0,l=function(t){var i=t.val,n=t.nbak,e=t.n,t=t.elTop;return"up"==r?t+(n-e)*i:t-(n-e)*i};function a(){--f<=0?c():window.setTimeout(function(){!1!==f&&((h=l({val:s,nbak:u,n:f,elTop:t,VDIRECTIONE:r}))&&(e.scrollTop=h),a())},s)}var c=function(){f=d=!1,e.scrollTop=0==o?0:o};d?(f=0,window.setTimeout(function(){var t=Object(n,{to:e.scrollTop});d=!1,i(t)},s+1)):(d=!0,f=u,a())}}},{key:"sleep",value:function(t){for(var i=(new Date).getTime(),n=0;n<1e7&&!((new Date).getTime()-i>t);n++);}},{key:"getClikEventName",value:function(){return window.PointerEvent?"pointerdown":"click"}}],(n=null)&&a(i.prototype,n),e&&a(i,e),Object.defineProperty(i,"prototype",{writable:!1}),t}(),_={FMMap_CONTROL_SMALL:"small",FMMap_CONTROL_NORMAL:"normal"};function f(t){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function e(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==f(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==f(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===f(t)?t:String(t)}(e.key),e)}}function L(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}var d=L(function t(i){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.size=_.FMMap_CONTROL_NORMAL,this.position=o.LEFT_TOP,this.offset={x:10,y:10},this.imgURL="resource/style/wedgets/img/",this.floorButtonCount=5,this.needAllLayerBtn=!0,Object.assign(this,i)}),m={MODE_3D:2,MODE_2D:4},v=(Object.freeze(m),m);function y(t,i){var n=document.createElement("div"),t='<div class="fm-scroll" id="scroll_'.concat(t+i,'"></div>');return n.innerHTML=t.trim(),n.firstChild}function A(t,i,n){switch(n.style.left="",n.style.right="",n.style.top="",n.style.bottom="",t){case o.LEFT_TOP:n.style.left=i.x+"px",n.style.top=i.y+"px",n.style.bottom="auto",n.style.right="auto";break;case o.RIGHT_TOP:n.style.right=-i.x+"px",n.style.top=i.y+"px",n.style.bottom="auto",n.style.left="auto";break;case o.LEFT_BOTTOM:n.style.left=i.x+"px",n.style.bottom=-i.y+"px",n.style.top="auto",n.style.right="auto";break;case o.RIGHT_BOTTOM:n.style.right=-i.x+"px",n.style.bottom=-i.y+"px",n.style.top="auto",n.style.left="auto";break;default:n.style.left=i.x+"px",n.style.top=i.y+"px",n.style.bottom="auto",n.style.right="auto"}}function b(t,i){t&&i?t.appendChild(i):console.error(t,i)}for(var p=[],g=0;g<256;g++)p[g]=(g<16?"0":"")+g.toString(16);var w={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var t=4294967295*Math.random()|0,i=4294967295*Math.random()|0,n=4294967295*Math.random()|0,e=4294967295*Math.random()|0;return(p[255&t]+p[t>>8&255]+p[t>>16&255]+p[t>>24&255]+"-"+p[255&i]+p[i>>8&255]+"-"+p[i>>16&15|64]+p[i>>24&255]+"-"+p[63&n|128]+p[n>>8&255]+"-"+p[n>>16&255]+p[n>>24&255]+p[255&e]+p[e>>8&255]+p[e>>16&255]+p[e>>24&255]).toUpperCase()},clamp:function(t,i,n){return Math.max(i,Math.min(n,t))},euclideanModulo:function(t,i){return(t%i+i)%i},mapLinear:function(t,i,n,e,o){return e+(t-i)*(o-e)/(n-i)},lerp:function(t,i,n){return(1-n)*t+n*i},smoothstep:function(t,i,n){return t<=i?0:n<=t?1:(t=(t-i)/(n-i))*t*(3-2*t)},smootherstep:function(t,i,n){return t<=i?0:n<=t?1:(t=(t-i)/(n-i))*t*t*(t*(6*t-15)+10)},randInt:function(t,i){return t+Math.floor(Math.random()*(i-t+1))},randFloat:function(t,i){return t+Math.random()*(i-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(t){return t*w.DEG2RAD},radToDeg:function(t){return t*w.RAD2DEG},isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},setQuaternionFromProperEuler:function(t,i,n,e,o){var r=Math.cos,s=Math.sin,u=r(n/2),n=s(n/2),h=r((i+e)/2),l=s((i+e)/2),a=r((i-e)/2),c=s((i-e)/2),r=r((e-i)/2),s=s((e-i)/2);"XYX"===o?t.set(u*l,n*a,n*c,u*h):"YZY"===o?t.set(n*c,u*l,n*a,u*h):"ZXZ"===o?t.set(n*a,n*c,u*l,u*h):"XZX"===o?t.set(u*l,n*s,n*r,u*h):"YXY"===o?t.set(n*r,u*l,n*s,u*h):"ZYZ"===o?t.set(n*s,n*r,u*l,u*h):console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order.")}};function S(t){return(S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function k(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==S(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==S(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===S(t)?t:String(t)}(e.key),e)}}function D(t,i,n){return i&&k(t.prototype,i),n&&k(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}var x,N=D(function t(i,n){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");var e=i.getState().viewBuildingID,o=!0,r=n.buildingID,s=i.getMapOptions().buildingID,u=r&&r!==s&&e===s,s=r&&e!==s,h=document.querySelector(".fm-enter-exit-building-button-enter"),l=document.querySelector(".fm-enter-exit-building-button-exit");u?h.classList.remove("fm-hide"):s&&l.classList.remove("fm-hide"),h.addEventListener("pointerdown",function(){null!==r&&!1!==o&&(o=!1,i.enterBuilding({buildingID:r,finish:function(){o=!0}}),e=r,n.parent.V=r)}),l.addEventListener("pointerdown",function(){!1!==o&&(o=!1,i.exitBuilding({finish:function(){o=!0}}),n.parent.V=null)})});function E(t){return(E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function O(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==E(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==E(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===E(t)?t:String(t)}(e.key),e)}}m=function(){function i(t){if(!(this instanceof i))throw new TypeError("Cannot call a class as a function");this.R=(t=t||{}).contain,this._=new d(t),this.L=this._.floorButtonCount,this.u=null,this.D=!1,this.N=!0,this.F=10,this.G=null,this.Z=null,this.Y=[],this.J=null,this.X=null,this.H=null,this.uuid=null,this.K=null,this.scrollTopAn_=new c.scrollTopAnFun,this.viewModeControl=void 0===t.viewModeControl||t.viewModeControl,this.floorModeControl=void 0===t.floorModeControl||t.floorModeControl,this.timer=null,this.W=t.buildingID,this.q=void 0===t.showMap||t.showMap,this.hasDOM=!1,this.enable=!0,this.$=void 0===t.entranceIcon||t.entranceIcon,this.V=null}var t,n,e;return t=i,(n=[{key:"applicationBuilding",value:function(){this.J=this.u.getBuilding(this.W),null!==this.V&&(this.J=this.u.getBuilding(this.V)),0!==this.J.getFloorInfos().length&&(null!=this.J.level?this.K=this.J.level:this.J.setLevel({level:this.K}),this.R||(this.R=this.u.getContainer()),this.createDOM(),1<this.J.visibleLevels.length?this.setLayerStatus(!0):this.setLayerStatus(!1))}},{key:"buildingIsInZoomRange",value:function(t){var i=this.u.getZoom(),t=t.zoomRange,n=!0;return n=t&&(i<t.minLevel||i>t.maxLevel)?!1:n}},{key:"findBuilding",value:function(){var i=!1,t=this.u.getState(),n=!1,e=!1,o=this,r=this.u.focusBuilding;return r&&(r.buildingID===t.viewBuildingID||(t=this.buildingIsInZoomRange(r),r.overviewMode!==fengmap.FMOverviewMode.OUTDOOR&&t))?(i=!0,this.W!==r.buildingID&&(e=!0),this.W=r.buildingID,n=!0):s(),!1===i&&(null!==this.W&&(e=!0),this.W=null),{isShowToolbar:n,isBuildingChange:e};function s(){var t;!0===o.q&&(i=!0,t=o.u.getMapOptions().buildingID,o.W!==t&&(e=!0),o.W=t,n=!0)}}},{key:"addTo",value:function(t){((this.u=t).toolBar=this).initEvent(),this.findBuilding().isShowToolbar&&this.applicationBuilding()}},{key:"switchBuilding",value:function(){this.removeDOM(),this.W=null,this.J=null,this.findBuilding().isShowToolbar&&this.applicationBuilding()}},{key:"remove",value:function(){this.removeEvent(),this.removeDOM(),delete this.u.toolBar}},{key:"removeDOM",value:function(){this.Z&&this.R.removeChild(this.Z),this.Z=null,this.hasDOM=!1}},{key:"removeEvent",value:function(){this.u.off("levelChanged",this.gidchange),this.u.off("visibleLevelsLoaded",this.handleLayerChangeStyle),this.u.off("buildingEntered",this.handleBuildingEntered),this.u.off("buildingExited",this.handleBuildingExited),this.u.off("buildingOverviewModeChanged",this.handleBuildingOverviewModeChanged),this.u.off("ViewBuildingChange",this.handleViewBuildingChange),this.u.off("zoom",this.handleCheckZoom),this.u.off("viewModeChanged",this.handleViewModeChanged)}},{key:"initEvent",value:function(){function t(t){var i;!n.enable||!n.J||t.buildingID&&t.buildingID!==n.J.buildingID||!t.buildingID&&n.J.buildingID!==n.u.getMapOptions().buildingID||(i=n.J.getFloorInfos().map(function(t){return t.level}),t.level<i[0])||t.level>i[i.length-1]||(n.G.scrollTop=n.getCenterScrolltopById(t.level,i.length),n.setGidStyleByEvent(t.level,"levelChanged"))}var n=this;this.gidchange=t,this.u.on("levelChanged",t),this.tt=function(t){return(n.map?n.map.mapView.container_:document).querySelector(t)},this.handleBuildingEntered=this.handleBuildingEntered.bind(this),this.handleBuildingExited=this.handleBuildingExited.bind(this),this.handleBuildingOverviewModeChanged=this.handleBuildingOverviewModeChanged.bind(this),this.handleLayerChangeStyle=this.handleLayerChangeStyle.bind(this),this.handleViewBuildingChange=this.handleViewBuildingChange.bind(this),this.handleCheckZoom=this.handleCheckZoom.bind(this),this.handleViewModeChanged=this.handleViewModeChanged.bind(this),this.u.on("ViewBuildingChange",this.handleViewBuildingChange),this.u.on("buildingEntered",this.handleBuildingEntered),this.u.on("buildingExited",this.handleBuildingExited),this.u.on("buildingOverviewModeChanged",this.handleBuildingOverviewModeChanged),this.u.on("visibleLevelsLoaded",this.handleLayerChangeStyle),this.u.on("zoom",this.handleCheckZoom),this.u.on("viewModeChanged",this.handleViewModeChanged)}},{key:"handleViewModeChanged",value:function(){this.u.getViewMode()===v.MODE_3D?this.N=!1:this.N=!0,this.setViewModeToStyle(this.X,this.N?"2d":"3d")}},{key:"handleCheckZoom",value:function(){this.findBuilding().isBuildingChange&&this.switchBuilding()}},{key:"createDOM",value:function(){this.hasDOM=!0,this.uuid=w.generateUUID();(i=document.createElement("div")).innerHTML='\n    <div class="fm-control-groups" </div>'.trim();var t,i=i.firstChild,n=(this.Z=i,A(this._.position,this._.offset,i),b(this.R,i),this.J.getFloorInfos().map(function(t){return t.level})),e=n.length,o=this.L,r=!0,s=(this.viewModeControl&&(this.X=((t=document.createElement("div")).innerHTML='\n    <div class="fm-view fm-view-3d"></div>'.trim(),t.firstChild),this.initViewModePanelEvent(this.X),b(i,this.X),this.handleViewModeChanged()),(t=document.createElement("div")).innerHTML='\n      <div class="fm-layer">\n        <div class="fm-layer-image-many"> </div>\n      </div>'.trim(),t.firstChild);if(this._.needAllLayerBtn&&b(i,s),this.it=s,this.eventSwitchBtn(s),this.handleLayerChangeStyle=this.handleLayerChangeStyle.bind(this),this.floorModeControl){e<=this.L&&(o=e,r=!1);this._layer;this.D&&this._layers,(s=document.createElement("div")).innerHTML='<div class = "fm-floor-list-group" > </div'.trim();var e=s.firstChild,u=(b(i,e),r&&e.appendChild(y("up",this.uuid)),(s=document.createElement("div")).innerHTML='<div class = "fm-floor-list" > </div'.trim(),s.firstChild);b(e,u),this.G=u,this.Y=this.J.getFloorInfos();for(var h,l,a,c=this.Y.length-1;-1<c;c--)u.appendChild((h=this.Y[c],l=this.uuid,a=void 0,a=document.createElement("div"),l='\n    <div class="fm-floor-name-container">\n      <label\n        class="fm-floor-name fm-floor-name-normal"\n        data-gid='.concat(h.level,'\n        id="gid_').concat(h.level+l,'"\n        <span>').concat(h.alias&&h.alias.toUpperCase()||h.name.toUpperCase(),"</span>\n      </label>\n    </div>\n    "),a.innerHTML=l.trim(),a.firstChild)),0<c&&u.appendChild((h=void 0,(h=document.createElement("div")).innerHTML='\n  <hr class="fm-floor-line" />'.trim(),h.firstChild));var s=document.querySelector(".fm-floor-line"),f=0,s=(s&&(f=s.getBoundingClientRect().height),this.nt=document.querySelector(".fm-floor-name-container").clientHeight+f,document.querySelector(".fm-floor-list").style.height=this.nt*o+"px",r&&e.appendChild(y("down",this.uuid)),u.scrollTop=this.getCenterScrolltopById(this.K,n.length),document.getElementById("gid_"+this.K+this.uuid));null!=s&&(s.classList.remove("fm-floor-name-normal"),s.classList.add("fm-floor-name-active")),this.eventBtnPanelInit(u),this.eventPanelInit(i,u,n),this.$&&((f=document.createElement("div")).classList.add("fm-enter-exit-building"),f.innerHTML='\n   <div class="fm-enter-exit-building-button fm-enter-exit-building-button-enter fm-hide">\n    </div>\n    <div class="fm-enter-exit-building-button fm-enter-exit-building-button-exit fm-hide">\n    </div>\n  '.trim(),b(i,f),new N(this.u,{buildingID:this.W,parent:this}))}}},{key:"handleLayerChange",value:function(){var t,i;this.hasDOM&&(i=!(t=this).D,this.changeLevelsSelect(i),t.u.followFocus)&&t.J&&(i=t.J.level,-1==t.J.visibleLevels.indexOf(i)&&t.J.visibleLevels.push(i),t.changeFocusLevel(i))}},{key:"handleLayerChangeStyle",value:function(t){!this.hasDOM||!this.J||t.buildingID&&t.buildingID!==this.J.buildingID||(1<this.J.visibleLevels.length?this.setLayerStatus(!0):this.setLayerStatus(!1))}},{key:"eventSwitchBtn",value:function(t){var i;this.hasDOM&&(i=c.getClikEventName(),this.handleLayerChange=this.handleLayerChange.bind(this),t.addEventListener(i,this.handleLayerChange))}},{key:"setViewModeToStyle",value:function(t,i){this.hasDOM&&("2d"==i?(t.classList.remove("fm-view-3d"),t.classList.add("fm-view-2d")):(t.classList.remove("fm-view-2d"),t.classList.add("fm-view-3d")))}},{key:"initViewModePanelEvent",value:function(t){var i=this,n=c.getClikEventName(),e=!0;t.addEventListener(n,function(){!1!==e&&(e=!1,i.u.getViewMode()===v.MODE_3D?(i.u.setViewMode({mode:v.MODE_2D,finish:function(){e=!0}}),i.setViewModeToStyle(this,"2d")):(i.u.setViewMode({mode:v.MODE_3D,finish:function(){e=!0}}),i.setViewModeToStyle(this,"3d")))})}},{key:"eventBtnPanelInit",value:function(n){function t(t){o.changeScrollBtnPic();var i=0;t.wheelDelta?i+=-t.wheelDelta:t.detail&&(i+=t.detail),e.scrollTopAn_({el:n,to:n.scrollTop,form:n.scrollTop+i}),t.stopPropagation()}var e=this,o=this;o.changeScrollBtnPic(),c.bindEvent(n,"label","click",function(){var t;!o.enable||o.K===parseInt(this.dataset.gid)||(o.foucusId=parseInt(this.dataset.gid),t=o.J.getFloorInfos().map(function(t){return t.level}),this.dataset.gid<t[0])||this.dataset.gid>t[t.length-1]||(n.scrollTop=o.getCenterScrolltopById(parseInt(this.dataset.gid),t.length),o.setGidStyleByClick(this.dataset.gid,"click"))});n.addEventListener("mousewheel",t,{passive:!0}),n.addEventListener("MozMousePixelScroll",t,!1),n.addEventListener("touchstart",this.touchstart.bind(this),!1),n.addEventListener("touchmove",this.touchmove.bind(this),!1),n.addEventListener("touchend",this.touchend.bind(this),!0)}},{key:"touchstart",value:function(t){t.preventDefault(),this.touchStartPointY=t.touches[0].pageY,this.touchPointX=t.touches[0].pageX,this.touchPointY=t.touches[0].pageY,t.stopPropagation()}},{key:"touchmove",value:function(t){t.preventDefault(),this.touchEndPointX=t.touches[0].pageX,this.touchEndPointY=t.touches[0].pageY,this.handleTouchEnd(t),t.stopPropagation()}},{key:"handleTouchEnd",value:function(t){this.touchAchieve(t,"handleTouchEnd")}},{key:"touchend",value:function(t){this.touchAchieve(t,"touchend")}},{key:"touchAchieve",value:function(t,i){var n=this,e=null,o=(0<(t=t||window.event).changedTouches.length&&(n.touchEndPointX=t.changedTouches[0].pageX,n.touchEndPointY=t.changedTouches[0].pageY),(e=t.target)instanceof HTMLSpanElement==!0&&(e=e.parentElement),n.touchEndPointY-n.touchPointY);"touchend"===i?((o=Math.abs(o))<5&&0<=o&&e&&(i=parseInt(e.dataset.gid),isNaN(i)||(n.foucusId=i,n.setGidStyleByClick(i,"click"))),t.stopPropagation()):0!=(e=-o)&&(n.touchPointX=n.touchEndPointX,n.touchPointY=n.touchEndPointY,i=n.tt(".fm-floor-list"),this.scrollTopAn_({el:i,to:i.scrollTop,form:i.scrollTop+e}))}},{key:"eventPanelInit",value:function(t,i,n){var e=this;function o(t){t.id==="scroll_up"+e.uuid?(t=e.K+1,t=Math.min(n[n.length-1],t),e.foucusId!=t&&(e.foucusId=t,e.setGidStyleByClick(t,"click"))):(t=e.K-1,t=Math.max(n[0],t),e.foucusId!=t&&(e.foucusId=t,e.setGidStyleByClick(t,"click")))}t.onselectstart=function(){return!1},t.style.MozUserSelect="none",c.bindEvent(t,".fm-scroll","click",function(t){o(this)}),c.bindEvent(t,".fm-scroll","touchend",function(t){o(this)})}},{key:"getCenterScrolltopById",value:function(t,i){return(i-t-Math.floor(this.L/2))*this.nt}},{key:"changeScrollBtnPic",value:function(){var t=this.K,i=this.J.getFloorInfos().map(function(t){return t.level}),n=(i.sort(function(t,i){return t-i}),document.getElementById("scroll_down"+this.uuid)),e=document.getElementById("scroll_up"+this.uuid);t==i[0]&&n?(n.classList.remove("fm-scroll-down"),n.classList.add("fm-scroll-down-grey")):n&&(n.classList.remove("fm-scroll-down-grey"),n.classList.add("fm-scroll-down")),t==i[i.length-1]&&e?(e.classList.remove("fm-scroll-up"),e.classList.add("fm-scroll-up-grey")):e&&(e.classList.remove("fm-scroll-up-grey"),e.classList.add("fm-scroll-up"))}},{key:"changeFocusLevel",value:function(t){this.foucusId=t}},{key:"changeLevelsSelect",value:function(t){this.allLayer=t,this.setLayerStatus(t)}},{key:"setLayerStatus",value:function(t){this.D=t,this.D?(this.it.firstElementChild.classList.remove("fm-layer-image-one"),this.it.firstElementChild.classList.add("fm-layer-image-many")):(this.it.firstElementChild.classList.remove("fm-layer-image-many"),this.it.firstElementChild.classList.add("fm-layer-image-one"))}},{key:"onChange",value:function(t){x=t}},{key:"foucusId",get:function(){return this.K},set:function(t){var i=this;this.J&&(null!==this.H&&!1===this.et&&this.H.finish(),this.et=!1,this.J.setLevel({level:t,finish:function(){i.et=!0},callback:function(t){i.H=t}}),x)&&x([t])}},{key:"setGidStyleByEvent",value:function(t){this.setGidStyleByClick(t)}},{key:"setGidStyleByClick",value:function(t){var i=document.getElementById("gid_"+this.K+this.uuid);i&&(i.classList.remove("fm-floor-name-active"),i.classList.add("fm-floor-name-normal"),this.K=parseInt(t),(i=document.getElementById("gid_"+t+this.uuid)).classList.remove("fm-floor-name-normal"),i.classList.add("fm-floor-name-active"),this.changeScrollBtnPic())}},{key:"allLayer",get:function(){return this.D},set:function(t){this.J&&((this.D=t)?this.J.setVisibleLevels(this.J.getFloorInfos().map(function(t){return t.level})):this.J.setVisibleLevels([this.J.level]))}},{key:"handleBuildingEntered",value:function(i){var n=this;null!==this.timer&&clearTimeout(this.timer),this.timer=setTimeout(function(){var t;n.switchBuilding(),n.u.followFocus&&(n.J=n.u.getBuilding(i.buildingID),n.J)&&(n.J.overviewMode==fengmap.FMOverviewMode.NORMAL||n.J.overviewMode==fengmap.FMOverviewMode.INDOOR||n.u.focusBuilding&&n.u.focusBuilding.buildingID==n.u.getState().viewBuildingID)&&(t=n.J.level,n.changeFocusLevel(t))},200)}},{key:"handleBuildingExited",value:function(t){var i=this;null!==this.timer&&clearTimeout(this.timer),this.timer=setTimeout(function(){var t;i.switchBuilding(),i.u.followFocus&&(t=i.J,t=null==i.J?i.u.getBuilding(i.u.getMapOptions().buildingID):t)&&(null!==i.H&&!1===i.et&&i.H.finish(),i.et=!1,t.setLevel({level:t.level,finish:function(){i.et=!0},callback:function(t){i.H=t}}))},200)}},{key:"handleBuildingOverviewModeChanged",value:function(){this.switchBuilding()}},{key:"handleViewBuildingChange",value:function(){this.switchBuilding()}}])&&O(t.prototype,n),e&&O(t,e),Object.defineProperty(t,"prototype",{writable:!1}),i}();function M(t){return(M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function j(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==M(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==M(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===M(t)?t:String(t)}(e.key),e)}}var T=function(){function i(t){if(!(this instanceof i))throw new TypeError("Cannot call a class as a function");t=t||{},this.u=null,this.ot=new d(t),this.ot.position||(this.ot.position=o.LEFT_TOP),this.R=t.contain,this.ot.offset||(this.ot.offset={x:10,y:10}),this.rt=null,this.st=t.imgURL||"resource/style/wedgets/img/"}var t,n,e;return t=i,(n=[{key:"addTo",value:function(t){this.u=t,this.R||(this.R=this.u.getContainer()),this.init()}},{key:"remove",value:function(){this.R.removeChild(this.rt)}},{key:"init",value:function(){var t=this.createPanel(),i=(this.rt=t,this);A(this.ot.position,this.ot.offset,t),c.bindEvent(t,"img","mouseover",function(t){this.src=this.dataset.on}),c.bindEvent(t,"img","mouseout",function(t){this.src=this.dataset.leave}),c.bindEvent(t,"div","click",function(t){"in"===this.dataset.type?i.u.zoomIn():i.u.zoomOut()}),c.bindEvent(t,"div","touchend",function(t){"in"===this.dataset.type?i.u.zoomIn():i.u.zoomOut()})}},{key:"showZoom",value:function(t){this.rt.style.display=t?"block":"none"}},{key:"createPanel",value:function(){var t=document.createElement("div");return t.setAttribute("class","fm-control-zoom-bar"),t.style.left=0,t.style.top=0,this.R.appendChild(t),t.innerHTML=this.createInnerHtml(),t}},{key:"createInnerHtml",value:function(){return'\n            <div data-type="in" class="fm-control-zoom-bar-button fm-control-zoom-button-bar-in"></div>\n            <hr class="fm-control-zoom-bar-hr"/>\n            <div data-type="out" class="fm-control-zoom-bar-button fm-control-zoom-button-bar-out"></div>\n        '}}])&&j(t.prototype,n),e&&j(t,e),Object.defineProperty(t,"prototype",{writable:!1}),i}();function C(t){return(C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function B(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,function(t){t=function(t,i){if("object"!==C(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);n=n.call(t,i||"default");if("object"!==C(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===C(t)?t:String(t)}(e.key),e)}}function I(){return(I="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,i,n){var e=function(t,i){for(;!Object.prototype.hasOwnProperty.call(t,i)&&null!==(t=P(t)););return t}(t,i);if(e)return(e=Object.getOwnPropertyDescriptor(e,i)).get?e.get.call(arguments.length<3?t:n):e.value}).apply(this,arguments)}function R(t,i){return(R=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t})(t,i)}function F(n){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,i=P(n),i=(t=e?(t=P(this).constructor,Reflect.construct(i,arguments,t)):i.apply(this,arguments),this);if(t&&("object"===C(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function P(t){return(P=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Q=function(){var t=o,i=T;if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),i&&R(t,i);var n,e=F(o);function o(t){if(this instanceof o)return e.call(this,t);throw new TypeError("Cannot call a class as a function")}return t=o,(i=[{key:"addTo",value:function(t){I(P(o.prototype),"addTo",this).call(this,t)}},{key:"remove",value:function(){I(P(o.prototype),"remove",this).call(this)}},{key:"showZoom",value:function(t){I(P(o.prototype),"showZoom",this).call(this,t)}},{key:"createPanel",value:function(){var t=document.createElement("div");t.setAttribute("class","fm-control-zoom"),t.style.zIndex=20,t.style.position="absolute",t.style.backgroundColor="white",t.style.boxShadow="2px 2px 3px rgba(0,0,0, 0.3)",t.style.borderRadius="2px",t.style.left=0,t.style.top=0,this.R.appendChild(t);return t.innerHTML=this.createInnerHtml("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOAgMAAABiJsVCAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAACVBMVEUAAABmZmYAAABV8S+1AAAAAXRSTlMAQObYZgAAAAFiS0dEAIgFHUgAAAAJcEhZcwAACxIAAAsSAdLdfvwAAAATSURBVAjXY2DAC0JDQwMgBF4AAFvvAp8tw46tAAAAAElFTkSuQmCC","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAYAAAAfSC3RAAAAIElEQVQokWNgGAXUB4zGsrL/ydHIwsDAcI/KjhkFZAMA5XkCUOIdNxMAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOAgMAAABiJsVCAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAACVBMVEUAAABmZmYAAABV8S+1AAAAAXRSTlMAQObYZgAAAAFiS0dEAIgFHUgAAAAJcEhZcwAACxIAAAsSAdLdfvwAAAAXSURBVAjXY2BgZQACXERoaGgAhMCrDgBkQQLbnsbDyQAAAABJRU5ErkJggg==","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAYAAAAfSC3RAAAAOElEQVQokWM0lpVlwAE+QGkBbJJMuHQRAiNBIwsDA8M7HHJ8UBqrPEU2CuGQg8UjVvkhFKr01wgAH8cEixbYBa8AAAAASUVORK5CYII="),t}},{key:"createInnerHtml",value:function(t,i,n,e){return'\n\n            <div data-type="in" style="padding: 14px; cursor: pointer;">\n            <img src='.concat(n," data-leave=").concat(n," data-on=").concat(e,' style="width: 14px; height: 14px;"/>\n             </div>\n            <hr style="height: 1px; border-top: 1px solid rgba(153, 153, 153, 0.45); border-right: none; border-bottom: none; border-left: none; border-image: initial; width: 60%; margin: 0px 20%;">\n            <div data-type="out" style="padding: 14px; cursor: pointer;">\n            <img src=').concat(t," data-leave=").concat(t," data-on=").concat(i,' style="width: 14px; height: 14px;"/>\n            </div>\n        ')}}])&&B(t.prototype,i),n&&B(t,n),Object.defineProperty(t,"prototype",{writable:!1}),o}(),U=window.fengmap||{};U.FMCompass=i,U.FMControlPosition=o,U.FMScaleBar=n,U.FMToolbar=m,U.FMZoomBar=T,U.FMZoomControl=Q,t.default=U}],e={},o.m=n,o.c=e,o.d=function(t,i,n){o.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:n})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"ut",{value:!0})},o.t=function(i,t){if(1&t&&(i=o(i)),8&t)return i;if(4&t&&"object"==typeof i&&i&&i.ut)return i;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:i}),2&t&&"string"!=typeof i)for(var e in i)o.d(n,e,function(t){return i[t]}.bind(null,e));return n},o.n=function(t){var i=t&&t.ut?function(){return t.default}:function(){return t};return o.d(i,"a",i),i},o.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},o.p="",o(o.s=0).default;function o(t){var i;return(e[t]||(i=e[t]={i:t,l:!1,exports:{}},n[t].call(i.exports,i,i.exports,o),i.l=!0,i)).exports}var n,e});